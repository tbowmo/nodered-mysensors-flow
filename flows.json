[
    {
        "id": "67deb464.98214c",
        "type": "tab",
        "label": "Mysensors",
        "disabled": false,
        "info": ""
    },
    {
        "id": "9292e51b.eaf788",
        "type": "tab",
        "label": "Software sensors",
        "disabled": false,
        "info": ""
    },
    {
        "id": "d2be3a2a.67d4b8",
        "type": "tab",
        "label": "AV Center flows",
        "disabled": false,
        "info": "Flows that control the AV components.\n\nRemote control / scene switching is handled by a Logitech Harmony Hub\n\nAudio / Video streaming is done with two chromecasts"
    },
    {
        "id": "d9d4d547.6a9438",
        "type": "tab",
        "label": "Automation rules",
        "disabled": false,
        "info": "Automation flows, to turn on TV / Radio whenever a chromecast is active,\n\nTurn light up / down, depending on play state on the video chromecasts\n\nVarious other smaller automation rules that is used in my setup"
    },
    {
        "id": "7acba262.c6674c",
        "type": "tab",
        "label": "Lights",
        "disabled": false,
        "info": ""
    },
    {
        "id": "96d6598d.fb6458",
        "type": "tab",
        "label": "Lights 2",
        "disabled": false,
        "info": ""
    },
    {
        "id": "1e9f561e.599c0a",
        "type": "tab",
        "label": "Presence detector",
        "disabled": false,
        "info": ""
    },
    {
        "id": "353b452d.9a6efa",
        "type": "tab",
        "label": "Chicken gate",
        "disabled": false,
        "info": ""
    },
    {
        "id": "36f02452.2e99bc",
        "type": "tab",
        "label": "UI"
    },
    {
        "id": "f3e95c3b.5524b",
        "type": "tab",
        "label": "Voice commands",
        "disabled": true,
        "info": ""
    },
    {
        "id": "c6ae2dfb.adbb9",
        "type": "tab",
        "label": "Media UI",
        "disabled": false,
        "info": ""
    },
    {
        "id": "29d73028.74b4a",
        "type": "tab",
        "label": "UI: BBQ",
        "disabled": true,
        "info": ""
    },
    {
        "id": "ca4f572b.274038",
        "type": "tab",
        "label": "UI: Varme system",
        "disabled": false,
        "info": ""
    },
    {
        "id": "be12afc0.d1228",
        "type": "tab",
        "label": "Dew point calculation",
        "disabled": false,
        "info": ""
    },
    {
        "id": "d10deed0.f94c",
        "type": "tab",
        "label": "Slack",
        "disabled": true,
        "info": ""
    },
    {
        "id": "8bc8753a.1ea768",
        "type": "subflow",
        "name": "mqtt thermometer",
        "info": "",
        "in": [
            {
                "x": 120,
                "y": 380,
                "wires": [
                    {
                        "id": "c4285cac.b7dcb"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 840,
                "y": 240,
                "wires": [
                    {
                        "id": "9b1ad06.4a8493",
                        "port": 0
                    }
                ]
            },
            {
                "x": 660,
                "y": 380,
                "wires": [
                    {
                        "id": "a133b28e.29844",
                        "port": 1
                    }
                ]
            },
            {
                "x": 660,
                "y": 420,
                "wires": [
                    {
                        "id": "a133b28e.29844",
                        "port": 2
                    }
                ]
            },
            {
                "x": 840,
                "y": 280,
                "wires": [
                    {
                        "id": "9b1ad06.4a8493",
                        "port": 1
                    }
                ]
            }
        ],
        "inputLabels": [
            "MQTT input"
        ],
        "outputLabels": [
            "Temperature",
            "Humidity",
            "Barometric"
        ]
    },
    {
        "id": "d17c54ad.8abb78",
        "type": "subflow",
        "name": "ikea output",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 120,
                "y": 500,
                "wires": [
                    {
                        "id": "9a66e5eb.2e9fe8"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 380,
                "y": 500,
                "wires": [
                    {
                        "id": "9a66e5eb.2e9fe8",
                        "port": 0
                    }
                ]
            }
        ]
    },
    {
        "id": "9dbdc7c7.624238",
        "type": "influxdb",
        "z": "67deb464.98214c",
        "hostname": "influx",
        "port": "8086",
        "database": "environment",
        "name": "Environment DB",
        "usetls": false,
        "tls": ""
    },
    {
        "id": "9de2e4ed.fdcfc8",
        "type": "influxdb",
        "z": "67deb464.98214c",
        "hostname": "influx",
        "port": "8086",
        "database": "utility",
        "name": "Utility DB",
        "usetls": false,
        "tls": ""
    },
    {
        "id": "ca5adeb2.68c55",
        "type": "slackbot-controller",
        "z": "",
        "name": "HusBot",
        "bot_token": "xoxb-93817565314-CM19x5qrKKpBBOruTdmCbMwC"
    },
    {
        "id": "56b003cf.93c9bc",
        "type": "harmony-server",
        "z": "",
        "name": "Stuen",
        "ip": "192.168.3.106"
    },
    {
        "id": "6c5b47d3.832458",
        "type": "ui_tab",
        "z": "",
        "name": "Stuen",
        "icon": "dashboard",
        "order": 1
    },
    {
        "id": "9f6b85e1.adc7d8",
        "type": "ui_group",
        "z": "",
        "name": "Fjernvarme målere",
        "tab": "6255c082.fdb72",
        "order": 1,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "171dca46.627746",
        "type": "ui_base",
        "theme": {
            "name": "theme-dark",
            "lightTheme": {
                "default": "#0094CE",
                "baseColor": "#0094CE",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": true,
                "reset": false
            },
            "darkTheme": {
                "default": "#097479",
                "baseColor": "#097479",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": true,
                "reset": false
            },
            "customTheme": {
                "name": "Untitled Theme 1",
                "default": "#4B7930",
                "baseColor": "#4B7930",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"
            },
            "themeState": {
                "base-color": {
                    "default": "#097479",
                    "value": "#097479",
                    "edited": false
                },
                "page-titlebar-backgroundColor": {
                    "value": "#097479",
                    "edited": false
                },
                "page-backgroundColor": {
                    "value": "#111111",
                    "edited": false
                },
                "page-sidebar-backgroundColor": {
                    "value": "#000000",
                    "edited": false
                },
                "group-textColor": {
                    "value": "#0eb8c0",
                    "edited": false
                },
                "group-borderColor": {
                    "value": "#555555",
                    "edited": false
                },
                "group-backgroundColor": {
                    "value": "#333333",
                    "edited": false
                },
                "widget-textColor": {
                    "value": "#eeeeee",
                    "edited": false
                },
                "widget-backgroundColor": {
                    "value": "#097479",
                    "edited": false
                },
                "widget-borderColor": {
                    "value": "#333333",
                    "edited": false
                },
                "base-font": {
                    "value": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"
                }
            },
            "angularTheme": {
                "primary": "indigo",
                "accents": "blue",
                "warn": "red",
                "background": "grey"
            }
        },
        "site": {
            "name": "Bowman Mørch",
            "hideToolbar": "false",
            "allowSwipe": "false",
            "dateFormat": "DD/MM/YYYY",
            "sizes": {
                "sx": 48,
                "sy": 48,
                "gx": 6,
                "gy": 6,
                "cx": 6,
                "cy": 6,
                "px": 0,
                "py": 0
            }
        }
    },
    {
        "id": "d9490c52.897ce",
        "type": "ui_group",
        "z": "",
        "name": "Stuen",
        "tab": "6c5b47d3.832458",
        "order": 1,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "85f5cfaa.42289",
        "type": "ui_group",
        "z": "",
        "name": "Udendørs",
        "tab": "6c5b47d3.832458",
        "order": 3,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "4798f2b0.5d747c",
        "type": "mqtt-broker",
        "z": "",
        "name": "",
        "broker": "mqtt",
        "port": "1883",
        "clientid": "nodered1",
        "usetls": false,
        "compatmode": false,
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "closeTopic": "",
        "closePayload": "",
        "willTopic": "",
        "willQos": "0",
        "willPayload": ""
    },
    {
        "id": "18897163.60f2bf",
        "type": "ui_group",
        "z": "",
        "name": "Grill",
        "tab": "1fa739cf.db0f66",
        "order": 1,
        "disp": true,
        "width": "6"
    },
    {
        "id": "1fa739cf.db0f66",
        "type": "ui_tab",
        "z": "",
        "name": "Grill",
        "icon": "dashboard",
        "order": 3
    },
    {
        "id": "cc7bc1b6.f6635",
        "type": "ui_group",
        "z": "",
        "name": "Aktuel temperatur",
        "tab": "1fa739cf.db0f66",
        "order": 2,
        "disp": true,
        "width": "6"
    },
    {
        "id": "9cca1fdd.fd315",
        "type": "ui_group",
        "z": "",
        "name": "Mål temperatur",
        "tab": "1fa739cf.db0f66",
        "order": 3,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "9d8c74dc.570ca8",
        "type": "influxdb",
        "z": "",
        "hostname": "influx",
        "port": "8086",
        "protocol": "http",
        "database": "utility",
        "name": "",
        "usetls": false,
        "tls": ""
    },
    {
        "id": "940310ee.5c533",
        "type": "ui_group",
        "z": "",
        "name": "Scene",
        "tab": "6c5b47d3.832458",
        "order": 2,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "e8eb39ba.7799b8",
        "type": "ui_group",
        "z": "",
        "name": "Settings",
        "tab": "ac7edd37.5c008",
        "order": 4,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "ac7edd37.5c008",
        "type": "ui_tab",
        "z": "",
        "name": "Settings",
        "icon": "dashboard",
        "order": 4
    },
    {
        "id": "6255c082.fdb72",
        "type": "ui_tab",
        "z": "",
        "name": "Huset",
        "icon": "dashboard",
        "order": 2
    },
    {
        "id": "bf3de794.50d788",
        "type": "ui_group",
        "z": "",
        "name": "Lys",
        "tab": "6c5b47d3.832458",
        "order": 4,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "165c814.4d5267f",
        "type": "ui_group",
        "z": "",
        "name": "Varme settings",
        "tab": "6255c082.fdb72",
        "order": 2,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "e11ff54d.12ad78",
        "type": "ui_group",
        "z": "",
        "name": "Badeværelse",
        "tab": "6255c082.fdb72",
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "1215f3be.8c080c",
        "type": "ui_group",
        "z": "",
        "name": "Soveværelse",
        "tab": "6255c082.fdb72",
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "58bcd57b.789b2c",
        "type": "ui_group",
        "z": "",
        "name": "Kontor",
        "tab": "6255c082.fdb72",
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "ed2765a5.dc9328",
        "type": "mysensorsdb",
        "z": "",
        "name": "",
        "file": "/data/mysensors.db"
    },
    {
        "id": "d972b17e.bb915",
        "type": "influxdb",
        "z": "",
        "hostname": "influx",
        "port": "8086",
        "protocol": "http",
        "database": "sensorvalues",
        "name": "sensorvalues",
        "usetls": false,
        "tls": ""
    },
    {
        "id": "f4336a2f.6fced8",
        "type": "ui_group",
        "z": "",
        "name": "Hønsegården",
        "tab": "6c5b47d3.832458",
        "order": 5,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "48014e80.94ab",
        "type": "ui_group",
        "z": "",
        "name": "Familie i huset",
        "tab": "6c5b47d3.832458",
        "order": 6,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "fc44c751.2d1328",
        "type": "influxdb",
        "z": "",
        "hostname": "influx",
        "port": "8086",
        "protocol": "http",
        "database": "presence",
        "name": "",
        "usetls": false,
        "tls": ""
    },
    {
        "id": "9ebb1391.6144f",
        "type": "debug",
        "z": "67deb464.98214c",
        "name": "gw debug",
        "active": false,
        "console": "false",
        "complete": "true",
        "x": 840,
        "y": 840,
        "wires": []
    },
    {
        "id": "aec232d3.2860b",
        "type": "debug",
        "z": "67deb464.98214c",
        "name": "Influx msg",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 850,
        "y": 660,
        "wires": []
    },
    {
        "id": "74bc6004.618bc",
        "type": "http response",
        "z": "9292e51b.eaf788",
        "name": "",
        "x": 350,
        "y": 400,
        "wires": []
    },
    {
        "id": "33eb5fc9.991eb",
        "type": "slackbot-listen",
        "z": "d10deed0.f94c",
        "slackbot": "ca5adeb2.68c55",
        "name": "",
        "x": 210,
        "y": 220,
        "wires": [
            [
                "e78d46ee.fa0f98",
                "26f8f71a.1eb498"
            ]
        ]
    },
    {
        "id": "dd9af24e.e2395",
        "type": "slackbot-reply",
        "z": "d10deed0.f94c",
        "slackbot": "ca5adeb2.68c55",
        "name": "",
        "x": 1006,
        "y": 197,
        "wires": []
    },
    {
        "id": "f8828153.6536d",
        "type": "switch",
        "z": "d10deed0.f94c",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "regex",
                "v": "billede",
                "vt": "str",
                "case": true
            },
            {
                "t": "regex",
                "v": "hej",
                "vt": "str",
                "case": true
            }
        ],
        "checkall": "true",
        "outputs": 2,
        "x": 506,
        "y": 197,
        "wires": [
            [
                "9611fc27.e021c"
            ],
            [
                "b1e8baa7.2f09e8"
            ]
        ]
    },
    {
        "id": "b1e8baa7.2f09e8",
        "type": "change",
        "z": "d10deed0.f94c",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Goddag",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 696,
        "y": 217,
        "wires": [
            [
                "f57f871e.389308"
            ]
        ]
    },
    {
        "id": "9611fc27.e021c",
        "type": "change",
        "z": "d10deed0.f94c",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Ok, jeg sender et billede",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 696,
        "y": 177,
        "wires": [
            [
                "f57f871e.389308"
            ]
        ]
    },
    {
        "id": "26f8f71a.1eb498",
        "type": "debug",
        "z": "d10deed0.f94c",
        "name": "listen",
        "active": false,
        "console": "false",
        "complete": "true",
        "x": 371,
        "y": 157,
        "wires": []
    },
    {
        "id": "e78d46ee.fa0f98",
        "type": "function",
        "z": "d10deed0.f94c",
        "name": "",
        "func": "msg.orig = msg;\nmsg.token = \"xoxb-93817565314-CM19x5qrKKpBBOruTdmCbMwC\";\nmsg.url = \"https://slack.com/api/users.info?token=xoxb-93817565314-CM19x5qrKKpBBOruTdmCbMwC&user=\"+msg.message.user;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 306,
        "y": 277,
        "wires": [
            [
                "588a8611.d17038",
                "7c0f393d.b4a888"
            ]
        ]
    },
    {
        "id": "588a8611.d17038",
        "type": "http request",
        "z": "d10deed0.f94c",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "url": "",
        "tls": "",
        "x": 446,
        "y": 277,
        "wires": [
            [
                "d942251e.5b2d38"
            ]
        ]
    },
    {
        "id": "d942251e.5b2d38",
        "type": "function",
        "z": "d10deed0.f94c",
        "name": "",
        "func": "payload = JSON.parse(msg.payload);\nconsole.log(payload.user.name);\nmsg.payload = msg.message.text;\nmsg.user = payload.user.name;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 586,
        "y": 277,
        "wires": [
            [
                "f31a5efc.4234",
                "f8828153.6536d"
            ]
        ]
    },
    {
        "id": "f31a5efc.4234",
        "type": "debug",
        "z": "d10deed0.f94c",
        "name": "",
        "active": true,
        "console": "false",
        "complete": "true",
        "x": 706,
        "y": 317,
        "wires": []
    },
    {
        "id": "7c0f393d.b4a888",
        "type": "debug",
        "z": "d10deed0.f94c",
        "name": "",
        "active": false,
        "console": "false",
        "complete": "url",
        "x": 436,
        "y": 317,
        "wires": []
    },
    {
        "id": "f57f871e.389308",
        "type": "template",
        "z": "d10deed0.f94c",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "{{payload}} {{user}}",
        "x": 866,
        "y": 197,
        "wires": [
            [
                "dd9af24e.e2395"
            ]
        ]
    },
    {
        "id": "ad8c0dc6.4f64a",
        "type": "ui_gauge",
        "z": "36f02452.2e99bc",
        "name": "",
        "group": "85f5cfaa.42289",
        "order": 1,
        "width": "3",
        "height": "3",
        "gtype": "gage",
        "title": "Temperatur",
        "label": "C",
        "format": "{{value}}°",
        "min": "-10",
        "max": "35",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "x": 550,
        "y": 60,
        "wires": []
    },
    {
        "id": "4f7cb0eb.0d19a",
        "type": "ui_gauge",
        "z": "36f02452.2e99bc",
        "name": "",
        "group": "85f5cfaa.42289",
        "order": 3,
        "width": "3",
        "height": "3",
        "gtype": "gage",
        "title": "Fugtighed",
        "label": "RH",
        "format": "{{value}}%",
        "min": "40",
        "max": "100",
        "colors": [
            "#00b500",
            "#e6e600",
            "#384dca"
        ],
        "seg1": "",
        "seg2": "",
        "x": 540,
        "y": 140,
        "wires": []
    },
    {
        "id": "5115f872.4620e8",
        "type": "ui_gauge",
        "z": "36f02452.2e99bc",
        "name": "",
        "group": "85f5cfaa.42289",
        "order": 5,
        "width": "3",
        "height": "3",
        "gtype": "gage",
        "title": "Barometer",
        "label": "units",
        "format": "{{value}}",
        "min": 0,
        "max": 10,
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "x": 550,
        "y": 220,
        "wires": []
    },
    {
        "id": "c04eebad.3abb18",
        "type": "mqtt in",
        "z": "29d73028.74b4a",
        "name": "",
        "topic": "bbq/probe/+",
        "qos": "2",
        "broker": "4798f2b0.5d747c",
        "x": 190,
        "y": 280,
        "wires": [
            [
                "44614969.ed87a8",
                "d2bd726f.bc379"
            ]
        ]
    },
    {
        "id": "44614969.ed87a8",
        "type": "ui_chart",
        "z": "29d73028.74b4a",
        "name": "",
        "group": "18897163.60f2bf",
        "order": 1,
        "width": "0",
        "height": "0",
        "label": "chart",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "3600",
        "cutout": 0,
        "useOneColor": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "useOldStyle": false,
        "outputs": 2,
        "x": 950,
        "y": 220,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "3b28b192.3dedbe",
        "type": "ui_gauge",
        "z": "29d73028.74b4a",
        "name": "",
        "group": "cc7bc1b6.f6635",
        "order": 2,
        "width": "3",
        "height": "3",
        "gtype": "gage",
        "title": "Probe 1",
        "label": "C",
        "format": "{{value}}",
        "min": 0,
        "max": "80",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "x": 960,
        "y": 260,
        "wires": []
    },
    {
        "id": "d2bd726f.bc379",
        "type": "switch",
        "z": "29d73028.74b4a",
        "name": "bbq switch",
        "property": "topic",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "bbq/probe/1",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "bbq/probe/2",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "bbq/probe/3",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "bbq/probe/4",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "outputs": 4,
        "x": 790,
        "y": 320,
        "wires": [
            [
                "3b28b192.3dedbe"
            ],
            [
                "28155b24.363f94"
            ],
            [
                "fd89173.0fd6ae8"
            ],
            [
                "e84c7202.7c1c3"
            ]
        ]
    },
    {
        "id": "28155b24.363f94",
        "type": "ui_gauge",
        "z": "29d73028.74b4a",
        "name": "",
        "group": "cc7bc1b6.f6635",
        "order": 4,
        "width": "3",
        "height": "3",
        "gtype": "gage",
        "title": "Probe 2",
        "label": "units",
        "format": "{{value}}",
        "min": 0,
        "max": 10,
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "x": 960,
        "y": 300,
        "wires": []
    },
    {
        "id": "fd89173.0fd6ae8",
        "type": "ui_gauge",
        "z": "29d73028.74b4a",
        "name": "",
        "group": "cc7bc1b6.f6635",
        "order": 5,
        "width": "3",
        "height": "3",
        "gtype": "gage",
        "title": "Probe 3",
        "label": "units",
        "format": "{{value}}",
        "min": 0,
        "max": 10,
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "x": 960,
        "y": 340,
        "wires": []
    },
    {
        "id": "e84c7202.7c1c3",
        "type": "ui_gauge",
        "z": "29d73028.74b4a",
        "name": "",
        "group": "cc7bc1b6.f6635",
        "order": 6,
        "width": "3",
        "height": "3",
        "gtype": "gage",
        "title": "Probe 4",
        "label": "units",
        "format": "{{value}}",
        "min": 0,
        "max": 10,
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "x": 960,
        "y": 380,
        "wires": []
    },
    {
        "id": "77610ed1.363cb",
        "type": "ui_numeric",
        "z": "29d73028.74b4a",
        "name": "",
        "label": "",
        "group": "9cca1fdd.fd315",
        "order": 2,
        "width": "2",
        "height": "1",
        "passthru": true,
        "topic": "bbq/target/1",
        "format": "{{value}}",
        "min": 0,
        "max": "90",
        "step": 1,
        "x": 300,
        "y": 440,
        "wires": [
            [
                "da36f779.58bb88",
                "f01ba07f.b219e"
            ]
        ]
    },
    {
        "id": "da36f779.58bb88",
        "type": "function",
        "z": "29d73028.74b4a",
        "name": "set temperatures",
        "func": "topic = msg.topic.slice(-1);\nprobe = Number(topic);\ntemperature = Number(msg.payload);\nmsg1 = msg;\nmsg2 = null;\nmsg3 = null;\n\nvar targetTemp = context.get('targetTemp') || [];\n\nif (msg.topic.includes('target')) {\n    targetTemp[probe] = temperature;\n    context.set('targetTemp', targetTemp);\n    if (temperature === -1) {\n        msg1.ui_control = {\"max\": 100}\n    } else {\n        msg1.ui_control = {\"max\": msg.payload + 10};\n    }\n    msg1.topic = 'bbq/probe/'+topic\n    delete msg1.payload\n} else if (msg.topic.includes('probe')) {\n    if (targetTemp.length >= topic) {\n        if (temperature >= targetTemp[probe]) {\n            msg3 = {payload: 'Probe ' + topic + ' har nået sin mål temperatur'};\n        }\n    }    \n}\n\nreturn [msg1, msg, msg3];\n",
        "outputs": "3",
        "noerr": 0,
        "x": 570,
        "y": 500,
        "wires": [
            [
                "d2bd726f.bc379",
                "e8f5c2a1.34456"
            ],
            [
                "d71091bc.2ecb8"
            ],
            [
                "6e5db1e.f67ef5"
            ]
        ]
    },
    {
        "id": "96657173.b10bf",
        "type": "ui_numeric",
        "z": "29d73028.74b4a",
        "name": "",
        "label": "",
        "group": "9cca1fdd.fd315",
        "order": 3,
        "width": "2",
        "height": "1",
        "passthru": true,
        "topic": "bbq/target/2",
        "format": "{{value}}",
        "min": 0,
        "max": "90",
        "step": 1,
        "x": 300,
        "y": 480,
        "wires": [
            [
                "da36f779.58bb88"
            ]
        ]
    },
    {
        "id": "36625ef3.3ff4c2",
        "type": "ui_numeric",
        "z": "29d73028.74b4a",
        "name": "",
        "label": "",
        "group": "9cca1fdd.fd315",
        "order": 4,
        "width": "2",
        "height": "1",
        "passthru": true,
        "topic": "bbq/target/3",
        "format": "{{value}}",
        "min": 0,
        "max": "90",
        "step": 1,
        "x": 300,
        "y": 520,
        "wires": [
            [
                "da36f779.58bb88"
            ]
        ]
    },
    {
        "id": "a0b3e3fc.f1463",
        "type": "ui_numeric",
        "z": "29d73028.74b4a",
        "name": "",
        "label": "",
        "group": "9cca1fdd.fd315",
        "order": 5,
        "width": "2",
        "height": "1",
        "passthru": true,
        "topic": "bbq/target/4",
        "format": "{{value}}",
        "min": 0,
        "max": "90",
        "step": 1,
        "x": 300,
        "y": 560,
        "wires": [
            [
                "da36f779.58bb88"
            ]
        ]
    },
    {
        "id": "6e5db1e.f67ef5",
        "type": "ui_toast",
        "z": "29d73028.74b4a",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "topic": "",
        "name": "",
        "x": 990,
        "y": 520,
        "wires": []
    },
    {
        "id": "1e1ae89f.e44f67",
        "type": "ui_slider",
        "z": "29d73028.74b4a",
        "name": "",
        "label": "1",
        "group": "9cca1fdd.fd315",
        "order": 1,
        "width": "4",
        "height": "1",
        "passthru": true,
        "topic": "bbq/probe/1",
        "min": "10",
        "max": "90",
        "step": 1,
        "x": 170,
        "y": 440,
        "wires": [
            [
                "77610ed1.363cb"
            ]
        ]
    },
    {
        "id": "bc8e8dad.66db9",
        "type": "ui_slider",
        "z": "29d73028.74b4a",
        "name": "",
        "label": "2",
        "group": "9cca1fdd.fd315",
        "order": 1,
        "width": "4",
        "height": "1",
        "passthru": true,
        "topic": "bbq/probe/1",
        "min": "10",
        "max": "90",
        "step": 1,
        "x": 170,
        "y": 480,
        "wires": [
            [
                "96657173.b10bf"
            ]
        ]
    },
    {
        "id": "5b1f8b73.ca7084",
        "type": "ui_slider",
        "z": "29d73028.74b4a",
        "name": "",
        "label": "3",
        "group": "9cca1fdd.fd315",
        "order": 1,
        "width": "4",
        "height": "1",
        "passthru": true,
        "topic": "bbq/probe/1",
        "min": "10",
        "max": "90",
        "step": 1,
        "x": 170,
        "y": 520,
        "wires": [
            [
                "36625ef3.3ff4c2"
            ]
        ]
    },
    {
        "id": "fee5a0b4.d3336",
        "type": "ui_slider",
        "z": "29d73028.74b4a",
        "name": "",
        "label": "4",
        "group": "9cca1fdd.fd315",
        "order": 1,
        "width": "4",
        "height": "1",
        "passthru": true,
        "topic": "bbq/probe/1",
        "min": "10",
        "max": "90",
        "step": 1,
        "x": 170,
        "y": 560,
        "wires": [
            [
                "a0b3e3fc.f1463"
            ]
        ]
    },
    {
        "id": "f01ba07f.b219e",
        "type": "debug",
        "z": "29d73028.74b4a",
        "name": "input",
        "active": false,
        "console": "false",
        "complete": "true",
        "x": 530,
        "y": 440,
        "wires": []
    },
    {
        "id": "e8f5c2a1.34456",
        "type": "debug",
        "z": "29d73028.74b4a",
        "name": "output",
        "active": false,
        "console": "false",
        "complete": "true",
        "x": 770,
        "y": 420,
        "wires": []
    },
    {
        "id": "d71091bc.2ecb8",
        "type": "debug",
        "z": "29d73028.74b4a",
        "name": "msg all",
        "active": false,
        "console": "false",
        "complete": "true",
        "x": 780,
        "y": 480,
        "wires": []
    },
    {
        "id": "72e80bb2.46ea04",
        "type": "http in",
        "z": "9292e51b.eaf788",
        "name": "",
        "url": "tasker",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 150,
        "y": 440,
        "wires": [
            [
                "74bc6004.618bc",
                "3a4aa580.8853ea"
            ]
        ]
    },
    {
        "id": "7d1c7516.71802c",
        "type": "mysencap",
        "z": "9292e51b.eaf788",
        "name": "",
        "nodeid": "220",
        "childid": "1",
        "subtype": "2",
        "internal": 0,
        "ack": false,
        "msgtype": 1,
        "presentation": true,
        "presentationtype": 0,
        "presentationtext": "Presence 1",
        "fullpresentation": true,
        "firmwarename": "tasker",
        "firmwareversion": "1",
        "x": 700,
        "y": 440,
        "wires": [
            [
                "53c8aa80.0c7564"
            ]
        ]
    },
    {
        "id": "8eb060c5.65dd",
        "type": "function",
        "z": "9292e51b.eaf788",
        "name": "",
        "func": "payload = msg.payload;\nif (payload.arbjede === \"Ankommet\") {\n    payload = 1;\n} else {\n    payload = 0;\n}\nmsg.payload = payload;\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "x": 470,
        "y": 440,
        "wires": [
            [
                "7d1c7516.71802c"
            ]
        ]
    },
    {
        "id": "7ec6243f.89990c",
        "type": "mqtt in",
        "z": "67deb464.98214c",
        "name": "",
        "topic": "mys-in/#",
        "qos": "2",
        "broker": "4798f2b0.5d747c",
        "x": 120,
        "y": 700,
        "wires": [
            [
                "e67de015.8476e",
                "f11a2832.07d9d8",
                "eec30a1f.d7c4a8"
            ]
        ]
    },
    {
        "id": "9150e4b1.7e87f8",
        "type": "mqtt in",
        "z": "36f02452.2e99bc",
        "name": "",
        "topic": "dashboard/sensors/11/+/+/+/+",
        "qos": "2",
        "broker": "4798f2b0.5d747c",
        "x": 140,
        "y": 160,
        "wires": [
            [
                "beb834aa.730368"
            ]
        ]
    },
    {
        "id": "f11a2832.07d9d8",
        "type": "mysdecode",
        "z": "67deb464.98214c",
        "name": "",
        "mqtt": true,
        "x": 380,
        "y": 700,
        "wires": [
            [
                "c1d9ad73.24529",
                "abd263fa.807d3"
            ]
        ]
    },
    {
        "id": "399d6b35.892e74",
        "type": "debug",
        "z": "d2be3a2a.67d4b8",
        "name": "",
        "active": true,
        "console": "false",
        "complete": "true",
        "x": 1090,
        "y": 120,
        "wires": []
    },
    {
        "id": "cc0c0e63.6b405",
        "type": "function",
        "z": "d2be3a2a.67d4b8",
        "name": "Translate",
        "func": "a = msg.payload;\n\nif (a.activityStatus === 1 || a.activityStatus === 0) {\n    switch(a.activityId) {\n        case \"20800334\":\n            activity = \"Stream Video\";\n            break;\n        case \"21395657\":\n            activity = \"Stream Audio\";\n            break;\n        case \"24516381\":\n            activity = \"CD\";\n            flow.set('device', 'dvd');\n            break;\n        case \"20795082\":\n            activity = \"Radio\";\n            break;\n        case \"20800253\":\n            activity = \"DVD\";\n            break;\n        case \"20800328\":\n            activity = \"WII\";\n            break;        \n        case \"20800510\":\n            activity = \"TV\";\n            break;\n        case \"35554241\":\n            activity = \"PS2\"\n            break;\n        case \"-1\":\n            activity = \"OFF\";\n            break;\n        default:\n            activity = msg.payload.activityId;\n            break;\n    }\n    \n    msg.payload.activityName = activity;\n    global.set('avctrl',  activity.toLowerCase());\n    return msg;\n}",
        "outputs": 1,
        "noerr": 0,
        "x": 920,
        "y": 160,
        "wires": [
            [
                "e2a5f61a.7dd638",
                "399d6b35.892e74"
            ]
        ]
    },
    {
        "id": "e2a5f61a.7dd638",
        "type": "mqtt out",
        "z": "d2be3a2a.67d4b8",
        "name": "",
        "topic": "avctrl/out/scene",
        "qos": "2",
        "retain": "true",
        "broker": "4798f2b0.5d747c",
        "x": 1120,
        "y": 160,
        "wires": []
    },
    {
        "id": "6b273a3.c572dc4",
        "type": "H activity",
        "z": "d2be3a2a.67d4b8",
        "name": "Stream video",
        "server": "56b003cf.93c9bc",
        "activity": "20800334",
        "label": "Chromecast TV",
        "x": 490,
        "y": 80,
        "wires": [
            []
        ]
    },
    {
        "id": "ebf8b052.43e42",
        "type": "H activity",
        "z": "d2be3a2a.67d4b8",
        "name": "Stream audio",
        "server": "56b003cf.93c9bc",
        "activity": "21395657",
        "label": "Chromecast Audio",
        "x": 490,
        "y": 120,
        "wires": [
            []
        ]
    },
    {
        "id": "2889457c.b0268a",
        "type": "H activity",
        "z": "d2be3a2a.67d4b8",
        "name": "WII",
        "server": "56b003cf.93c9bc",
        "activity": "20800328",
        "label": "Play Wii",
        "x": 470,
        "y": 160,
        "wires": [
            []
        ]
    },
    {
        "id": "4bef3015.f4a8b",
        "type": "H activity",
        "z": "d2be3a2a.67d4b8",
        "name": "OFF",
        "server": "56b003cf.93c9bc",
        "activity": "-1",
        "label": "PowerOff",
        "x": 470,
        "y": 320,
        "wires": [
            [
                "5ddfc643.37dea8"
            ]
        ]
    },
    {
        "id": "a5649af7.74fca8",
        "type": "switch",
        "z": "d2be3a2a.67d4b8",
        "name": "admin",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "video",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "audio",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "wii",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "tv",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "dvd",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "ps2",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 7,
        "x": 290,
        "y": 180,
        "wires": [
            [
                "6b273a3.c572dc4"
            ],
            [
                "ebf8b052.43e42"
            ],
            [
                "2889457c.b0268a"
            ],
            [
                "c1263114.4ef3f"
            ],
            [
                "541a6418.f052ec"
            ],
            [
                "f6342f76.5471f"
            ],
            [
                "4bef3015.f4a8b"
            ]
        ]
    },
    {
        "id": "61c85fe8.98526",
        "type": "mqtt in",
        "z": "d2be3a2a.67d4b8",
        "name": "",
        "topic": "avctrl/in/scene",
        "qos": "2",
        "broker": "4798f2b0.5d747c",
        "x": 110,
        "y": 180,
        "wires": [
            [
                "a5649af7.74fca8",
                "a6f70bb5.935f78"
            ]
        ]
    },
    {
        "id": "2c73477.9c149b8",
        "type": "switch",
        "z": "d2be3a2a.67d4b8",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "volumeup",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "volumedown",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "mute",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 4,
        "x": 290,
        "y": 480,
        "wires": [
            [
                "f5568b5f.898cc8"
            ],
            [
                "367a93b4.65ee8c"
            ],
            [
                "c70cb7be.595738"
            ],
            [
                "fc2bd7be.c40148"
            ]
        ]
    },
    {
        "id": "f5568b5f.898cc8",
        "type": "H command",
        "z": "d2be3a2a.67d4b8",
        "name": "Volume UP",
        "server": "56b003cf.93c9bc",
        "activity": "21395657",
        "label": "Chromecast Audio",
        "command": "%7B%22command%22::%22VolumeUp%22,%22type%22::%22IRCommand%22,%22deviceId%22::%2237008441%22%7D",
        "repeat": "1",
        "x": 490,
        "y": 400,
        "wires": [
            []
        ]
    },
    {
        "id": "367a93b4.65ee8c",
        "type": "H command",
        "z": "d2be3a2a.67d4b8",
        "name": "Volume DOWN",
        "server": "56b003cf.93c9bc",
        "activity": "21395657",
        "label": "Chromecast Audio",
        "command": "%7B%22command%22::%22VolumeDown%22,%22type%22::%22IRCommand%22,%22deviceId%22::%2237008441%22%7D",
        "repeat": "1",
        "x": 500,
        "y": 440,
        "wires": [
            []
        ]
    },
    {
        "id": "1bb38ed7.f57a81",
        "type": "mqtt in",
        "z": "d2be3a2a.67d4b8",
        "name": "",
        "topic": "avctrl/in/control",
        "qos": "2",
        "broker": "4798f2b0.5d747c",
        "x": 120,
        "y": 480,
        "wires": [
            [
                "2c73477.9c149b8",
                "9b166d59.19dab"
            ]
        ]
    },
    {
        "id": "c70cb7be.595738",
        "type": "H command",
        "z": "d2be3a2a.67d4b8",
        "name": "Mute",
        "server": "56b003cf.93c9bc",
        "activity": "21395657",
        "label": "Chromecast TV",
        "command": "%7B%22command%22::%22Mute%22,%22type%22::%22IRCommand%22,%22deviceId%22::%2237008441%22%7D",
        "repeat": "1",
        "x": 470,
        "y": 480,
        "wires": [
            []
        ]
    },
    {
        "id": "c7a4cf85.bac8a",
        "type": "mysencap",
        "z": "d9d4d547.6a9438",
        "name": "Sofa LED",
        "nodeid": "14",
        "childid": "1",
        "subtype": "3",
        "internal": 0,
        "ack": false,
        "msgtype": 1,
        "presentation": false,
        "presentationtype": 0,
        "presentationtext": "",
        "fullpresentation": false,
        "firmwarename": "",
        "firmwareversion": "",
        "x": 740,
        "y": 140,
        "wires": [
            [
                "743ac734.623e78"
            ]
        ]
    },
    {
        "id": "743ac734.623e78",
        "type": "mysencode",
        "z": "d9d4d547.6a9438",
        "name": "mys-out",
        "mqtt": true,
        "mqtttopic": "mys-out",
        "x": 900,
        "y": 180,
        "wires": [
            [
                "229fa356.e7c70c",
                "4e93a2b6.c2995c"
            ]
        ]
    },
    {
        "id": "229fa356.e7c70c",
        "type": "mqtt out",
        "z": "d9d4d547.6a9438",
        "name": "",
        "topic": "",
        "qos": "2",
        "retain": "false",
        "broker": "4798f2b0.5d747c",
        "x": 1050,
        "y": 200,
        "wires": []
    },
    {
        "id": "72a0f42e.57bf4c",
        "type": "debug",
        "z": "d9d4d547.6a9438",
        "name": "",
        "active": true,
        "console": "false",
        "complete": "false",
        "x": 570,
        "y": 100,
        "wires": []
    },
    {
        "id": "4e93a2b6.c2995c",
        "type": "debug",
        "z": "d9d4d547.6a9438",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 1050,
        "y": 160,
        "wires": []
    },
    {
        "id": "2c89a82a.ecab58",
        "type": "mysencap",
        "z": "d9d4d547.6a9438",
        "name": "Fjernsyn LED",
        "nodeid": "13",
        "childid": "1",
        "subtype": "3",
        "internal": 0,
        "ack": false,
        "msgtype": 1,
        "presentation": false,
        "presentationtype": 0,
        "presentationtext": "",
        "fullpresentation": false,
        "firmwarename": "",
        "firmwareversion": "",
        "x": 580,
        "y": 180,
        "wires": [
            [
                "743ac734.623e78"
            ]
        ]
    },
    {
        "id": "7f194889.4cf208",
        "type": "H observe",
        "z": "d2be3a2a.67d4b8",
        "name": "",
        "server": "56b003cf.93c9bc",
        "x": 760,
        "y": 160,
        "wires": [
            [
                "cc0c0e63.6b405",
                "4fbfed2b.777914"
            ]
        ]
    },
    {
        "id": "de43824f.f00d5",
        "type": "mqtt in",
        "z": "d9d4d547.6a9438",
        "name": "",
        "topic": "chromecast/+/app",
        "qos": "2",
        "broker": "4798f2b0.5d747c",
        "x": 130,
        "y": 360,
        "wires": [
            [
                "e1cbaf9b.7c245",
                "a76ee66b.35b7d8"
            ]
        ]
    },
    {
        "id": "3a4aa580.8853ea",
        "type": "json",
        "z": "9292e51b.eaf788",
        "name": "",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 350,
        "y": 440,
        "wires": [
            [
                "8eb060c5.65dd"
            ]
        ]
    },
    {
        "id": "dc02a5c9.b595a8",
        "type": "mqtt out",
        "z": "36f02452.2e99bc",
        "name": "",
        "topic": "",
        "qos": "2",
        "retain": "false",
        "broker": "4798f2b0.5d747c",
        "x": 1570,
        "y": 500,
        "wires": []
    },
    {
        "id": "fb4b92ff.085b3",
        "type": "ui_switch",
        "z": "36f02452.2e99bc",
        "name": "",
        "label": "Sofa",
        "group": "bf3de794.50d788",
        "order": 1,
        "width": "2",
        "height": "1",
        "passthru": true,
        "decouple": "false",
        "topic": "mys-out/14/1/1/1/2",
        "style": "",
        "onvalue": "1",
        "onvalueType": "str",
        "onicon": "",
        "oncolor": "",
        "offvalue": "0",
        "offvalueType": "str",
        "officon": "",
        "offcolor": "",
        "x": 1090,
        "y": 500,
        "wires": [
            [
                "7e85add0.c89414"
            ]
        ]
    },
    {
        "id": "7e7a764e.5656a8",
        "type": "sunrise",
        "z": "d9d4d547.6a9438",
        "name": "sunrise / fall",
        "lat": "56.774153",
        "lon": "10.170926",
        "start": "goldenHourEnd",
        "end": "goldenHour",
        "x": 110,
        "y": 720,
        "wires": [
            [
                "6bab362a.1710c8"
            ],
            []
        ]
    },
    {
        "id": "2a217e70.aac6f2",
        "type": "mqtt in",
        "z": "d9d4d547.6a9438",
        "name": "",
        "topic": "avctrl/out/scene",
        "qos": "2",
        "broker": "4798f2b0.5d747c",
        "x": 120,
        "y": 500,
        "wires": [
            [
                "d2cb106b.f2fd",
                "71d6bbea.c9f064"
            ]
        ]
    },
    {
        "id": "3e41fa8d.6fbaa6",
        "type": "ui_slider",
        "z": "36f02452.2e99bc",
        "name": "",
        "label": "Film afspil lysstyrke",
        "group": "e8eb39ba.7799b8",
        "order": 0,
        "width": 0,
        "height": 0,
        "passthru": true,
        "topic": "conf/light/movieplay",
        "min": 0,
        "max": "100",
        "step": 1,
        "x": 410,
        "y": 980,
        "wires": [
            []
        ]
    },
    {
        "id": "4eb21fcf.0ae0a",
        "type": "ui_slider",
        "z": "36f02452.2e99bc",
        "name": "",
        "label": "Film pause lysstyrke",
        "group": "e8eb39ba.7799b8",
        "order": 0,
        "width": 0,
        "height": 0,
        "passthru": true,
        "topic": "conf/light/moviepause",
        "min": 0,
        "max": "100",
        "step": 1,
        "x": 420,
        "y": 1020,
        "wires": [
            []
        ]
    },
    {
        "id": "fe4fa6ea.b04af8",
        "type": "mqtt in",
        "z": "36f02452.2e99bc",
        "name": "",
        "topic": "dashboard/sensors/14/1/1/+/2",
        "qos": "2",
        "broker": "4798f2b0.5d747c",
        "x": 840,
        "y": 500,
        "wires": [
            [
                "fb4b92ff.085b3"
            ]
        ]
    },
    {
        "id": "9f7173a5.0857",
        "type": "delay",
        "z": "d9d4d547.6a9438",
        "name": "",
        "pauseType": "delay",
        "timeout": "2",
        "timeoutUnits": "minutes",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 640,
        "y": 340,
        "wires": [
            [
                "500d2e4.d03e5d"
            ]
        ]
    },
    {
        "id": "e1cbaf9b.7c245",
        "type": "function",
        "z": "d9d4d547.6a9438",
        "name": "Auto power on / off av center",
        "func": "// Store app for the current device in context\n// So we can retrieve it in other functions\nconst regex = /chromecast\\/(.*)\\//g;\nvar app = msg.payload || 'None'\nm = regex.exec(msg.topic)\ndevice = m[1];\nflow.set(device + \"_app\", app);\nvar avctrl = global.get(\"avctrl\") || \"OFF\";\n\nmsg1 = null;\nmsg2 = null;\n\n// Get current app on the \"other\" chromecast\nother_device = 'audio_stuen';\nif (device === 'audio_stuen') {\n    other_device = 'tv_stuen';\n}\nother_app = flow.get(other_device + '_app') || 'None';\nnode.log('autoshutoff');\nnode.log(app);\nnode.log(other_app);\nnode.log(avctrl);\n// Start power off countdown if no activity\nif ((app === 'None' || app === 'Backdrop') && \n    (other_app ==='None' || other_app === 'Backdrop') &&\n    avctrl.includes('stream')) {\n    msg1 = {payload: \"off\"};\n} else {\n    msg1 = {reset: \"YES\"};\n}\n\n// If the other chromecast is iddle, then we can start our \"thing\"\nif (other_app === 'None' || other_app === 'Backdrop') {\n    if ((app !== 'None') && (app !== 'Backdrop')) {\n        if (device === 'tv_stuen') {\n            msg2 = {payload: 'video'};\n        } else {\n            msg2 = {payload: 'audio'};\n        }\n    }   \n} \n\nreturn [msg1, msg2];",
        "outputs": 2,
        "noerr": 0,
        "x": 400,
        "y": 360,
        "wires": [
            [
                "9f7173a5.0857",
                "1fcb323.25bfbce"
            ],
            [
                "500d2e4.d03e5d",
                "f590fc3b.47d43"
            ]
        ]
    },
    {
        "id": "500d2e4.d03e5d",
        "type": "mqtt out",
        "z": "d9d4d547.6a9438",
        "name": "",
        "topic": "avctrl/in/scene",
        "qos": "2",
        "retain": "false",
        "broker": "4798f2b0.5d747c",
        "x": 820,
        "y": 360,
        "wires": []
    },
    {
        "id": "a353260f.63b8f8",
        "type": "mqtt in",
        "z": "d9d4d547.6a9438",
        "name": "",
        "topic": "dashboard/sensors/#",
        "qos": "2",
        "broker": "4798f2b0.5d747c",
        "x": 140,
        "y": 660,
        "wires": [
            [
                "1faad09a.219b4f"
            ]
        ]
    },
    {
        "id": "b809b24d.95ec2",
        "type": "function",
        "z": "d9d4d547.6a9438",
        "name": "store sensordata",
        "func": "var path = 'sensor'+msg.nodeId+'_'+msg.childSensorId+'_'+msg.subType;\ndata = msg.payload\nglobal.set(path, data);\nmsg.payload = path + \"::\" + data\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 650,
        "y": 660,
        "wires": [
            [
                "dbf120d6.901e8"
            ]
        ]
    },
    {
        "id": "1faad09a.219b4f",
        "type": "mysdecode",
        "z": "d9d4d547.6a9438",
        "name": "",
        "mqtt": true,
        "x": 360,
        "y": 660,
        "wires": [
            [
                "b809b24d.95ec2"
            ]
        ]
    },
    {
        "id": "dbe26677.cae0b8",
        "type": "function",
        "z": "d9d4d547.6a9438",
        "name": "is sofa light on",
        "func": "light = Number(global.get('sensor14_1_3') || 0);\nif (light >0 ) {\n    return msg;\n}\n",
        "outputs": 1,
        "noerr": 0,
        "x": 580,
        "y": 140,
        "wires": [
            [
                "c7a4cf85.bac8a"
            ]
        ]
    },
    {
        "id": "dbf120d6.901e8",
        "type": "debug",
        "z": "d9d4d547.6a9438",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 830,
        "y": 660,
        "wires": []
    },
    {
        "id": "6c291426.31b7ac",
        "type": "comment",
        "z": "d9d4d547.6a9438",
        "name": "Chromecast turn AV on/off automatically",
        "info": "",
        "x": 190,
        "y": 320,
        "wires": []
    },
    {
        "id": "640e3456.6fb06c",
        "type": "comment",
        "z": "d9d4d547.6a9438",
        "name": "Movie theatre lights",
        "info": "",
        "x": 130,
        "y": 100,
        "wires": []
    },
    {
        "id": "d62cabb4.b9d228",
        "type": "ui_gauge",
        "z": "36f02452.2e99bc",
        "name": "",
        "group": "d9490c52.897ce",
        "order": 1,
        "width": "3",
        "height": "3",
        "gtype": "gage",
        "title": "Temperatur",
        "label": "C",
        "format": "{{value| number:1}}°",
        "min": "15",
        "max": "25",
        "colors": [
            "#430ca9",
            "#04e10a",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "x": 550,
        "y": 620,
        "wires": []
    },
    {
        "id": "4865b18a.983f4",
        "type": "ui_gauge",
        "z": "36f02452.2e99bc",
        "name": "",
        "group": "d9490c52.897ce",
        "order": 2,
        "width": "3",
        "height": "3",
        "gtype": "gage",
        "title": "Fugt",
        "label": "rH",
        "format": "{{value}}%",
        "min": "40",
        "max": "60",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "x": 530,
        "y": 660,
        "wires": []
    },
    {
        "id": "ae8620c1.e8d8",
        "type": "ui_chart",
        "z": "36f02452.2e99bc",
        "name": "",
        "group": "85f5cfaa.42289",
        "order": 2,
        "width": "3",
        "height": "3",
        "label": "Temperatur",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "86400",
        "cutout": 0,
        "useOneColor": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "useOldStyle": false,
        "outputs": 2,
        "x": 550,
        "y": 100,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "8e62a7b6.c90208",
        "type": "ui_chart",
        "z": "36f02452.2e99bc",
        "name": "",
        "group": "85f5cfaa.42289",
        "order": 4,
        "width": "3",
        "height": "3",
        "label": "Fugt",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "86400",
        "cutout": 0,
        "useOneColor": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "useOldStyle": false,
        "outputs": 2,
        "x": 530,
        "y": 180,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "6982d022.1b695",
        "type": "ui_chart",
        "z": "36f02452.2e99bc",
        "name": "",
        "group": "85f5cfaa.42289",
        "order": 6,
        "width": "3",
        "height": "3",
        "label": "Baro",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "86400",
        "cutout": 0,
        "useOneColor": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "useOldStyle": false,
        "outputs": 2,
        "x": 530,
        "y": 260,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "7d8661eb.8739e",
        "type": "ui_slider",
        "z": "36f02452.2e99bc",
        "name": "slider sofa",
        "label": "",
        "group": "bf3de794.50d788",
        "order": 2,
        "width": "4",
        "height": "1",
        "passthru": true,
        "topic": "mys-out/14/1/1/1/3",
        "min": 0,
        "max": "100",
        "step": 1,
        "x": 1110,
        "y": 540,
        "wires": [
            [
                "7e85add0.c89414"
            ]
        ]
    },
    {
        "id": "637df737.fe84e8",
        "type": "mqtt in",
        "z": "36f02452.2e99bc",
        "name": "",
        "topic": "dashboard/sensors/14/1/1/0/3",
        "qos": "2",
        "broker": "4798f2b0.5d747c",
        "x": 840,
        "y": 540,
        "wires": [
            [
                "7d8661eb.8739e"
            ]
        ]
    },
    {
        "id": "3206bfff.039d5",
        "type": "debug",
        "z": "36f02452.2e99bc",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 1390,
        "y": 540,
        "wires": []
    },
    {
        "id": "7e85add0.c89414",
        "type": "function",
        "z": "36f02452.2e99bc",
        "name": "",
        "func": "if (msg.retain === undefined)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1230,
        "y": 520,
        "wires": [
            [
                "3206bfff.039d5",
                "f14dc53c.d72c78"
            ]
        ]
    },
    {
        "id": "f14dc53c.d72c78",
        "type": "delay",
        "z": "36f02452.2e99bc",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": true,
        "x": 1410,
        "y": 500,
        "wires": [
            [
                "dc02a5c9.b595a8"
            ]
        ]
    },
    {
        "id": "d0491803.13e098",
        "type": "ui_gauge",
        "z": "ca4f572b.274038",
        "name": "",
        "group": "d9490c52.897ce",
        "order": 5,
        "width": "3",
        "height": "3",
        "gtype": "gage",
        "title": "Gulv temperatur",
        "label": "C",
        "format": "{{value}}°",
        "min": "20",
        "max": "35",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "x": 1020,
        "y": 160,
        "wires": []
    },
    {
        "id": "249b235c.4b97ec",
        "type": "switch",
        "z": "ca4f572b.274038",
        "name": "Varmesystem",
        "property": "childSensorId",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "0",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "1",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "2",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "3",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "outputs": 4,
        "x": 800,
        "y": 220,
        "wires": [
            [
                "d0491803.13e098",
                "5380ea70.734c84"
            ],
            [
                "353691c2.45d69e"
            ],
            [
                "51e7d896.9b0928"
            ],
            [
                "dee43e87.5c92b"
            ]
        ]
    },
    {
        "id": "353691c2.45d69e",
        "type": "ui_gauge",
        "z": "ca4f572b.274038",
        "name": "",
        "group": "9f6b85e1.adc7d8",
        "order": 1,
        "width": "3",
        "height": "3",
        "gtype": "gage",
        "title": "Fremløb",
        "label": "C",
        "format": "{{value}}°",
        "min": "30",
        "max": "70",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "x": 1000,
        "y": 200,
        "wires": []
    },
    {
        "id": "51e7d896.9b0928",
        "type": "ui_gauge",
        "z": "ca4f572b.274038",
        "name": "",
        "group": "9f6b85e1.adc7d8",
        "order": 2,
        "width": "3",
        "height": "3",
        "gtype": "gage",
        "title": "Retur",
        "label": "C",
        "format": "{{value}}°",
        "min": "30",
        "max": "70",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "x": 990,
        "y": 240,
        "wires": []
    },
    {
        "id": "dee43e87.5c92b",
        "type": "ui_gauge",
        "z": "ca4f572b.274038",
        "name": "",
        "group": "9f6b85e1.adc7d8",
        "order": 4,
        "width": "3",
        "height": "3",
        "gtype": "gage",
        "title": "Varmt vand",
        "label": "C",
        "format": "{{value}}°",
        "min": "40",
        "max": "50",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "x": 1010,
        "y": 280,
        "wires": []
    },
    {
        "id": "5380ea70.734c84",
        "type": "ui_gauge",
        "z": "ca4f572b.274038",
        "name": "",
        "group": "9f6b85e1.adc7d8",
        "order": 3,
        "width": "3",
        "height": "3",
        "gtype": "gage",
        "title": "Gulv temperatur",
        "label": "units",
        "format": "{{value}}°",
        "min": "20",
        "max": "35",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "x": 1020,
        "y": 120,
        "wires": []
    },
    {
        "id": "6119f7dd.4fddb8",
        "type": "mqtt in",
        "z": "ca4f572b.274038",
        "name": "",
        "topic": "dashboard/sensors/20/+/+/0/0",
        "qos": "2",
        "broker": "4798f2b0.5d747c",
        "x": 360,
        "y": 220,
        "wires": [
            [
                "52fb9a86.3b9fc4"
            ]
        ]
    },
    {
        "id": "52fb9a86.3b9fc4",
        "type": "mysdecode",
        "z": "ca4f572b.274038",
        "name": "",
        "mqtt": true,
        "x": 620,
        "y": 220,
        "wires": [
            [
                "249b235c.4b97ec"
            ]
        ]
    },
    {
        "id": "83740ef.6f27df",
        "type": "ui_switch",
        "z": "ca4f572b.274038",
        "name": "",
        "label": "Sommer mode",
        "group": "165c814.4d5267f",
        "order": 1,
        "width": "3",
        "height": "1",
        "passthru": true,
        "decouple": "false",
        "topic": "mys-out/20/8/1/1/2",
        "style": "",
        "onvalue": "1",
        "onvalueType": "str",
        "onicon": "",
        "oncolor": "",
        "offvalue": "0",
        "offvalueType": "str",
        "officon": "",
        "offcolor": "",
        "x": 620,
        "y": 480,
        "wires": [
            [
                "d162a55c.dbd7a8"
            ]
        ]
    },
    {
        "id": "59025281.1f294c",
        "type": "ui_switch",
        "z": "ca4f572b.274038",
        "name": "",
        "label": "Ventil",
        "group": "165c814.4d5267f",
        "order": 2,
        "width": "3",
        "height": "1",
        "passthru": true,
        "decouple": "false",
        "topic": "mys-out/20/6/1/1/2",
        "style": "",
        "onvalue": "1",
        "onvalueType": "str",
        "onicon": "",
        "oncolor": "",
        "offvalue": "0",
        "offvalueType": "str",
        "officon": "",
        "offcolor": "",
        "x": 590,
        "y": 520,
        "wires": [
            []
        ]
    },
    {
        "id": "ca75c2fb.c0421",
        "type": "ui_numeric",
        "z": "ca4f572b.274038",
        "name": "",
        "label": "Gulvvarme termostat",
        "group": "165c814.4d5267f",
        "order": 6,
        "width": 0,
        "height": 0,
        "passthru": true,
        "topic": "mys-out/20/0/1/1/45",
        "format": "{{value}}&deg;C",
        "min": "20",
        "max": "35",
        "step": "0.5",
        "x": 640,
        "y": 400,
        "wires": [
            [
                "d162a55c.dbd7a8"
            ]
        ]
    },
    {
        "id": "23d7ab5a.c27aa4",
        "type": "mqtt in",
        "z": "ca4f572b.274038",
        "name": "",
        "topic": "dashboard/sensors/20/0/1/+/45",
        "qos": "2",
        "broker": "4798f2b0.5d747c",
        "x": 370,
        "y": 400,
        "wires": [
            [
                "ca75c2fb.c0421"
            ]
        ]
    },
    {
        "id": "b242c4b5.45fff8",
        "type": "mqtt out",
        "z": "ca4f572b.274038",
        "name": "",
        "topic": "",
        "qos": "2",
        "retain": "false",
        "broker": "4798f2b0.5d747c",
        "x": 1090,
        "y": 500,
        "wires": []
    },
    {
        "id": "22cfe514.e2f19a",
        "type": "ui_numeric",
        "z": "ca4f572b.274038",
        "name": "",
        "label": "Indløbs temperatur til hent varme",
        "group": "165c814.4d5267f",
        "order": 5,
        "width": 0,
        "height": 0,
        "passthru": true,
        "topic": "mys-out/20/1/1/0/45",
        "format": "{{value}}&deg;C",
        "min": "25",
        "max": "40",
        "step": "0.5",
        "x": 680,
        "y": 440,
        "wires": [
            [
                "d162a55c.dbd7a8"
            ]
        ]
    },
    {
        "id": "e6bb190c.909188",
        "type": "mqtt in",
        "z": "ca4f572b.274038",
        "name": "",
        "topic": "dashboard/sensors/20/1/1/+/45",
        "qos": "2",
        "broker": "4798f2b0.5d747c",
        "x": 370,
        "y": 440,
        "wires": [
            [
                "22cfe514.e2f19a"
            ]
        ]
    },
    {
        "id": "769f0ea5.e6752",
        "type": "mqtt in",
        "z": "ca4f572b.274038",
        "name": "",
        "topic": "dashboard/sensors/20/8/1/+/2",
        "qos": "2",
        "broker": "4798f2b0.5d747c",
        "x": 360,
        "y": 480,
        "wires": [
            [
                "83740ef.6f27df"
            ]
        ]
    },
    {
        "id": "1df4132c.a2329d",
        "type": "mqtt in",
        "z": "ca4f572b.274038",
        "name": "",
        "topic": "dashboard/sensors/20/6/1/+/2",
        "qos": "2",
        "broker": "4798f2b0.5d747c",
        "x": 360,
        "y": 520,
        "wires": [
            [
                "59025281.1f294c"
            ]
        ]
    },
    {
        "id": "f71208eb.1e1808",
        "type": "mqtt in",
        "z": "ca4f572b.274038",
        "name": "",
        "topic": "dashboard/sensors/20/7/1/+/2",
        "qos": "2",
        "broker": "4798f2b0.5d747c",
        "x": 360,
        "y": 560,
        "wires": [
            [
                "1f8b5b93.7bbc84"
            ]
        ]
    },
    {
        "id": "1f8b5b93.7bbc84",
        "type": "ui_switch",
        "z": "ca4f572b.274038",
        "name": "",
        "label": "Pumpe",
        "group": "165c814.4d5267f",
        "order": 3,
        "width": "3",
        "height": "1",
        "passthru": true,
        "decouple": "false",
        "topic": "mys-out/20/7/1/1/2",
        "style": "",
        "onvalue": "1",
        "onvalueType": "str",
        "onicon": "",
        "oncolor": "",
        "offvalue": "0",
        "offvalueType": "str",
        "officon": "",
        "offcolor": "",
        "x": 600,
        "y": 560,
        "wires": [
            []
        ]
    },
    {
        "id": "90261eb0.1dda9",
        "type": "ui_switch",
        "z": "ca4f572b.274038",
        "name": "",
        "label": "Hent varme",
        "group": "165c814.4d5267f",
        "order": 4,
        "width": "3",
        "height": "1",
        "passthru": false,
        "decouple": "true",
        "topic": "mys-out/20/6/1/1/2",
        "style": "",
        "onvalue": "1",
        "onvalueType": "str",
        "onicon": "",
        "oncolor": "",
        "offvalue": "0",
        "offvalueType": "str",
        "officon": "",
        "offcolor": "",
        "x": 610,
        "y": 600,
        "wires": [
            [
                "d162a55c.dbd7a8"
            ]
        ]
    },
    {
        "id": "16053676.c1723a",
        "type": "mqtt in",
        "z": "ca4f572b.274038",
        "name": "",
        "topic": "dashboard/sensors/20/5/1/+/2",
        "qos": "2",
        "broker": "4798f2b0.5d747c",
        "x": 360,
        "y": 600,
        "wires": [
            [
                "90261eb0.1dda9"
            ]
        ]
    },
    {
        "id": "d162a55c.dbd7a8",
        "type": "function",
        "z": "ca4f572b.274038",
        "name": "",
        "func": "if (msg.retain === undefined)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 950,
        "y": 500,
        "wires": [
            [
                "b242c4b5.45fff8"
            ]
        ]
    },
    {
        "id": "d4c611b2.4c162",
        "type": "ui_gauge",
        "z": "36f02452.2e99bc",
        "name": "Elforbrug aktuelt",
        "group": "d9490c52.897ce",
        "order": 3,
        "width": "3",
        "height": "3",
        "gtype": "gage",
        "title": "Elforbrug",
        "label": "W",
        "format": "{{value| number:1}}",
        "min": "40",
        "max": "4000",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "1000",
        "seg2": "2000",
        "x": 1100,
        "y": 660,
        "wires": []
    },
    {
        "id": "b3e6a596.add9a8",
        "type": "ui_gauge",
        "z": "36f02452.2e99bc",
        "name": "",
        "group": "e11ff54d.12ad78",
        "order": 1,
        "width": "3",
        "height": "3",
        "gtype": "gage",
        "title": "Temperatur",
        "label": "C",
        "format": "{{value}}°",
        "min": "15",
        "max": "25",
        "colors": [
            "#430ca9",
            "#04e10a",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "x": 550,
        "y": 320,
        "wires": []
    },
    {
        "id": "68de03bf.382d8c",
        "type": "ui_gauge",
        "z": "36f02452.2e99bc",
        "name": "",
        "group": "e11ff54d.12ad78",
        "order": 2,
        "width": "3",
        "height": "3",
        "gtype": "gage",
        "title": "Fugt",
        "label": "rH",
        "format": "{{value}}%",
        "min": "40",
        "max": "60",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "x": 530,
        "y": 360,
        "wires": []
    },
    {
        "id": "c4285cac.b7dcb",
        "type": "mysdecode",
        "z": "8bc8753a.1ea768",
        "name": "",
        "mqtt": true,
        "x": 340,
        "y": 380,
        "wires": [
            [
                "a133b28e.29844"
            ]
        ]
    },
    {
        "id": "a133b28e.29844",
        "type": "switch",
        "z": "8bc8753a.1ea768",
        "name": "subTypeSplit",
        "property": "subType",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "0",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "1",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "9",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "outputs": 3,
        "x": 510,
        "y": 380,
        "wires": [
            [
                "9b1ad06.4a8493"
            ],
            [],
            []
        ]
    },
    {
        "id": "fc3093dc.9405",
        "type": "subflow:8bc8753a.1ea768",
        "z": "36f02452.2e99bc",
        "name": "badeværelse",
        "x": 370,
        "y": 360,
        "wires": [
            [
                "b3e6a596.add9a8"
            ],
            [
                "68de03bf.382d8c"
            ],
            [],
            [
                "f51b6568.3a4f58"
            ]
        ]
    },
    {
        "id": "c998ff2f.d3ebf",
        "type": "mqtt in",
        "z": "36f02452.2e99bc",
        "name": "",
        "topic": "dashboard/sensors/9/+/+/+/+",
        "qos": "2",
        "broker": "4798f2b0.5d747c",
        "x": 140,
        "y": 360,
        "wires": [
            [
                "fc3093dc.9405"
            ]
        ]
    },
    {
        "id": "beb834aa.730368",
        "type": "subflow:8bc8753a.1ea768",
        "z": "36f02452.2e99bc",
        "name": "udendørs",
        "x": 360,
        "y": 160,
        "wires": [
            [
                "ae8620c1.e8d8",
                "ad8c0dc6.4f64a"
            ],
            [
                "4f7cb0eb.0d19a",
                "8e62a7b6.c90208"
            ],
            [
                "5115f872.4620e8",
                "6982d022.1b695"
            ],
            [
                "25d7d30a.26ffac",
                "2a57fcca.e5f8f4"
            ]
        ]
    },
    {
        "id": "b1641b7d.068c98",
        "type": "ui_gauge",
        "z": "36f02452.2e99bc",
        "name": "",
        "group": "1215f3be.8c080c",
        "order": 1,
        "width": "3",
        "height": "3",
        "gtype": "gage",
        "title": "Temperatur",
        "label": "C",
        "format": "{{value}}",
        "min": "15",
        "max": "25",
        "colors": [
            "#430ca9",
            "#04e10a",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "x": 550,
        "y": 420,
        "wires": []
    },
    {
        "id": "f7105844.05c978",
        "type": "ui_gauge",
        "z": "36f02452.2e99bc",
        "name": "",
        "group": "1215f3be.8c080c",
        "order": 2,
        "width": "3",
        "height": "3",
        "gtype": "gage",
        "title": "Fugt",
        "label": "rH",
        "format": "{{value}}%",
        "min": "40",
        "max": "60",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "x": 530,
        "y": 460,
        "wires": []
    },
    {
        "id": "a41abb3e.268738",
        "type": "subflow:8bc8753a.1ea768",
        "z": "36f02452.2e99bc",
        "name": "soveværelse",
        "x": 370,
        "y": 460,
        "wires": [
            [
                "b1641b7d.068c98"
            ],
            [
                "f7105844.05c978"
            ],
            [],
            [
                "b4b40152.cacdf"
            ]
        ]
    },
    {
        "id": "83463fd1.5897a",
        "type": "mqtt in",
        "z": "36f02452.2e99bc",
        "name": "",
        "topic": "dashboard/sensors/6/+/+/+/+",
        "qos": "2",
        "broker": "4798f2b0.5d747c",
        "x": 140,
        "y": 460,
        "wires": [
            [
                "a41abb3e.268738"
            ]
        ]
    },
    {
        "id": "134815a.88ef3ea",
        "type": "ui_gauge",
        "z": "36f02452.2e99bc",
        "name": "",
        "group": "58bcd57b.789b2c",
        "order": 1,
        "width": "3",
        "height": "3",
        "gtype": "gage",
        "title": "Temperatur",
        "label": "C",
        "format": "{{value}}°",
        "min": "15",
        "max": "25",
        "colors": [
            "#430ca9",
            "#04e10a",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "x": 550,
        "y": 520,
        "wires": []
    },
    {
        "id": "b984d89e.c852d8",
        "type": "ui_gauge",
        "z": "36f02452.2e99bc",
        "name": "",
        "group": "58bcd57b.789b2c",
        "order": 2,
        "width": "3",
        "height": "3",
        "gtype": "gage",
        "title": "Fugt",
        "label": "rH",
        "format": "{{value}}%",
        "min": "40",
        "max": "60",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "x": 530,
        "y": 560,
        "wires": []
    },
    {
        "id": "489cf0ec.b2982",
        "type": "subflow:8bc8753a.1ea768",
        "z": "36f02452.2e99bc",
        "name": "kontor",
        "x": 350,
        "y": 560,
        "wires": [
            [
                "134815a.88ef3ea"
            ],
            [
                "b984d89e.c852d8"
            ],
            [],
            [
                "d4022586.9648b8"
            ]
        ]
    },
    {
        "id": "7934a9ec.850148",
        "type": "mqtt in",
        "z": "36f02452.2e99bc",
        "name": "",
        "topic": "dashboard/sensors/200/+/+/+/+",
        "qos": "2",
        "broker": "4798f2b0.5d747c",
        "x": 150,
        "y": 560,
        "wires": [
            [
                "489cf0ec.b2982"
            ]
        ]
    },
    {
        "id": "a95f8a61.33e438",
        "type": "mqtt in",
        "z": "36f02452.2e99bc",
        "name": "",
        "topic": "dashboard/sensors/99/1/1/0/17",
        "qos": "2",
        "broker": "4798f2b0.5d747c",
        "x": 850,
        "y": 660,
        "wires": [
            [
                "d4c611b2.4c162"
            ]
        ]
    },
    {
        "id": "92832c3a.b6a5f",
        "type": "mqtt in",
        "z": "36f02452.2e99bc",
        "name": "",
        "topic": "dashboard/sensors/99/2/1/0/18",
        "qos": "2",
        "broker": "4798f2b0.5d747c",
        "x": 850,
        "y": 620,
        "wires": [
            [
                "c8597b8b.0581b8"
            ]
        ]
    },
    {
        "id": "753ad95b.7df9c8",
        "type": "ui_gauge",
        "z": "36f02452.2e99bc",
        "name": "Elforbrug dagligt",
        "group": "d9490c52.897ce",
        "order": 4,
        "width": "3",
        "height": "3",
        "gtype": "gage",
        "title": "Elforbrug",
        "label": "kWh",
        "format": "{{value| number:1}}",
        "min": "0",
        "max": "30",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "20",
        "x": 1240,
        "y": 620,
        "wires": []
    },
    {
        "id": "c1263114.4ef3f",
        "type": "H activity",
        "z": "d2be3a2a.67d4b8",
        "name": "TV",
        "server": "56b003cf.93c9bc",
        "activity": "20800510",
        "label": "TV",
        "x": 470,
        "y": 200,
        "wires": [
            []
        ]
    },
    {
        "id": "541a6418.f052ec",
        "type": "H activity",
        "z": "d2be3a2a.67d4b8",
        "name": "DVD",
        "server": "56b003cf.93c9bc",
        "activity": "20800253",
        "label": "DVD",
        "x": 470,
        "y": 240,
        "wires": [
            []
        ]
    },
    {
        "id": "d1b30c8f.d3354",
        "type": "subflow:8bc8753a.1ea768",
        "z": "36f02452.2e99bc",
        "name": "stuen",
        "x": 350,
        "y": 660,
        "wires": [
            [
                "d62cabb4.b9d228"
            ],
            [
                "4865b18a.983f4"
            ],
            [],
            [
                "353e8c59.b58854"
            ]
        ]
    },
    {
        "id": "8712ec41.562cf",
        "type": "mqtt in",
        "z": "36f02452.2e99bc",
        "name": "",
        "topic": "dashboard/sensors/10/+/+/+/+",
        "qos": "2",
        "broker": "4798f2b0.5d747c",
        "x": 140,
        "y": 660,
        "wires": [
            [
                "d1b30c8f.d3354"
            ]
        ]
    },
    {
        "id": "c8597b8b.0581b8",
        "type": "function",
        "z": "36f02452.2e99bc",
        "name": "",
        "func": "msg.payload = Number(msg.payload)/1000;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1070,
        "y": 620,
        "wires": [
            [
                "753ad95b.7df9c8"
            ]
        ]
    },
    {
        "id": "fc2bd7be.c40148",
        "type": "switch",
        "z": "d2be3a2a.67d4b8",
        "name": "",
        "property": "avctrl",
        "propertyType": "global",
        "rules": [
            {
                "t": "eq",
                "v": "dvd",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "cd",
                "vt": "str"
            },
            {
                "t": "cont",
                "v": "audio",
                "vt": "str"
            },
            {
                "t": "cont",
                "v": "video",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 5,
        "x": 470,
        "y": 540,
        "wires": [
            [
                "25273a45.75e776"
            ],
            [
                "25273a45.75e776"
            ],
            [
                "e0cb35b0.2bf4a8"
            ],
            [
                "fef6e906.107c58"
            ],
            [
                "e0cb35b0.2bf4a8",
                "fef6e906.107c58"
            ]
        ]
    },
    {
        "id": "e0cb35b0.2bf4a8",
        "type": "change",
        "z": "d2be3a2a.67d4b8",
        "name": "audio",
        "rules": [
            {
                "t": "change",
                "p": "topic",
                "pt": "msg",
                "from": "avctrl/in",
                "fromt": "str",
                "to": "chromecast/audio",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 650,
        "y": 560,
        "wires": [
            [
                "15cbe8a1.e953e7",
                "2aadd645.74b1ba"
            ]
        ]
    },
    {
        "id": "fef6e906.107c58",
        "type": "change",
        "z": "d2be3a2a.67d4b8",
        "name": "video",
        "rules": [
            {
                "t": "change",
                "p": "topic",
                "pt": "msg",
                "from": "avctrl/in",
                "fromt": "str",
                "to": "chromecast/cast",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 650,
        "y": 600,
        "wires": [
            [
                "15cbe8a1.e953e7",
                "2aadd645.74b1ba"
            ]
        ]
    },
    {
        "id": "15cbe8a1.e953e7",
        "type": "mqtt out",
        "z": "d2be3a2a.67d4b8",
        "name": "",
        "topic": "",
        "qos": "2",
        "retain": "false",
        "broker": "4798f2b0.5d747c",
        "x": 810,
        "y": 640,
        "wires": []
    },
    {
        "id": "25273a45.75e776",
        "type": "switch",
        "z": "d2be3a2a.67d4b8",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "pause",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "play",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "fwd",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "rev",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "stop",
                "vt": "str"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 5,
        "x": 650,
        "y": 500,
        "wires": [
            [
                "c29005a6.029498"
            ],
            [
                "aa76e025.eb137"
            ],
            [
                "b3ccceab.07286"
            ],
            [
                "a0ecd37f.01d88"
            ],
            [
                "a73cb364.f49ab"
            ]
        ]
    },
    {
        "id": "c29005a6.029498",
        "type": "H command",
        "z": "d2be3a2a.67d4b8",
        "name": "Pause",
        "server": "56b003cf.93c9bc",
        "activity": null,
        "label": "",
        "command": "%7B%22command%22::%22Pause%22,%22type%22::%22IRCommand%22,%22deviceId%22::%2237008443%22%7D",
        "repeat": "1",
        "x": 810,
        "y": 400,
        "wires": [
            []
        ]
    },
    {
        "id": "aa76e025.eb137",
        "type": "H command",
        "z": "d2be3a2a.67d4b8",
        "name": "Play",
        "server": "56b003cf.93c9bc",
        "activity": "20800253",
        "harmony_type": "act",
        "label": "DVD",
        "command": "%7B%22command%22::%22Play%22,%22type%22::%22IRCommand%22,%22deviceId%22::%2237008443%22%7D",
        "repeat": "1",
        "x": 810,
        "y": 440,
        "wires": [
            []
        ]
    },
    {
        "id": "a73cb364.f49ab",
        "type": "H command",
        "z": "d2be3a2a.67d4b8",
        "name": "Stop",
        "server": "56b003cf.93c9bc",
        "activity": "20800253",
        "harmony_type": "act",
        "label": "DVD",
        "command": "%7B%22command%22::%22Stop%22,%22type%22::%22IRCommand%22,%22deviceId%22::%2237008443%22%7D",
        "repeat": "1",
        "x": 810,
        "y": 560,
        "wires": [
            []
        ]
    },
    {
        "id": "7067eb38.1ac8a4",
        "type": "switch",
        "z": "d9d4d547.6a9438",
        "name": "",
        "property": "payload.activityName",
        "propertyType": "msg",
        "rules": [
            {
                "t": "cont",
                "v": "Video",
                "vt": "str"
            },
            {
                "t": "cont",
                "v": "Audio",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 3,
        "x": 470,
        "y": 500,
        "wires": [
            [
                "61349c46.da30c4"
            ],
            [
                "3f59c476.b9f49c"
            ],
            [
                "3f59c476.b9f49c",
                "61349c46.da30c4"
            ]
        ]
    },
    {
        "id": "3f59c476.b9f49c",
        "type": "change",
        "z": "d9d4d547.6a9438",
        "name": "quit video",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "quit",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "chromecast/tv_stuen/control",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 640,
        "y": 480,
        "wires": [
            [
                "6c0576fd.05c4e8",
                "bbf5ae2e.10df2"
            ]
        ]
    },
    {
        "id": "6c0576fd.05c4e8",
        "type": "mqtt out",
        "z": "d9d4d547.6a9438",
        "name": "",
        "topic": "",
        "qos": "2",
        "retain": "false",
        "broker": "4798f2b0.5d747c",
        "x": 790,
        "y": 500,
        "wires": []
    },
    {
        "id": "61349c46.da30c4",
        "type": "change",
        "z": "d9d4d547.6a9438",
        "name": "quit audio",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "quit",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "chromecast/audio_stuen/control",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 640,
        "y": 520,
        "wires": [
            [
                "6c0576fd.05c4e8",
                "c292fcc.658c8"
            ]
        ]
    },
    {
        "id": "9b166d59.19dab",
        "type": "debug",
        "z": "d2be3a2a.67d4b8",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 290,
        "y": 420,
        "wires": []
    },
    {
        "id": "56a80b55.263e74",
        "type": "comment",
        "z": "67deb464.98214c",
        "name": "Logging and data collection from nodes",
        "info": "",
        "x": 210,
        "y": 620,
        "wires": []
    },
    {
        "id": "c1d9ad73.24529",
        "type": "function",
        "z": "67deb464.98214c",
        "name": "Influx conditioner",
        "func": "msg_env = null;\nmsg_utility = null;\nst = msg.subType;\nif (msg.messageType == 1 && (st === 0 || st == 1 || st == 2 || st == 4 || st == 17)) {\n    var tags = {};var data = {}\n    tags.node = msg.nodeId.toString();\n    tags.sensor = msg.childSensorId.toString();\n    data.value=parseFloat(msg.payload);\n    if (!isNaN(data.value)) {\n        switch (st) {\n            case 0 : type = \"temperature\";break;\n            case 1 : type = \"humidity\"; break;\n            case 2 : type = \"status\"; break;\n            case 4 : type = \"barometer\"; break;\n            case 17: type = \"electricity\"; break;\n        }\n        msg.payload = [data, tags];\n        msg.measurement = type;\n        if (msg.subType==17) {\n            msg_utility = msg;\n        }\n        else {\n            msg_env = msg;\n        }\n    }\n} \n\nreturn [msg_env, msg_utility, msg];",
        "outputs": "3",
        "noerr": 0,
        "x": 630,
        "y": 620,
        "wires": [
            [
                "10971beb.1b4a04"
            ],
            [
                "e0547916.327208"
            ],
            [
                "aec232d3.2860b"
            ]
        ]
    },
    {
        "id": "10971beb.1b4a04",
        "type": "influxdb out",
        "z": "67deb464.98214c",
        "influxdb": "9dbdc7c7.624238",
        "name": "",
        "measurement": "",
        "precision": "",
        "retentionPolicy": "",
        "x": 860,
        "y": 580,
        "wires": []
    },
    {
        "id": "e0547916.327208",
        "type": "influxdb out",
        "z": "67deb464.98214c",
        "influxdb": "9de2e4ed.fdcfc8",
        "name": "",
        "measurement": "",
        "precision": "",
        "retentionPolicy": "",
        "x": 840,
        "y": 620,
        "wires": []
    },
    {
        "id": "152aa65b.9bbe4a",
        "type": "file",
        "z": "67deb464.98214c",
        "name": "Battery log",
        "filename": "/var/tmp/battlog.txt",
        "appendNewline": false,
        "createDir": false,
        "overwriteFile": "false",
        "x": 1270,
        "y": 720,
        "wires": [
            []
        ]
    },
    {
        "id": "ea6fe8fe.44f818",
        "type": "function",
        "z": "67deb464.98214c",
        "name": "inject date",
        "func": "var date = new Date();\nvar str = date.getFullYear() + \"-\" + (date.getMonth() + 1) + \"-\" + date.getDate() + \" \" +  date.getHours() + \":\" + date.getMinutes() + \":\" + date.getSeconds();\nmsg.payload = str + \" - \" + msg.payload + '\\r\\n';\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1050,
        "y": 720,
        "wires": [
            [
                "152aa65b.9bbe4a"
            ]
        ]
    },
    {
        "id": "18a81e89.0c0de1",
        "type": "function",
        "z": "67deb464.98214c",
        "name": "Check batt level",
        "func": "var date = new Date();\nvar str = date.getFullYear() + \"-\" + (date.getMonth() + 1) + \"-\" + date.getDate() + \" \" +  date.getHours() + \":\" + date.getMinutes() + \":\" + date.getSeconds();\nmsg.date = str;\nif (parseInt(msg.payload)<5)\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 860,
        "y": 760,
        "wires": [
            [
                "4dac1238.58ab8c"
            ]
        ]
    },
    {
        "id": "4dac1238.58ab8c",
        "type": "template",
        "z": "67deb464.98214c",
        "name": "BatLow message",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "{{date}} - Battery level is low on node {{nodeId}} : {{payload}} !",
        "x": 1070,
        "y": 760,
        "wires": [
            []
        ]
    },
    {
        "id": "9006f34d.21edb",
        "type": "file",
        "z": "67deb464.98214c",
        "name": "Presentation log",
        "filename": "/var/tmp/presentation.txt",
        "appendNewline": true,
        "createDir": false,
        "overwriteFile": "false",
        "x": 1060,
        "y": 800,
        "wires": [
            []
        ]
    },
    {
        "id": "37bd13ba.bf02cc",
        "type": "mysencode",
        "z": "67deb464.98214c",
        "name": "",
        "mqtt": false,
        "x": 870,
        "y": 720,
        "wires": [
            [
                "ea6fe8fe.44f818"
            ]
        ]
    },
    {
        "id": "9377f219.616f2",
        "type": "mysencode",
        "z": "67deb464.98214c",
        "name": "",
        "mqtt": false,
        "x": 870,
        "y": 800,
        "wires": [
            [
                "9006f34d.21edb"
            ]
        ]
    },
    {
        "id": "abd263fa.807d3",
        "type": "function",
        "z": "67deb464.98214c",
        "name": "Filter battery msg",
        "func": "var battMsg = null;\nvar debugMsg = null;\nvar sketchMsg = null;\nif (msg.messageType==3) {\n    if (msg.subType===0)\n        battMsg = msg;\n    if (msg.subType==9)\n        debugMsg = msg;\n    if (msg.subType==11 || msg.subType==12)\n        sketchMsg = msg;\n}\n\nreturn [battMsg, sketchMsg, debugMsg];",
        "outputs": "3",
        "noerr": 0,
        "x": 630,
        "y": 780,
        "wires": [
            [
                "18a81e89.0c0de1",
                "37bd13ba.bf02cc"
            ],
            [
                "9377f219.616f2"
            ],
            [
                "9ebb1391.6144f"
            ]
        ]
    },
    {
        "id": "9b680d80.3b1fd",
        "type": "mqtt in",
        "z": "d2be3a2a.67d4b8",
        "name": "",
        "topic": "chromecast/play",
        "qos": "2",
        "broker": "4798f2b0.5d747c",
        "x": 120,
        "y": 760,
        "wires": [
            [
                "644f494a.1667f8"
            ]
        ]
    },
    {
        "id": "644f494a.1667f8",
        "type": "json",
        "z": "d2be3a2a.67d4b8",
        "name": "",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 290,
        "y": 760,
        "wires": [
            [
                "48f7a502.c8568c"
            ]
        ]
    },
    {
        "id": "48f7a502.c8568c",
        "type": "function",
        "z": "d2be3a2a.67d4b8",
        "name": "",
        "func": "let p = msg.payload;\nlet chrome = 'audio_stuen';\nif (p.media === 'video/mp4') {\n    chrome = 'tv_stuen';\n}\n\nmsg.topic = 'chromecast/' + chrome + '/control/play';\nmsg.payload = p.id;\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "x": 470,
        "y": 760,
        "wires": [
            [
                "432bcac7.661c94",
                "a677b25e.7eeba"
            ]
        ]
    },
    {
        "id": "432bcac7.661c94",
        "type": "debug",
        "z": "d2be3a2a.67d4b8",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 610,
        "y": 740,
        "wires": []
    },
    {
        "id": "a677b25e.7eeba",
        "type": "mqtt out",
        "z": "d2be3a2a.67d4b8",
        "name": "",
        "topic": "",
        "qos": "2",
        "retain": "false",
        "broker": "4798f2b0.5d747c",
        "x": 610,
        "y": 780,
        "wires": []
    },
    {
        "id": "ace34323.962d5",
        "type": "comment",
        "z": "d2be3a2a.67d4b8",
        "name": "Cast a predefined stream to active chromecast",
        "info": "Detects which chromecast is active, and send play command to the right device",
        "x": 210,
        "y": 720,
        "wires": []
    },
    {
        "id": "ff1c1d34.07702",
        "type": "comment",
        "z": "d2be3a2a.67d4b8",
        "name": "MQTT -> control media endpoint",
        "info": "",
        "x": 170,
        "y": 380,
        "wires": []
    },
    {
        "id": "b3ccceab.07286",
        "type": "H command",
        "z": "d2be3a2a.67d4b8",
        "name": "Skip fwd",
        "server": "56b003cf.93c9bc",
        "activity": "20800253",
        "harmony_type": "act",
        "label": "DVD",
        "command": "%7B%22command%22::%22ChapterNext%22,%22type%22::%22IRCommand%22,%22deviceId%22::%2237008443%22%7D",
        "repeat": "1",
        "x": 820,
        "y": 480,
        "wires": [
            []
        ]
    },
    {
        "id": "a0ecd37f.01d88",
        "type": "H command",
        "z": "d2be3a2a.67d4b8",
        "name": "Skip back",
        "server": "56b003cf.93c9bc",
        "activity": "20800253",
        "label": "DVD",
        "command": "%7B%22command%22::%22ChapterPrev%22,%22type%22::%22IRCommand%22,%22deviceId%22::%2237008443%22%7D",
        "repeat": "1",
        "x": 820,
        "y": 520,
        "wires": [
            []
        ]
    },
    {
        "id": "d2cb106b.f2fd",
        "type": "json",
        "z": "d9d4d547.6a9438",
        "name": "",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 330,
        "y": 500,
        "wires": [
            [
                "7067eb38.1ac8a4",
                "7c9713c8.141b3c"
            ]
        ]
    },
    {
        "id": "93db9480.3ed028",
        "type": "debug",
        "z": "9292e51b.eaf788",
        "name": "Energy",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 1320,
        "y": 140,
        "wires": []
    },
    {
        "id": "365e7716.b78748",
        "type": "mysencap",
        "z": "9292e51b.eaf788",
        "name": "",
        "nodeid": "99",
        "childid": "1",
        "subtype": "17",
        "internal": "0",
        "ack": false,
        "msgtype": "1",
        "presentation": false,
        "presentationtype": "13",
        "presentationtext": "Watt",
        "fullpresentation": false,
        "firmwarename": "",
        "firmwareversion": "",
        "x": 880,
        "y": 140,
        "wires": [
            [
                "53c8aa80.0c7564",
                "1ebdd70b.08e2b9"
            ]
        ]
    },
    {
        "id": "88801b19.982088",
        "type": "mysencap",
        "z": "9292e51b.eaf788",
        "name": "",
        "nodeid": "99",
        "childid": "1",
        "subtype": "18",
        "internal": "0",
        "ack": false,
        "msgtype": "1",
        "presentation": true,
        "presentationtype": "14",
        "presentationtext": "Kwh",
        "fullpresentation": true,
        "firmwarename": "MeterNode",
        "firmwareversion": "0.1",
        "x": 880,
        "y": 180,
        "wires": [
            [
                "53c8aa80.0c7564"
            ]
        ]
    },
    {
        "id": "15fc2499.4a078b",
        "type": "function",
        "z": "9292e51b.eaf788",
        "name": "Split meter data",
        "func": "var m=msg.payload.split(';');\n// Filtering away unrealistic high usage above 50KW\nif (Number(m[0]) < 50000) {\n    var msg1 = {payload:m[0]};\n    var msg2 = {payload:m[1]/1000};\n    var msg3 = {payload:m[1]};\n    return [msg1, msg2, msg3];\n}\n",
        "outputs": 3,
        "noerr": 0,
        "x": 320,
        "y": 660,
        "wires": [
            [],
            [],
            [
                "367d442c.25478c"
            ]
        ]
    },
    {
        "id": "21c196cd.d0a07a",
        "type": "mysencap",
        "z": "9292e51b.eaf788",
        "name": "",
        "nodeid": "99",
        "childid": "2",
        "subtype": "17",
        "internal": 0,
        "ack": false,
        "msgtype": "1",
        "presentation": false,
        "presentationtype": 0,
        "presentationtext": "",
        "fullpresentation": false,
        "firmwarename": "",
        "firmwareversion": "",
        "x": 880,
        "y": 220,
        "wires": [
            [
                "53c8aa80.0c7564"
            ]
        ]
    },
    {
        "id": "367d442c.25478c",
        "type": "function",
        "z": "9292e51b.eaf788",
        "name": "Watt/Hour calculator",
        "func": "/* Takes input on subType 24, calculates difference\n   from last time, if around 60 seconds have passed\n   since last report.\n   It passes the value on as subType 17, and\n   childSensorId 2 */\n   \nvar uTime = Math.floor(Date.now()/60000);\nvar lastTime = context.get('lastTime')||0;\nif (lastTime === 0) {\n    context.set('lastTime', uTime);\n    context.set('lastCount', Number(msg.payload));\n} else {\n    if (uTime != lastTime) {\n        lastCount = context.get('lastCount');\n        currentCount = Number(msg.payload);\n        context.set('lastTime', uTime);\n        context.set('lastCount', currentCount)\n        msg.payload = currentCount - lastCount;\n        return msg;\n    }\n}\nreturn null",
        "outputs": 1,
        "noerr": 0,
        "x": 560,
        "y": 660,
        "wires": [
            []
        ]
    },
    {
        "id": "877c9a2a.f2b718",
        "type": "function",
        "z": "9292e51b.eaf788",
        "name": "create query",
        "func": "var d = new Date();\nd.setHours(0,0,0,0);\nmsg.time = (1 * d.getTime())/1000;\nmsg.time = d.toISOString(); //ISODateString(d);\nmsg.query = \"select sum(value) from electricity where node='99' and sensor='2' and time>'\"+msg.time+\"'\"; //+msg.time;\nmsg.payload = '';\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "x": 290,
        "y": 260,
        "wires": [
            [
                "7b27ab5a.85b6e4"
            ]
        ]
    },
    {
        "id": "7b27ab5a.85b6e4",
        "type": "influxdb in",
        "z": "9292e51b.eaf788",
        "influxdb": "9d8c74dc.570ca8",
        "name": "influx lookup",
        "query": "",
        "rawOutput": false,
        "precision": "",
        "retentionPolicy": "",
        "x": 470,
        "y": 260,
        "wires": [
            [
                "fb4c20b9.91577"
            ]
        ]
    },
    {
        "id": "dcf57024.11b3",
        "type": "mysencap",
        "z": "9292e51b.eaf788",
        "name": "",
        "nodeid": "99",
        "childid": "2",
        "subtype": "18",
        "internal": 0,
        "ack": false,
        "msgtype": "1",
        "presentation": false,
        "presentationtype": 0,
        "presentationtext": "",
        "fullpresentation": false,
        "firmwarename": "",
        "firmwareversion": "",
        "x": 880,
        "y": 260,
        "wires": [
            [
                "53c8aa80.0c7564"
            ]
        ]
    },
    {
        "id": "74c533e0.3cb1cc",
        "type": "inject",
        "z": "9292e51b.eaf788",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "60",
        "crontab": "",
        "once": true,
        "onceDelay": "5",
        "x": 130,
        "y": 260,
        "wires": [
            [
                "877c9a2a.f2b718"
            ]
        ]
    },
    {
        "id": "fb4c20b9.91577",
        "type": "change",
        "z": "9292e51b.eaf788",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload[0].sum",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 640,
        "y": 260,
        "wires": [
            [
                "dcf57024.11b3"
            ]
        ]
    },
    {
        "id": "53c8aa80.0c7564",
        "type": "mysencode",
        "z": "9292e51b.eaf788",
        "name": "",
        "mqtt": true,
        "mqtttopic": "mys-in",
        "x": 1190,
        "y": 200,
        "wires": [
            [
                "93db9480.3ed028",
                "db003884.353ea8"
            ]
        ]
    },
    {
        "id": "e143de62.fdaf9",
        "type": "mqtt out",
        "z": "9292e51b.eaf788",
        "name": "",
        "topic": "",
        "qos": "2",
        "retain": "false",
        "broker": "4798f2b0.5d747c",
        "x": 1290,
        "y": 360,
        "wires": []
    },
    {
        "id": "651925b2.e10b5c",
        "type": "comment",
        "z": "9292e51b.eaf788",
        "name": "Utility meter input conversion.",
        "info": "Input from arduino measuring pulses on my utility meter.\n\nFor code / examples, see [this github repository](https://github.com/tbowmo/energyPulseCounter)\n\nBasically converts the input format from the serial port, into a fake mysensors sensor,\nin order to use it in other parts of the nodered flow, as a standard mysensors sensor.\n\nthe incoming serial format is like:\n\nWWW;PPP;EEE\\r\\n\n\nWWW -> Watts\nPPP -> Pulse counts (1 pulse per Wh)\nEEE -> ElapsedkWh calculated by arduino (not used here though);\n\nSplit out into distinct parts, and fed onto the rest of the system as mysensors data on the MQTT bus",
        "x": 520,
        "y": 80,
        "wires": []
    },
    {
        "id": "40b30e19.03a88",
        "type": "comment",
        "z": "d9d4d547.6a9438",
        "name": "Stop chromecasts",
        "info": "Sends quit command to chromecasts, when we switch away from the streaming scenes,\nthis should stop chromecasts from streaming any content.\n",
        "x": 130,
        "y": 460,
        "wires": []
    },
    {
        "id": "188c430.a9272bd",
        "type": "comment",
        "z": "d9d4d547.6a9438",
        "name": "Stores sensor data in a local flow variable",
        "info": "This is for other automation rules on the page, so they can be used in other parts fo the flow",
        "x": 200,
        "y": 620,
        "wires": []
    },
    {
        "id": "7c9713c8.141b3c",
        "type": "change",
        "z": "d9d4d547.6a9438",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "avctrl",
                "pt": "global",
                "to": "$lowercase(payload.activityName)",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 500,
        "y": 560,
        "wires": [
            []
        ]
    },
    {
        "id": "6bab362a.1710c8",
        "type": "change",
        "z": "d9d4d547.6a9438",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "dayLight",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 370,
        "y": 720,
        "wires": [
            []
        ]
    },
    {
        "id": "bbf5ae2e.10df2",
        "type": "debug",
        "z": "d9d4d547.6a9438",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 890,
        "y": 460,
        "wires": []
    },
    {
        "id": "c292fcc.658c8",
        "type": "debug",
        "z": "d9d4d547.6a9438",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 890,
        "y": 540,
        "wires": []
    },
    {
        "id": "5f5085ce.59c7bc",
        "type": "mqtt in",
        "z": "d9d4d547.6a9438",
        "name": "",
        "topic": "chromecast/+/state",
        "qos": "2",
        "datatype": "auto",
        "broker": "4798f2b0.5d747c",
        "x": 130,
        "y": 800,
        "wires": [
            [
                "771293de.2a807c"
            ]
        ]
    },
    {
        "id": "771293de.2a807c",
        "type": "change",
        "z": "d9d4d547.6a9438",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "chromestate",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 380,
        "y": 800,
        "wires": [
            [
                "ee655af3.b9e1b8"
            ]
        ]
    },
    {
        "id": "bfa30dc8.1e214",
        "type": "mqtt out",
        "z": "d2be3a2a.67d4b8",
        "name": "",
        "topic": "avctrl/in/control",
        "qos": "2",
        "retain": "false",
        "broker": "4798f2b0.5d747c",
        "x": 1120,
        "y": 260,
        "wires": []
    },
    {
        "id": "d40036e7.baedd8",
        "type": "mqtt in",
        "z": "d2be3a2a.67d4b8",
        "name": "",
        "topic": "roku/keypress",
        "qos": "2",
        "broker": "4798f2b0.5d747c",
        "x": 770,
        "y": 260,
        "wires": [
            [
                "e7726249.7e6c",
                "fd9f2383.3a4e5"
            ]
        ]
    },
    {
        "id": "e7726249.7e6c",
        "type": "function",
        "z": "d2be3a2a.67d4b8",
        "name": "translate roku",
        "func": "state = global.get('chromestate');\nmsg.payload = msg.payload.toLowerCase();\nif (state == 'PLAYING' && msg.payload == 'play') {\n    msg.payload = 'pause';\n} \nif (msg.payload == 'back') {\n    msg.payload = 'stop';\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 940,
        "y": 260,
        "wires": [
            [
                "bfa30dc8.1e214",
                "fcfb9705.c45cf8"
            ]
        ]
    },
    {
        "id": "fcfb9705.c45cf8",
        "type": "debug",
        "z": "d2be3a2a.67d4b8",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 1090,
        "y": 220,
        "wires": []
    },
    {
        "id": "ee655af3.b9e1b8",
        "type": "debug",
        "z": "d9d4d547.6a9438",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 640,
        "y": 800,
        "wires": []
    },
    {
        "id": "2aadd645.74b1ba",
        "type": "debug",
        "z": "d2be3a2a.67d4b8",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 810,
        "y": 600,
        "wires": []
    },
    {
        "id": "db003884.353ea8",
        "type": "function",
        "z": "9292e51b.eaf788",
        "name": "",
        "func": "msg.retain = false;\n// All normal SET commands are retained\n// And all battery level values as well\n// This mimicks MY_MQTT_CLIENT_PUBLISH_RETAIN option in a MQTT gateway\nif ((msg.messageType === 1) || \n    (msg.messageType === 3 && msg.subType === 0)) {\n    msg.retain = true;\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1170,
        "y": 360,
        "wires": [
            [
                "e143de62.fdaf9"
            ]
        ]
    },
    {
        "id": "1a27e97c.c38e17",
        "type": "mqtt out",
        "z": "67deb464.98214c",
        "name": "",
        "topic": "",
        "qos": "0",
        "retain": "true",
        "broker": "4798f2b0.5d747c",
        "x": 810,
        "y": 380,
        "wires": []
    },
    {
        "id": "26b5be01.132fb2",
        "type": "change",
        "z": "67deb464.98214c",
        "name": "dashboard",
        "rules": [
            {
                "t": "change",
                "p": "topic",
                "pt": "msg",
                "from": "mys-in",
                "fromt": "str",
                "to": "dashboard/sensors",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 370,
        "y": 380,
        "wires": [
            [
                "1a27e97c.c38e17",
                "45051934.52aba8"
            ]
        ]
    },
    {
        "id": "4ce8d483.71075c",
        "type": "comment",
        "z": "67deb464.98214c",
        "name": "Rebroadcast for dashboard and enrich with timestamp",
        "info": "Below is rebroadcasting sensor data (set commands) to the dashboard, with retention bit set to true",
        "x": 260,
        "y": 320,
        "wires": []
    },
    {
        "id": "9b9f22ed.a2e88",
        "type": "mqtt in",
        "z": "67deb464.98214c",
        "name": "",
        "topic": "mys-in/+/+/1/#",
        "qos": "2",
        "broker": "4798f2b0.5d747c",
        "x": 130,
        "y": 380,
        "wires": [
            [
                "26b5be01.132fb2"
            ]
        ]
    },
    {
        "id": "45051934.52aba8",
        "type": "change",
        "z": "67deb464.98214c",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "",
                "tot": "date"
            },
            {
                "t": "change",
                "p": "topic",
                "pt": "msg",
                "from": "sensors",
                "fromt": "str",
                "to": "timestamp",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 620,
        "y": 360,
        "wires": [
            [
                "1a27e97c.c38e17"
            ]
        ]
    },
    {
        "id": "b01dec45.251e2",
        "type": "ui_button",
        "z": "c6ae2dfb.adbb9",
        "name": "video",
        "group": "940310ee.5c533",
        "order": 1,
        "width": "1",
        "height": "1",
        "passthru": false,
        "label": "",
        "color": "",
        "bgcolor": "",
        "icon": "fa-youtube",
        "payload": "video",
        "payloadType": "str",
        "topic": "avctrl/in/scene",
        "x": 570,
        "y": 80,
        "wires": [
            [
                "5b1b4e24.df44f"
            ]
        ]
    },
    {
        "id": "23292fa9.040ab",
        "type": "ui_button",
        "z": "c6ae2dfb.adbb9",
        "name": "audio",
        "group": "940310ee.5c533",
        "order": 2,
        "width": "1",
        "height": "1",
        "passthru": false,
        "label": "",
        "color": "",
        "bgcolor": "",
        "icon": "fa-headphones",
        "payload": "audio",
        "payloadType": "str",
        "topic": "avctrl/in/scene",
        "x": 570,
        "y": 120,
        "wires": [
            [
                "5b1b4e24.df44f"
            ]
        ]
    },
    {
        "id": "4af68bad.ce2b94",
        "type": "ui_button",
        "z": "c6ae2dfb.adbb9",
        "name": "off",
        "group": "940310ee.5c533",
        "order": 6,
        "width": "1",
        "height": "1",
        "passthru": false,
        "label": "",
        "color": "",
        "bgcolor": "",
        "icon": "fa-power-off",
        "payload": "off",
        "payloadType": "str",
        "topic": "avctrl/in/scene",
        "x": 570,
        "y": 160,
        "wires": [
            [
                "5b1b4e24.df44f"
            ]
        ]
    },
    {
        "id": "26dc5202.4d769e",
        "type": "ui_button",
        "z": "c6ae2dfb.adbb9",
        "name": "wii",
        "group": "940310ee.5c533",
        "order": 3,
        "width": "1",
        "height": "1",
        "passthru": false,
        "label": "",
        "color": "",
        "bgcolor": "",
        "icon": "fa-gamepad",
        "payload": "wii",
        "payloadType": "str",
        "topic": "avctrl/in/scene",
        "x": 570,
        "y": 200,
        "wires": [
            [
                "5b1b4e24.df44f"
            ]
        ]
    },
    {
        "id": "e0177610.91e588",
        "type": "ui_button",
        "z": "c6ae2dfb.adbb9",
        "name": "dvd",
        "group": "940310ee.5c533",
        "order": 4,
        "width": "1",
        "height": "1",
        "passthru": false,
        "label": "",
        "color": "",
        "bgcolor": "",
        "icon": "fa-film",
        "payload": "dvd",
        "payloadType": "str",
        "topic": "avctrl/in/scene",
        "x": 570,
        "y": 240,
        "wires": [
            [
                "5b1b4e24.df44f"
            ]
        ]
    },
    {
        "id": "f4600e81.5e424",
        "type": "ui_button",
        "z": "c6ae2dfb.adbb9",
        "name": "tv",
        "group": "940310ee.5c533",
        "order": 5,
        "width": "1",
        "height": "1",
        "passthru": false,
        "label": "",
        "color": "",
        "bgcolor": "",
        "icon": "fa-tv",
        "payload": "tv",
        "payloadType": "str",
        "topic": "avctrl/in/scene",
        "x": 570,
        "y": 40,
        "wires": [
            [
                "5b1b4e24.df44f"
            ]
        ]
    },
    {
        "id": "2b694d0f.e34bb2",
        "type": "ui_button",
        "z": "c6ae2dfb.adbb9",
        "name": "play",
        "group": "940310ee.5c533",
        "order": 11,
        "width": "1",
        "height": "1",
        "passthru": false,
        "label": "",
        "color": "",
        "bgcolor": "",
        "icon": "fa-play",
        "payload": "play",
        "payloadType": "str",
        "topic": "avctrl/in/control",
        "x": 570,
        "y": 280,
        "wires": [
            [
                "5b1b4e24.df44f"
            ]
        ]
    },
    {
        "id": "e5bc3241.362ca",
        "type": "ui_button",
        "z": "c6ae2dfb.adbb9",
        "name": "next",
        "group": "940310ee.5c533",
        "order": 13,
        "width": "1",
        "height": "1",
        "passthru": false,
        "label": "",
        "color": "",
        "bgcolor": "",
        "icon": "fa-step-forward",
        "payload": "fwd",
        "payloadType": "str",
        "topic": "avctrl/in/control",
        "x": 570,
        "y": 360,
        "wires": [
            [
                "5b1b4e24.df44f"
            ]
        ]
    },
    {
        "id": "3448a92c.cd28f6",
        "type": "ui_button",
        "z": "c6ae2dfb.adbb9",
        "name": "pause",
        "group": "940310ee.5c533",
        "order": 12,
        "width": "1",
        "height": "1",
        "passthru": false,
        "label": "",
        "color": "",
        "bgcolor": "",
        "icon": "fa-pause",
        "payload": "pause",
        "payloadType": "str",
        "topic": "avctrl/in/control",
        "x": 570,
        "y": 320,
        "wires": [
            [
                "5b1b4e24.df44f"
            ]
        ]
    },
    {
        "id": "2d030f32.87b91",
        "type": "ui_button",
        "z": "c6ae2dfb.adbb9",
        "name": "stop",
        "group": "940310ee.5c533",
        "order": 14,
        "width": "1",
        "height": "1",
        "passthru": false,
        "label": "",
        "color": "",
        "bgcolor": "",
        "icon": "fa-stop",
        "payload": "stop",
        "payloadType": "str",
        "topic": "avctrl/in/control",
        "x": 570,
        "y": 400,
        "wires": [
            [
                "5b1b4e24.df44f"
            ]
        ]
    },
    {
        "id": "5b1b4e24.df44f",
        "type": "mqtt out",
        "z": "c6ae2dfb.adbb9",
        "name": "",
        "topic": "",
        "qos": "2",
        "retain": "false",
        "broker": "4798f2b0.5d747c",
        "x": 810,
        "y": 300,
        "wires": []
    },
    {
        "id": "8080b2dc.bb357",
        "type": "mqtt in",
        "z": "c6ae2dfb.adbb9",
        "name": "",
        "topic": "chromecast/state",
        "qos": "2",
        "broker": "4798f2b0.5d747c",
        "x": 200,
        "y": 300,
        "wires": [
            [
                "f56bea63.b03558"
            ]
        ]
    },
    {
        "id": "f56bea63.b03558",
        "type": "function",
        "z": "c6ae2dfb.adbb9",
        "name": "",
        "func": "if (msg.payload === \"PLAYING\") {\n    msg1 = {\"enabled\": false};\n    msg2 = {\"enabled\": true};\n}\nelse {\n    msg1 = {\"enabled\": true};\n    msg2 = {\"enabled\": false};\n}\nreturn [msg1, msg2];",
        "outputs": 2,
        "noerr": 0,
        "x": 370,
        "y": 300,
        "wires": [
            [
                "2b694d0f.e34bb2",
                "5794e436.a8e46c"
            ],
            [
                "3448a92c.cd28f6",
                "611dc5ec.eacddc"
            ]
        ]
    },
    {
        "id": "5794e436.a8e46c",
        "type": "debug",
        "z": "c6ae2dfb.adbb9",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 370,
        "y": 420,
        "wires": []
    },
    {
        "id": "611dc5ec.eacddc",
        "type": "debug",
        "z": "c6ae2dfb.adbb9",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 370,
        "y": 380,
        "wires": []
    },
    {
        "id": "859b0f0d.32dcc",
        "type": "ui_button",
        "z": "c6ae2dfb.adbb9",
        "name": "rev",
        "group": "940310ee.5c533",
        "order": 10,
        "width": "1",
        "height": "1",
        "passthru": false,
        "label": "",
        "color": "",
        "bgcolor": "",
        "icon": "fa-step-backward",
        "payload": "rev",
        "payloadType": "str",
        "topic": "avctrl/in/control",
        "x": 570,
        "y": 440,
        "wires": [
            [
                "5b1b4e24.df44f"
            ]
        ]
    },
    {
        "id": "495277e3.cbb4c8",
        "type": "ui_text",
        "z": "c6ae2dfb.adbb9",
        "group": "940310ee.5c533",
        "order": 7,
        "width": "3",
        "height": "1",
        "name": "",
        "label": "AV Status",
        "format": "{{msg.payload.activityName}}",
        "layout": "col-center",
        "x": 520,
        "y": 680,
        "wires": []
    },
    {
        "id": "50748519.51f8ac",
        "type": "mqtt in",
        "z": "c6ae2dfb.adbb9",
        "name": "",
        "topic": "avctrl/out/scene",
        "qos": "2",
        "broker": "4798f2b0.5d747c",
        "x": 200,
        "y": 680,
        "wires": [
            [
                "22dd03ce.04215c"
            ]
        ]
    },
    {
        "id": "22dd03ce.04215c",
        "type": "json",
        "z": "c6ae2dfb.adbb9",
        "name": "",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 370,
        "y": 680,
        "wires": [
            [
                "495277e3.cbb4c8"
            ]
        ]
    },
    {
        "id": "dd9635e0.17ecb8",
        "type": "ui_template",
        "z": "c6ae2dfb.adbb9",
        "group": "940310ee.5c533",
        "name": "",
        "order": 8,
        "width": "6",
        "height": "2",
        "format": "<div ng-bind-html=\"msg.payload.title\"></div>\n<div ng-bind-html=\"msg.payload.artist\"></div>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "templateScope": "local",
        "x": 520,
        "y": 760,
        "wires": [
            []
        ]
    },
    {
        "id": "c10a65f4.cfa908",
        "type": "mqtt in",
        "z": "c6ae2dfb.adbb9",
        "name": "",
        "topic": "chromecast/+/media",
        "qos": "2",
        "broker": "4798f2b0.5d747c",
        "x": 210,
        "y": 760,
        "wires": [
            [
                "698266ea.461968"
            ]
        ]
    },
    {
        "id": "698266ea.461968",
        "type": "json",
        "z": "c6ae2dfb.adbb9",
        "name": "",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 370,
        "y": 760,
        "wires": [
            [
                "dd9635e0.17ecb8"
            ]
        ]
    },
    {
        "id": "c700163c.9dcd78",
        "type": "ui_text",
        "z": "c6ae2dfb.adbb9",
        "group": "940310ee.5c533",
        "order": 9,
        "width": "3",
        "height": "1",
        "name": "",
        "label": "Chrome",
        "format": "{{msg.payload}}",
        "layout": "col-center",
        "x": 520,
        "y": 720,
        "wires": []
    },
    {
        "id": "e3468af8.200bc8",
        "type": "mqtt in",
        "z": "c6ae2dfb.adbb9",
        "name": "",
        "topic": "chromecast/+/app",
        "qos": "2",
        "broker": "4798f2b0.5d747c",
        "x": 210,
        "y": 720,
        "wires": [
            [
                "c700163c.9dcd78"
            ]
        ]
    },
    {
        "id": "de738b79.de56d8",
        "type": "comment",
        "z": "c6ae2dfb.adbb9",
        "name": "AV / Chromecast status display",
        "info": "",
        "x": 250,
        "y": 640,
        "wires": []
    },
    {
        "id": "6e0a1a33.ed0424",
        "type": "ui_button",
        "z": "c6ae2dfb.adbb9",
        "name": "mute",
        "group": "940310ee.5c533",
        "order": 15,
        "width": "2",
        "height": "1",
        "passthru": false,
        "label": "",
        "color": "",
        "bgcolor": "",
        "icon": "fa-volume-off",
        "payload": "mute",
        "payloadType": "str",
        "topic": "avctrl/in/control",
        "x": 570,
        "y": 480,
        "wires": [
            [
                "5b1b4e24.df44f"
            ]
        ]
    },
    {
        "id": "82bd9383.cc47a",
        "type": "ui_button",
        "z": "c6ae2dfb.adbb9",
        "name": "volume down",
        "group": "940310ee.5c533",
        "order": 16,
        "width": "2",
        "height": "1",
        "passthru": false,
        "label": "",
        "color": "",
        "bgcolor": "",
        "icon": "fa-volume-down",
        "payload": "volumedown",
        "payloadType": "str",
        "topic": "avctrl/in/control",
        "x": 590,
        "y": 560,
        "wires": [
            [
                "5b1b4e24.df44f"
            ]
        ]
    },
    {
        "id": "d595e647.220808",
        "type": "ui_button",
        "z": "c6ae2dfb.adbb9",
        "name": "volume-up",
        "group": "940310ee.5c533",
        "order": 17,
        "width": "2",
        "height": "1",
        "passthru": false,
        "label": "",
        "color": "",
        "bgcolor": "",
        "icon": "fa-volume-up",
        "payload": "volumeup",
        "payloadType": "str",
        "topic": "avctrl/in/control",
        "x": 590,
        "y": 520,
        "wires": [
            [
                "5b1b4e24.df44f"
            ]
        ]
    },
    {
        "id": "4d526df.5ec6c94",
        "type": "mqtt in",
        "z": "7acba262.c6674c",
        "name": "",
        "topic": "light/+/state/get",
        "qos": "2",
        "datatype": "auto",
        "broker": "4798f2b0.5d747c",
        "x": 120,
        "y": 160,
        "wires": [
            [
                "a7e9553e.aa85a8"
            ]
        ]
    },
    {
        "id": "c1363e20.1d707",
        "type": "switch",
        "z": "7acba262.c6674c",
        "name": "",
        "property": "topic",
        "propertyType": "msg",
        "rules": [
            {
                "t": "cont",
                "v": "/sofa/",
                "vt": "str"
            },
            {
                "t": "cont",
                "v": "/sofabord/",
                "vt": "str"
            },
            {
                "t": "cont",
                "v": "/spisebord/",
                "vt": "str"
            },
            {
                "t": "cont",
                "v": "/tv/",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 4,
        "x": 410,
        "y": 160,
        "wires": [
            [
                "2b93b83a.7882b8"
            ],
            [
                "49c58caf.73c634"
            ],
            [
                "cd0f8d1e.91c2a"
            ],
            [
                "89fed658.955188"
            ]
        ]
    },
    {
        "id": "2b93b83a.7882b8",
        "type": "function",
        "z": "7acba262.c6674c",
        "name": "",
        "func": "// dashboard/sensors/14/1/1/+/2\nstate = Number(global.get('sensor14_1_2') | 0);\nlevel = Number(global.get('sensor14_1_3') | 0);\nstate = (state === 0) ? false : true;\nif (state) {\n    msg.payload = level;\n} else {\n    msg.payload = 0;\n}\nmsg.topic = 'light/sofa/state';\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 570,
        "y": 100,
        "wires": [
            [
                "3168f097.a1da",
                "10424d38.e1f753"
            ]
        ]
    },
    {
        "id": "3168f097.a1da",
        "type": "mqtt out",
        "z": "7acba262.c6674c",
        "name": "",
        "topic": "",
        "qos": "2",
        "retain": "false",
        "broker": "4798f2b0.5d747c",
        "x": 950,
        "y": 100,
        "wires": []
    },
    {
        "id": "10424d38.e1f753",
        "type": "debug",
        "z": "7acba262.c6674c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 730,
        "y": 80,
        "wires": []
    },
    {
        "id": "e1d82bc5.3d0058",
        "type": "mqtt in",
        "z": "7acba262.c6674c",
        "name": "",
        "topic": "mys-in/14/1/1/+/+",
        "qos": "2",
        "broker": "4798f2b0.5d747c",
        "x": 120,
        "y": 100,
        "wires": [
            [
                "2b93b83a.7882b8",
                "809174d.79cca88"
            ]
        ]
    },
    {
        "id": "f92b670d.9328f8",
        "type": "mqtt in",
        "z": "7acba262.c6674c",
        "name": "",
        "topic": "light/+/set",
        "qos": "2",
        "broker": "4798f2b0.5d747c",
        "x": 100,
        "y": 460,
        "wires": [
            [
                "8f7c84a4.b32888",
                "be4a19cf.24c208"
            ]
        ]
    },
    {
        "id": "ffcfc678.fbfbb8",
        "type": "debug",
        "z": "7acba262.c6674c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 950,
        "y": 300,
        "wires": []
    },
    {
        "id": "f75baac1.67c5f8",
        "type": "debug",
        "z": "7acba262.c6674c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 1270,
        "y": 180,
        "wires": []
    },
    {
        "id": "a63f9630.8c9788",
        "type": "function",
        "z": "7acba262.c6674c",
        "name": "",
        "func": "pl = msg.payload;\nif (pl.state.toLowerCase() === 'on') {\n    msg.payload = pl.brightness / 2.55;\n} else {\n    msg.payload = 0;\n}\nvar light = msg.topic.split('/')[2];\nmsg.topic = '';\nswitch (light) {\n    case 'sofabord':\n        msg.topic = \"light/sofabord/state\";\n    break;\n    case 'spisebord1':\n        msg.topic = \"light/spisebord/state\";\n    break;\n    case 'tvmid':\n        msg.topic = \"light/tv/state\";\n    break;\n}\nif (msg.topic !== '') {\n    return msg;\n}\n",
        "outputs": 1,
        "noerr": 0,
        "x": 1110,
        "y": 180,
        "wires": [
            [
                "f75baac1.67c5f8",
                "3168f097.a1da"
            ]
        ]
    },
    {
        "id": "a254b86b.f8d1b8",
        "type": "mqtt out",
        "z": "7acba262.c6674c",
        "name": "",
        "topic": "",
        "qos": "2",
        "retain": "false",
        "broker": "4798f2b0.5d747c",
        "x": 950,
        "y": 340,
        "wires": []
    },
    {
        "id": "a646dc17.498",
        "type": "switch",
        "z": "7acba262.c6674c",
        "name": "",
        "property": "topic",
        "propertyType": "msg",
        "rules": [
            {
                "t": "cont",
                "v": "/sofa/",
                "vt": "str"
            },
            {
                "t": "cont",
                "v": "/sofabord/",
                "vt": "str"
            },
            {
                "t": "cont",
                "v": "/spisebord/",
                "vt": "str"
            },
            {
                "t": "cont",
                "v": "/tv/",
                "vt": "str"
            },
            {
                "t": "cont",
                "v": "/all/",
                "vt": "str"
            },
            {
                "t": "cont",
                "v": "/corner/",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 6,
        "x": 390,
        "y": 460,
        "wires": [
            [
                "34229c1c.b09714"
            ],
            [
                "e1f3e73e.892c08"
            ],
            [
                "dd2a7485.e38e38"
            ],
            [
                "ca8cff21.57af2"
            ],
            [
                "73e897e7.fa4dd8",
                "34229c1c.b09714"
            ],
            [
                "b6d93489.689998"
            ]
        ]
    },
    {
        "id": "8f7c84a4.b32888",
        "type": "debug",
        "z": "7acba262.c6674c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 250,
        "y": 520,
        "wires": []
    },
    {
        "id": "71d6bbea.c9f064",
        "type": "debug",
        "z": "d9d4d547.6a9438",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 350,
        "y": 460,
        "wires": []
    },
    {
        "id": "f05a9b71.bdc548",
        "type": "mqtt in",
        "z": "f3e95c3b.5524b",
        "name": "",
        "topic": "voice/in",
        "qos": "2",
        "broker": "4798f2b0.5d747c",
        "x": 90,
        "y": 220,
        "wires": [
            [
                "1b3e3ce8.dc7b83"
            ]
        ]
    },
    {
        "id": "8d623d2b.ac59a",
        "type": "switch",
        "z": "f3e95c3b.5524b",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "regex",
                "v": "(play|list).*channel",
                "vt": "str",
                "case": true
            },
            {
                "t": "regex",
                "v": "((media|radio|tv|music).*(pause|stop|resume|next|play)|(pause|stop|resume|next|play).*(media|radio|tv|music))",
                "vt": "str",
                "case": true
            },
            {
                "t": "regex",
                "v": "what.*is.*playing",
                "vt": "str",
                "case": true
            },
            {
                "t": "regex",
                "v": ".*bedtime.*",
                "vt": "str",
                "case": true
            },
            {
                "t": "else"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 5,
        "x": 290,
        "y": 340,
        "wires": [
            [
                "13990357.2fa28d"
            ],
            [
                "c6f6e7a6.7ecf88",
                "49a90932.332258"
            ],
            [
                "15b9f9b2.5f9d56"
            ],
            [
                "97c43bb6.8f3678"
            ],
            [
                "ec4f3c5b.b6359"
            ]
        ]
    },
    {
        "id": "9b19a240.8435c",
        "type": "mqtt out",
        "z": "f3e95c3b.5524b",
        "name": "",
        "topic": "voice/out/da",
        "qos": "",
        "retain": "",
        "broker": "4798f2b0.5d747c",
        "x": 1390,
        "y": 220,
        "wires": []
    },
    {
        "id": "c903ba75.e7ccf8",
        "type": "change",
        "z": "f3e95c3b.5524b",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "voice",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 120,
        "y": 340,
        "wires": [
            [
                "8d623d2b.ac59a",
                "32ed81c0.bae54e"
            ]
        ]
    },
    {
        "id": "63552f4.e48ecd",
        "type": "function",
        "z": "f3e95c3b.5524b",
        "name": "",
        "func": "regex = /.*(\\d)/\nm = regex.exec(msg.voice);\nch = msg.payload[Number(m[1])-1];\nmsg.payload = ch;\nvoice = {\"payload\": \"Afspiller \" + ch.friendly}; \nreturn [msg, voice];",
        "outputs": 2,
        "noerr": 0,
        "x": 1150,
        "y": 120,
        "wires": [
            [
                "56fac17e.4bb53",
                "f31500d9.583fa"
            ],
            [
                "64308672.fd6d48"
            ]
        ]
    },
    {
        "id": "f31500d9.583fa",
        "type": "mqtt out",
        "z": "f3e95c3b.5524b",
        "name": "",
        "topic": "chromecast/play",
        "qos": "2",
        "retain": "false",
        "broker": "4798f2b0.5d747c",
        "x": 1400,
        "y": 100,
        "wires": []
    },
    {
        "id": "576a510c.6107f",
        "type": "mqtt out",
        "z": "f3e95c3b.5524b",
        "name": "",
        "topic": "voice/out/da",
        "qos": "2",
        "retain": "false",
        "broker": "4798f2b0.5d747c",
        "x": 690,
        "y": 760,
        "wires": []
    },
    {
        "id": "ec4f3c5b.b6359",
        "type": "template",
        "z": "f3e95c3b.5524b",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "Jeg forstod ikke helt din forespørgsel, prøv igen",
        "output": "str",
        "x": 530,
        "y": 760,
        "wires": [
            [
                "576a510c.6107f"
            ]
        ]
    },
    {
        "id": "e112c05c.b00f4",
        "type": "http request",
        "z": "f3e95c3b.5524b",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "url": "http://jarvis:8181/audio/list",
        "tls": "",
        "x": 690,
        "y": 160,
        "wires": [
            [
                "658f66c2.d7a0d8"
            ]
        ]
    },
    {
        "id": "13990357.2fa28d",
        "type": "switch",
        "z": "f3e95c3b.5524b",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "cont",
                "v": "radio",
                "vt": "str"
            },
            {
                "t": "cont",
                "v": "tv",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 530,
        "y": 180,
        "wires": [
            [
                "e112c05c.b00f4"
            ],
            [
                "ef0ece4a.4ad98"
            ]
        ]
    },
    {
        "id": "ef0ece4a.4ad98",
        "type": "http request",
        "z": "f3e95c3b.5524b",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "url": "http://jarvis:8181/video/list",
        "tls": "",
        "x": 690,
        "y": 200,
        "wires": [
            [
                "658f66c2.d7a0d8"
            ]
        ]
    },
    {
        "id": "658f66c2.d7a0d8",
        "type": "json",
        "z": "f3e95c3b.5524b",
        "name": "",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 860,
        "y": 180,
        "wires": [
            [
                "e8d829b1.2170a8"
            ]
        ]
    },
    {
        "id": "e34cb009.9285d",
        "type": "function",
        "z": "f3e95c3b.5524b",
        "name": "",
        "func": "pl = msg.payload;\ntext = \"\";\nif (msg.voice.includes('radio')) {\n    text = \"Radio kanaler.\\r\\n\";\n}\nelse {\n    text = \"TV kanaler.\\r\\n\";\n}\n\nfor (var i = 0; i < pl.length; i++) {\n    text += \"kanal \" +(i+1)+\" \" + pl[i].friendly + \".\\r\\n\"\n}\nmsg.payload = text;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1150,
        "y": 240,
        "wires": [
            [
                "9b19a240.8435c",
                "e1993450.6fdaf8"
            ]
        ]
    },
    {
        "id": "e1993450.6fdaf8",
        "type": "debug",
        "z": "f3e95c3b.5524b",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1390,
        "y": 260,
        "wires": []
    },
    {
        "id": "64308672.fd6d48",
        "type": "mqtt out",
        "z": "f3e95c3b.5524b",
        "name": "",
        "topic": "voice/out/da",
        "qos": "2",
        "retain": "false",
        "broker": "4798f2b0.5d747c",
        "x": 1390,
        "y": 140,
        "wires": []
    },
    {
        "id": "56fac17e.4bb53",
        "type": "debug",
        "z": "f3e95c3b.5524b",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1390,
        "y": 60,
        "wires": []
    },
    {
        "id": "1b3e3ce8.dc7b83",
        "type": "change",
        "z": "f3e95c3b.5524b",
        "name": "replace one > 1",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": " one ",
                "fromt": "str",
                "to": " 1 ",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": " one$",
                "fromt": "re",
                "to": " 1",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 120,
        "y": 280,
        "wires": [
            [
                "c903ba75.e7ccf8"
            ]
        ]
    },
    {
        "id": "e8d829b1.2170a8",
        "type": "switch",
        "z": "f3e95c3b.5524b",
        "name": "",
        "property": "voice",
        "propertyType": "msg",
        "rules": [
            {
                "t": "cont",
                "v": "play",
                "vt": "str"
            },
            {
                "t": "cont",
                "v": "list",
                "vt": "str"
            }
        ],
        "checkall": "false",
        "repair": false,
        "outputs": 2,
        "x": 990,
        "y": 180,
        "wires": [
            [
                "63552f4.e48ecd"
            ],
            [
                "e34cb009.9285d"
            ]
        ]
    },
    {
        "id": "15b9f9b2.5f9d56",
        "type": "change",
        "z": "f3e95c3b.5524b",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "playing",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 560,
        "y": 520,
        "wires": [
            [
                "77f10146.752f6"
            ]
        ]
    },
    {
        "id": "9a522fd3.f91f1",
        "type": "mqtt in",
        "z": "f3e95c3b.5524b",
        "name": "",
        "topic": "chromecast/media",
        "qos": "2",
        "broker": "4798f2b0.5d747c",
        "x": 130,
        "y": 1100,
        "wires": [
            [
                "5d6e922e.c661cc"
            ]
        ]
    },
    {
        "id": "6565846f.6ba38c",
        "type": "change",
        "z": "f3e95c3b.5524b",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "playing",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 480,
        "y": 1100,
        "wires": [
            []
        ]
    },
    {
        "id": "5d6e922e.c661cc",
        "type": "json",
        "z": "f3e95c3b.5524b",
        "name": "",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 300,
        "y": 1100,
        "wires": [
            [
                "6565846f.6ba38c"
            ]
        ]
    },
    {
        "id": "77f10146.752f6",
        "type": "template",
        "z": "f3e95c3b.5524b",
        "name": "playing track info",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "Spiller \"{{payload.title}}\" af \"{{payload.artist}}\"",
        "output": "str",
        "x": 770,
        "y": 520,
        "wires": [
            [
                "e0ada975.f0dc78",
                "7c13b786.b0bbe8"
            ]
        ]
    },
    {
        "id": "e0ada975.f0dc78",
        "type": "debug",
        "z": "f3e95c3b.5524b",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 970,
        "y": 500,
        "wires": []
    },
    {
        "id": "7c13b786.b0bbe8",
        "type": "mqtt out",
        "z": "f3e95c3b.5524b",
        "name": "",
        "topic": "voice/out/notranslate-da",
        "qos": "2",
        "retain": "false",
        "broker": "4798f2b0.5d747c",
        "x": 1010,
        "y": 540,
        "wires": []
    },
    {
        "id": "97c43bb6.8f3678",
        "type": "function",
        "z": "f3e95c3b.5524b",
        "name": "bedtime calc",
        "func": "cd = new Date();\nsengetid = 18*60;\nm = cd.getHours()*60 + cd.getMinutes();\nif (m > sengetid) {\n    msg.payload = \"Det er over jeres sengetid\";\n} else {\n    m = sengetid - m;\n    hours = Math.floor(m/60);\n    minutes = m - hours * 60;\n    if (hours > 0) {\n        msg.payload = \"Der er \" + hours + \" timer og \" + minutes + \" minutter til Magnus og Laurits skal i seng\";\n    } else {\n        msg.payload = \"Der er \" + minutes + \" minutter til Magnus og Laurits skal i seng\";\n    }\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 550,
        "y": 660,
        "wires": [
            [
                "b3bd3b4d.b64018",
                "e934344e.95a138"
            ]
        ]
    },
    {
        "id": "b3bd3b4d.b64018",
        "type": "debug",
        "z": "f3e95c3b.5524b",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 750,
        "y": 680,
        "wires": []
    },
    {
        "id": "32ed81c0.bae54e",
        "type": "debug",
        "z": "f3e95c3b.5524b",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 310,
        "y": 220,
        "wires": []
    },
    {
        "id": "5fd2dc2e.b98664",
        "type": "comment",
        "z": "f3e95c3b.5524b",
        "name": "stream predefined audio / video streams (play radio channel xx)",
        "info": "",
        "x": 710,
        "y": 120,
        "wires": []
    },
    {
        "id": "b4a6d39a.af17c",
        "type": "comment",
        "z": "f3e95c3b.5524b",
        "name": "Response to \"bedtime\" calculates time till 20:00 each night (normal bedtime for kids)",
        "info": "",
        "x": 770,
        "y": 600,
        "wires": []
    },
    {
        "id": "1290c358.84d4bd",
        "type": "comment",
        "z": "f3e95c3b.5524b",
        "name": "Fallback, if nothing else matches, play a standard notification back",
        "info": "",
        "x": 720,
        "y": 720,
        "wires": []
    },
    {
        "id": "19efb34.edec84d",
        "type": "comment",
        "z": "f3e95c3b.5524b",
        "name": "What is playing now",
        "info": "",
        "x": 570,
        "y": 480,
        "wires": []
    },
    {
        "id": "52859ff.28ade6",
        "type": "comment",
        "z": "f3e95c3b.5524b",
        "name": "Play stream",
        "info": "",
        "x": 1170,
        "y": 80,
        "wires": []
    },
    {
        "id": "95927491.309d98",
        "type": "comment",
        "z": "f3e95c3b.5524b",
        "name": "List available streams",
        "info": "",
        "x": 1200,
        "y": 200,
        "wires": []
    },
    {
        "id": "c6f6e7a6.7ecf88",
        "type": "switch",
        "z": "f3e95c3b.5524b",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "regex",
                "v": "(stop|quit)",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "pause",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "(resume|play)",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "(next|forward)",
                "vt": "str",
                "case": false
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 4,
        "x": 530,
        "y": 340,
        "wires": [
            [
                "c0148786.c6f5a8"
            ],
            [
                "d6af19ec.073cf8"
            ],
            [
                "569ba770.ab0488"
            ],
            [
                "a80bdfdf.75057"
            ]
        ]
    },
    {
        "id": "84d4040c.24a6b8",
        "type": "mqtt out",
        "z": "f3e95c3b.5524b",
        "name": "",
        "topic": "avctrl/in/control",
        "qos": "2",
        "retain": "false",
        "broker": "4798f2b0.5d747c",
        "x": 880,
        "y": 340,
        "wires": []
    },
    {
        "id": "c0148786.c6f5a8",
        "type": "change",
        "z": "f3e95c3b.5524b",
        "name": "quit",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "quit",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 670,
        "y": 280,
        "wires": [
            [
                "84d4040c.24a6b8"
            ]
        ]
    },
    {
        "id": "d6af19ec.073cf8",
        "type": "change",
        "z": "f3e95c3b.5524b",
        "name": "pause",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "pause",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 670,
        "y": 320,
        "wires": [
            [
                "84d4040c.24a6b8"
            ]
        ]
    },
    {
        "id": "569ba770.ab0488",
        "type": "change",
        "z": "f3e95c3b.5524b",
        "name": "resume",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "play",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 680,
        "y": 360,
        "wires": [
            [
                "84d4040c.24a6b8"
            ]
        ]
    },
    {
        "id": "a80bdfdf.75057",
        "type": "change",
        "z": "f3e95c3b.5524b",
        "name": "next",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "fwd",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 670,
        "y": 400,
        "wires": [
            [
                "84d4040c.24a6b8"
            ]
        ]
    },
    {
        "id": "b923212a.90b3b",
        "type": "comment",
        "z": "f3e95c3b.5524b",
        "name": "Media control (pause/resume/stop)",
        "info": "",
        "x": 620,
        "y": 240,
        "wires": []
    },
    {
        "id": "e934344e.95a138",
        "type": "mqtt out",
        "z": "f3e95c3b.5524b",
        "name": "",
        "topic": "voice/out/da",
        "qos": "",
        "retain": "",
        "broker": "4798f2b0.5d747c",
        "x": 750,
        "y": 640,
        "wires": []
    },
    {
        "id": "49a90932.332258",
        "type": "debug",
        "z": "f3e95c3b.5524b",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 550,
        "y": 440,
        "wires": []
    },
    {
        "id": "a6f70bb5.935f78",
        "type": "debug",
        "z": "d2be3a2a.67d4b8",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 290,
        "y": 80,
        "wires": []
    },
    {
        "id": "1ebdd70b.08e2b9",
        "type": "debug",
        "z": "9292e51b.eaf788",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 1200,
        "y": 40,
        "wires": []
    },
    {
        "id": "fd9f2383.3a4e5",
        "type": "debug",
        "z": "d2be3a2a.67d4b8",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 930,
        "y": 220,
        "wires": []
    },
    {
        "id": "5840b686.2bfc48",
        "type": "function",
        "z": "9292e51b.eaf788",
        "name": "Calc meter data",
        "func": "var m=msg.payload.split(';');\n// Filtering away unrealistic high usage above 50KW\nif (Number(m[0]) < 50000) {\n    var msg1 = {payload:m[0]};\n    var msg2 = {payload:m[1]/1000};\n    var msg3 = null;\n\n    var uTime = Math.floor(Date.now()/60000);\n    var lastTime = context.get('lastTime')||0;\n    if (lastTime === 0) {\n        context.set('lastTime', uTime);\n        context.set('lastCount', Number(m[1]));\n    } else {\n        if (uTime != lastTime) {\n            lastCount = context.get('lastCount');\n            currentCount = Number(m[1]);\n            context.set('lastTime', uTime);\n            context.set('lastCount', currentCount)\n            msg3 = {payload: currentCount - lastCount};\n        }\n    }\n    return [msg1, msg2, msg3];\n}\n",
        "outputs": 3,
        "noerr": 0,
        "x": 640,
        "y": 180,
        "wires": [
            [
                "365e7716.b78748"
            ],
            [
                "88801b19.982088"
            ],
            [
                "21c196cd.d0a07a"
            ]
        ]
    },
    {
        "id": "8faf713d.9be2c",
        "type": "mqtt in",
        "z": "67deb464.98214c",
        "name": "",
        "topic": "mys-in/#",
        "qos": "2",
        "broker": "4798f2b0.5d747c",
        "x": 120,
        "y": 220,
        "wires": [
            [
                "5277fdb6.da1344",
                "7133cb6f.f09d84"
            ]
        ]
    },
    {
        "id": "17c613bf.8b1b8c",
        "type": "mqtt out",
        "z": "67deb464.98214c",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "4798f2b0.5d747c",
        "x": 570,
        "y": 220,
        "wires": []
    },
    {
        "id": "5277fdb6.da1344",
        "type": "myscontroller",
        "z": "67deb464.98214c",
        "database": "ed2765a5.dc9328",
        "name": "controller",
        "handleid": true,
        "timeresponse": true,
        "timezone": "Europe/Copenhagen",
        "measurementsystem": "M",
        "mqttroot": "mys-out",
        "x": 360,
        "y": 220,
        "wires": [
            [
                "17c613bf.8b1b8c",
                "91fdce7d.33a12"
            ]
        ]
    },
    {
        "id": "91fdce7d.33a12",
        "type": "debug",
        "z": "67deb464.98214c",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 570,
        "y": 280,
        "wires": []
    },
    {
        "id": "4fbfed2b.777914",
        "type": "debug",
        "z": "d2be3a2a.67d4b8",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 910,
        "y": 80,
        "wires": []
    },
    {
        "id": "25943056.8c867",
        "type": "inject",
        "z": "d2be3a2a.67d4b8",
        "name": "video",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 110,
        "y": 300,
        "wires": [
            [
                "6b273a3.c572dc4"
            ]
        ]
    },
    {
        "id": "3acf5600.83edda",
        "type": "mqtt out",
        "z": "353b452d.9a6efa",
        "name": "",
        "topic": "",
        "qos": "",
        "retain": "",
        "broker": "4798f2b0.5d747c",
        "x": 1130,
        "y": 540,
        "wires": []
    },
    {
        "id": "68561c.6e57e9e4",
        "type": "mqtt in",
        "z": "353b452d.9a6efa",
        "name": "",
        "topic": "dashboard/sensors/21/1/1/+/16",
        "qos": "2",
        "broker": "4798f2b0.5d747c",
        "x": 170,
        "y": 560,
        "wires": [
            [
                "318f34e.2a0d5cc",
                "3f1c7b26.6eef04"
            ]
        ]
    },
    {
        "id": "7c06d8c4.9d0918",
        "type": "influxdb out",
        "z": "67deb464.98214c",
        "influxdb": "d972b17e.bb915",
        "name": "",
        "measurement": "sensors",
        "precision": "",
        "retentionPolicy": "",
        "x": 880,
        "y": 520,
        "wires": []
    },
    {
        "id": "f4b897e2.e41428",
        "type": "function",
        "z": "67deb464.98214c",
        "name": "Influx",
        "func": "if (!isNaN(msg.payload)) {\n    var tags = {};\n    var data = {};\n    tags.node = msg.nodeId.toString();\n    tags.sensor = msg.childSensorId.toString();\n    tags.subType = msg.subTypeStr;\n    data.value=Number(msg.payload);\n    msg = {payload:[data, tags]};\n    return msg;\n}\n\n",
        "outputs": 1,
        "noerr": 0,
        "x": 590,
        "y": 520,
        "wires": [
            [
                "7c06d8c4.9d0918",
                "94ef2e21.f481"
            ]
        ]
    },
    {
        "id": "eec30a1f.d7c4a8",
        "type": "rbe",
        "z": "67deb464.98214c",
        "name": "",
        "func": "rbe",
        "gap": "",
        "start": "",
        "inout": "out",
        "property": "payload",
        "x": 230,
        "y": 520,
        "wires": [
            [
                "98e4708e.a7886"
            ]
        ]
    },
    {
        "id": "98e4708e.a7886",
        "type": "mysdecode",
        "z": "67deb464.98214c",
        "name": "",
        "mqtt": true,
        "x": 400,
        "y": 520,
        "wires": [
            [
                "f4b897e2.e41428",
                "5d0e1c32.a9c3b4"
            ]
        ]
    },
    {
        "id": "94ef2e21.f481",
        "type": "debug",
        "z": "67deb464.98214c",
        "name": "influx sensors",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 860,
        "y": 480,
        "wires": []
    },
    {
        "id": "82d1c041.0f272",
        "type": "debug",
        "z": "353b452d.9a6efa",
        "name": "admin",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 1130,
        "y": 580,
        "wires": []
    },
    {
        "id": "3fe0e515.5a651a",
        "type": "function",
        "z": "353b452d.9a6efa",
        "name": "Gate logic",
        "func": "var date = new Date();\nvar currentHour = date.getHours();\n\nvar currentState = parseInt(global.get('sensor21_1_16') || '1');\nvar desiredState = parseInt(msg.payload);\nnode.log(currentHour);\nif (desiredState === 1 && currentState === 0) {\n    if (currentHour >= 6) {  \n        // Do not open before 6am\n        return msg;\n    }\n} else if (desiredState === 0 && currentState === 1) {\n    return msg;    \n}\n",
        "outputs": 1,
        "noerr": 0,
        "x": 940,
        "y": 600,
        "wires": [
            [
                "82d1c041.0f272",
                "3acf5600.83edda",
                "668539d1.f0b7d8",
                "4df44078.81ea9"
            ]
        ]
    },
    {
        "id": "b44a5f98.b7e1e",
        "type": "debug",
        "z": "353b452d.9a6efa",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 930,
        "y": 540,
        "wires": []
    },
    {
        "id": "581a5cc2.e013e4",
        "type": "bigtimer",
        "z": "353b452d.9a6efa",
        "outtopic": "mys-out/21/1/1/0/2",
        "outpayload1": "1",
        "outpayload2": "0",
        "name": "Big Timer",
        "comment": "",
        "lat": "56.76696",
        "lon": "10.15406",
        "starttime": "5000",
        "endtime": "5001",
        "startoff": 0,
        "endoff": "-30",
        "offs": 0,
        "outtext1": "",
        "outtext2": "",
        "timeout": 1440,
        "sun": true,
        "mon": true,
        "tue": true,
        "wed": true,
        "thu": true,
        "fri": true,
        "sat": true,
        "jan": true,
        "feb": true,
        "mar": true,
        "apr": true,
        "may": true,
        "jun": true,
        "jul": true,
        "aug": true,
        "sep": true,
        "oct": true,
        "nov": true,
        "dec": true,
        "day1": 0,
        "month1": 0,
        "day2": 0,
        "month2": 0,
        "day3": 0,
        "month3": 0,
        "day4": 0,
        "month4": 0,
        "day5": 0,
        "month5": 0,
        "day6": "",
        "month6": "",
        "d1": 0,
        "w1": 0,
        "d2": 0,
        "w2": 0,
        "d3": 0,
        "w3": 0,
        "d4": 0,
        "w4": 0,
        "d5": 0,
        "w5": 0,
        "d6": "",
        "w6": "",
        "xday1": "",
        "xmonth1": "",
        "xday2": "",
        "xmonth2": "",
        "xday3": "",
        "xmonth3": "",
        "xday4": "",
        "xmonth4": "",
        "xday5": "",
        "xmonth5": "",
        "xday6": "",
        "xmonth6": "",
        "xd1": "",
        "xw1": "",
        "xd2": "",
        "xw2": "",
        "xd3": "",
        "xw3": "",
        "xd4": "",
        "xw4": "",
        "xd5": "",
        "xw5": "",
        "xd6": "",
        "xw6": "",
        "suspend": false,
        "random": false,
        "repeat": true,
        "atstart": true,
        "odd": false,
        "even": false,
        "x": 780,
        "y": 600,
        "wires": [
            [
                "3fe0e515.5a651a",
                "b44a5f98.b7e1e"
            ],
            [],
            []
        ]
    },
    {
        "id": "ef0a28a0.348f08",
        "type": "inject",
        "z": "353b452d.9a6efa",
        "name": "Åben",
        "topic": "mys-out/21/1/1/1/16",
        "payload": "1",
        "payloadType": "str",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 930,
        "y": 420,
        "wires": [
            [
                "3acf5600.83edda"
            ]
        ]
    },
    {
        "id": "50abfbd6.b6e384",
        "type": "inject",
        "z": "353b452d.9a6efa",
        "name": "Luk",
        "topic": "mys-out/21/1/1/1/16",
        "payload": "0",
        "payloadType": "str",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 930,
        "y": 460,
        "wires": [
            [
                "3acf5600.83edda",
                "3fe0e515.5a651a"
            ]
        ]
    },
    {
        "id": "91102938.5a5f88",
        "type": "debug",
        "z": "353b452d.9a6efa",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 410,
        "y": 120,
        "wires": []
    },
    {
        "id": "ba3e6c23.b0914",
        "type": "mqtt in",
        "z": "353b452d.9a6efa",
        "name": "",
        "topic": "mys-in/21/#",
        "qos": "2",
        "broker": "4798f2b0.5d747c",
        "x": 230,
        "y": 120,
        "wires": [
            [
                "91102938.5a5f88"
            ]
        ]
    },
    {
        "id": "6f5e0b48.fb6614",
        "type": "debug",
        "z": "353b452d.9a6efa",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 410,
        "y": 180,
        "wires": []
    },
    {
        "id": "a4b81e2e.dc0a9",
        "type": "mqtt in",
        "z": "353b452d.9a6efa",
        "name": "",
        "topic": "mys-out/21/#",
        "qos": "2",
        "broker": "4798f2b0.5d747c",
        "x": 230,
        "y": 180,
        "wires": [
            [
                "6f5e0b48.fb6614"
            ]
        ]
    },
    {
        "id": "560bb919.0733f8",
        "type": "inject",
        "z": "353b452d.9a6efa",
        "name": "Reset hønsehus",
        "topic": "mys-out/21/255/3/0/13",
        "payload": "1",
        "payloadType": "str",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 960,
        "y": 500,
        "wires": [
            [
                "3acf5600.83edda"
            ]
        ]
    },
    {
        "id": "ffdd44f4.b43d18",
        "type": "mqtt in",
        "z": "353b452d.9a6efa",
        "name": "",
        "topic": "dashboard/sensors/21/7/1/+/16",
        "qos": "2",
        "broker": "4798f2b0.5d747c",
        "x": 170,
        "y": 620,
        "wires": [
            [
                "45511fc7.a3f25"
            ]
        ]
    },
    {
        "id": "45511fc7.a3f25",
        "type": "ui_switch",
        "z": "353b452d.9a6efa",
        "name": "",
        "label": "Fejl status",
        "group": "f4336a2f.6fced8",
        "order": 2,
        "width": "0",
        "height": "0",
        "passthru": false,
        "decouple": "true",
        "topic": "",
        "style": "",
        "onvalue": "1",
        "onvalueType": "str",
        "onicon": "error",
        "oncolor": "#AA5C39",
        "offvalue": "0",
        "offvalueType": "str",
        "officon": "check_circle",
        "offcolor": "#659933",
        "x": 410,
        "y": 620,
        "wires": [
            []
        ]
    },
    {
        "id": "318f34e.2a0d5cc",
        "type": "debug",
        "z": "353b452d.9a6efa",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 390,
        "y": 500,
        "wires": []
    },
    {
        "id": "4a50ab9f.187ab4",
        "type": "mqtt in",
        "z": "353b452d.9a6efa",
        "name": "",
        "topic": "dashboard/sensors/21/2/1/+/16",
        "qos": "2",
        "broker": "4798f2b0.5d747c",
        "x": 170,
        "y": 700,
        "wires": [
            [
                "40a9e020.ae45"
            ]
        ]
    },
    {
        "id": "40a9e020.ae45",
        "type": "ui_switch",
        "z": "353b452d.9a6efa",
        "name": "",
        "label": "Bevægelse",
        "group": "f4336a2f.6fced8",
        "order": 3,
        "width": "0",
        "height": "0",
        "passthru": false,
        "decouple": "true",
        "topic": "",
        "style": "",
        "onvalue": "1",
        "onvalueType": "str",
        "onicon": "person",
        "oncolor": "#659933",
        "offvalue": "0",
        "offvalueType": "str",
        "officon": "person_outline",
        "offcolor": "#AA5C39",
        "x": 410,
        "y": 700,
        "wires": [
            []
        ]
    },
    {
        "id": "a76ee66b.35b7d8",
        "type": "debug",
        "z": "d9d4d547.6a9438",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 330,
        "y": 400,
        "wires": []
    },
    {
        "id": "1fcb323.25bfbce",
        "type": "debug",
        "z": "d9d4d547.6a9438",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 630,
        "y": 300,
        "wires": []
    },
    {
        "id": "bd56c99b.7870c8",
        "type": "ui_button",
        "z": "353b452d.9a6efa",
        "name": "",
        "group": "f4336a2f.6fced8",
        "order": 5,
        "width": "2",
        "height": "1",
        "passthru": false,
        "label": "{{msg.label}}",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "",
        "x": 590,
        "y": 580,
        "wires": [
            [
                "de2638c5.ef7ed8"
            ]
        ]
    },
    {
        "id": "de2638c5.ef7ed8",
        "type": "function",
        "z": "353b452d.9a6efa",
        "name": "Gate logic",
        "func": "var openState = global.get('sensor21_1_16') || '1';\n\nbMsg = {enabled:false, label:\"Kører\"};\n\nif (openState === \"0\") {\n    msg = {payload: \"1\"};\n\n    \n} else {\n    msg = {payload: \"0\"};    \n}\n\nreturn [msg, bMsg];",
        "outputs": 2,
        "noerr": 0,
        "x": 600,
        "y": 640,
        "wires": [
            [
                "581a5cc2.e013e4"
            ],
            [
                "bd56c99b.7870c8"
            ]
        ]
    },
    {
        "id": "3f1c7b26.6eef04",
        "type": "function",
        "z": "353b452d.9a6efa",
        "name": "Gate logic",
        "func": "var openState = msg.payload;\nif (openState === \"0\") {\n    return [{payload:'lukket'}, {enabled:true, label:\"Åben\"}];\n        \n} else {\n    return [{payload:'åben'}, {enabled:true, label:\"Luk\"}];\n}\n",
        "outputs": 2,
        "noerr": 0,
        "x": 400,
        "y": 560,
        "wires": [
            [
                "25a38df8.b32df2"
            ],
            [
                "bd56c99b.7870c8"
            ]
        ]
    },
    {
        "id": "25a38df8.b32df2",
        "type": "ui_text",
        "z": "353b452d.9a6efa",
        "group": "f4336a2f.6fced8",
        "order": 4,
        "width": "4",
        "height": "1",
        "name": "",
        "label": "Hønselem er ",
        "format": "{{msg.payload}}",
        "layout": "row-left",
        "x": 610,
        "y": 540,
        "wires": []
    },
    {
        "id": "eca59fbf.2316e",
        "type": "delay",
        "z": "353b452d.9a6efa",
        "name": "",
        "pauseType": "delay",
        "timeout": "20",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 1360,
        "y": 620,
        "wires": [
            [
                "c9e389d4.3cac08"
            ]
        ]
    },
    {
        "id": "c9e389d4.3cac08",
        "type": "function",
        "z": "353b452d.9a6efa",
        "name": "Check gate message",
        "func": "lastGateAction = flow.get('lastGateAction');\ncurrentTime = Date.now();\ndiff = (currentTime - lastGateAction) / 1000;\nnode.log(diff);\nif (diff > 15) {\n    node.log('something happened');\n    return msg;\n}\n",
        "outputs": 1,
        "noerr": 0,
        "x": 1540,
        "y": 620,
        "wires": [
            [
                "25778132.e0114e"
            ]
        ]
    },
    {
        "id": "4df44078.81ea9",
        "type": "change",
        "z": "353b452d.9a6efa",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "lastGateAction",
                "pt": "flow",
                "to": "",
                "tot": "date"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1180,
        "y": 500,
        "wires": [
            []
        ]
    },
    {
        "id": "668539d1.f0b7d8",
        "type": "function",
        "z": "353b452d.9a6efa",
        "name": "Reset and re-emit message",
        "func": "node.send({reset:'yes'});\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1140,
        "y": 620,
        "wires": [
            [
                "eca59fbf.2316e",
                "539bdcf1.a0c3d4"
            ]
        ]
    },
    {
        "id": "539bdcf1.a0c3d4",
        "type": "debug",
        "z": "353b452d.9a6efa",
        "name": "admin",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 1350,
        "y": 660,
        "wires": []
    },
    {
        "id": "25778132.e0114e",
        "type": "debug",
        "z": "353b452d.9a6efa",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 1720,
        "y": 520,
        "wires": []
    },
    {
        "id": "b11d1c3b.b75f6",
        "type": "function",
        "z": "be12afc0.d1228",
        "name": "Calc dew point",
        "func": "var minT = 173; // -100 Deg. C.\nvar maxT = 678;\nvar C_OFFSET = 273.15;\n\n/*\n * Saturation Vapor Pressure formula for range -100..0 Deg. C.\n * This is taken from\n *   ITS-90 Formulations for Vapor Pressure, Frostpoint Temperature,\n *   Dewpoint Temperature, and Enhancement Factors in the Range 100 to +100 C\n * by Bob Hardy\n * as published in \"The Proceedings of the Third International Symposium on Humidity & Moisture\",\n * Teddington, London, England, April 1998\n*/\nvar k0 = -5.8666426e3;\nvar k1 = 2.232870244e1;\nvar k2 = 1.39387003e-2;\nvar k3 = -3.4262402e-5;\nvar k4 = 2.7040955e-8;\nvar k5 = 6.7063522e-1;\n\nfunction pvsIce(T) {\n  lnP = k0/T + k1 + (k2 + (k3 + (k4*T))*T)*T + k5*Math.log(T);\n  return Math.exp(lnP);\n}\n\n/**\n * Saturation Vapor Pressure formula for range 273..678 Deg. K.\n * This is taken from the\n *   Release on the IAPWS Industrial Formulation 1997\n *   for the Thermodynamic Properties of Water and Steam\n * by IAPWS (International Association for the Properties of Water and Steam),\n * Erlangen, Germany, September 1997.\n *\n * This is Equation (30) in Section 8.1 \"The Saturation-Pressure Equation (Basic Equation)\"\n*/\n\nvar n1 = 0.11670521452767e4;\nvar n6 = 0.14915108613530e2;\nvar n2 = -0.72421316703206e6;\nvar n7 = -0.48232657361591e4;\nvar n3 = -0.17073846940092e2;\nvar n8 = 0.40511340542057e6;\nvar n4 = 0.12020824702470e5;\nvar n9 = -0.23855557567849;\nvar n5 = -0.32325550322333e7;\nvar n10 = 0.65017534844798e3;\n\nfunction pvsWater(T) {\n  var th = T+n9/(T-n10);\n  var A = (th+n1)*th+n2;\n  var B = (n3*th+n4)*th+n5;\n  var C = (n6*th+n7)*th+n8;\n\n  var p = 2*C/(-B+Math.sqrt(B*B-4*A*C));\n  p *= p;\n  p *= p;\n  return p*1e6;\n}\n\n/**\n * Compute Saturation Vapor Pressure for minT<T[Deg.K]<maxT.\n */\nfunction PVS(T) {\n  if (T<minT || T>maxT) return NaN;\n  else if (T<C_OFFSET)\n    return pvsIce(T);\n  else\n    return pvsWater(T);\n}\n\n/**\n * Compute dewPoint for given relative humidity RH[%] and temperature T[Deg.K].\n */\nfunction dewPoint(RH,T) {\n  return solve(PVS, RH/100*PVS(T), T);\n}\n\n/**\n * Newton's Method to solve f(x)=y for x with an initial guess of x0.\n */\nfunction solve(f,y,x0) {\n  var x = x0;\n  var maxCount = 10;\n  var count = 0;\n  do {\n    var xNew;\n    var dx = x/1000; \n    var z=f(x);\n    xNew = x + dx*(y-z)/(f(x+dx)-z);\n    if (Math.abs((xNew-x)/xNew)<0.0001) \n      return xNew;\n    else if (count>maxCount) {\n      xnew=NaN; \n      throw new Error(1, \"Solver does not converge.\");\n    }\n    x = xNew;\n    count ++;\n  } while (true);\n}\np = msg.payload;\nmsg.payload = dewPoint(p.RH, p.T + C_OFFSET) - C_OFFSET;\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 600,
        "y": 380,
        "wires": [
            [
                "3702f4e1.be00cc",
                "eb32fd54.8c003"
            ]
        ]
    },
    {
        "id": "e7eace85.b6962",
        "type": "mqtt in",
        "z": "be12afc0.d1228",
        "name": "",
        "topic": "dashboard/sensors/+/1/1/0/0",
        "qos": "2",
        "broker": "4798f2b0.5d747c",
        "x": 140,
        "y": 260,
        "wires": [
            [
                "871f830d.a1cef",
                "a8f6d770.1df028"
            ]
        ]
    },
    {
        "id": "871f830d.a1cef",
        "type": "debug",
        "z": "be12afc0.d1228",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 390,
        "y": 260,
        "wires": []
    },
    {
        "id": "1594535.6096aad",
        "type": "mqtt in",
        "z": "be12afc0.d1228",
        "name": "",
        "topic": "dashboard/sensors/+/2/1/0/1",
        "qos": "2",
        "broker": "4798f2b0.5d747c",
        "x": 140,
        "y": 340,
        "wires": [
            [
                "ee35992b.ea6318",
                "a8f6d770.1df028"
            ]
        ]
    },
    {
        "id": "ee35992b.ea6318",
        "type": "debug",
        "z": "be12afc0.d1228",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 390,
        "y": 340,
        "wires": []
    },
    {
        "id": "6f57b705.8752a8",
        "type": "function",
        "z": "be12afc0.d1228",
        "name": "Assemble humidity and temperature",
        "func": "let sensor = msg.nodeId;\nlet sensorVar = 'temphum_' + sensor;\n\nlet x = flow.get(sensorVar, null);\nif (!x) {\n    x = {RH: -100, T: -100}\n}\n\nif (msg.subType === 0) {\n    x.T = Number(msg.payload);\n}\nif (msg.subType === 1) {\n    x.RH = Number(msg.payload);\n}\n\nflow.set(sensorVar, x);\nif (sensor === 11) {\n\n}\nif (x.RH > -100 && x.T > -100) {\n    msg.payload = x;\n    return msg;\n}",
        "outputs": 1,
        "noerr": 0,
        "x": 670,
        "y": 300,
        "wires": [
            [
                "11a2bf02.4ef451",
                "b11d1c3b.b75f6"
            ]
        ]
    },
    {
        "id": "a8f6d770.1df028",
        "type": "mysdecode",
        "z": "be12afc0.d1228",
        "name": "",
        "mqtt": true,
        "x": 400,
        "y": 300,
        "wires": [
            [
                "6f57b705.8752a8",
                "fc149334.c3ae7"
            ]
        ]
    },
    {
        "id": "11a2bf02.4ef451",
        "type": "debug",
        "z": "be12afc0.d1228",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 930,
        "y": 260,
        "wires": []
    },
    {
        "id": "fc149334.c3ae7",
        "type": "debug",
        "z": "be12afc0.d1228",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 570,
        "y": 260,
        "wires": []
    },
    {
        "id": "3702f4e1.be00cc",
        "type": "function",
        "z": "be12afc0.d1228",
        "name": "mys-in/<sensorId>/5/1/0/0",
        "func": "topic = \"mys-in/\"+msg.nodeId+\"/5/1/0/0\";\nmsg.topic = topic;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 830,
        "y": 380,
        "wires": [
            [
                "3bf7809.4c35b8",
                "892e9fd0.60d7b"
            ]
        ]
    },
    {
        "id": "eb32fd54.8c003",
        "type": "debug",
        "z": "be12afc0.d1228",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 770,
        "y": 420,
        "wires": []
    },
    {
        "id": "3bf7809.4c35b8",
        "type": "debug",
        "z": "be12afc0.d1228",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 1010,
        "y": 360,
        "wires": []
    },
    {
        "id": "892e9fd0.60d7b",
        "type": "mqtt out",
        "z": "be12afc0.d1228",
        "name": "",
        "topic": "",
        "qos": "0",
        "retain": "false",
        "broker": "4798f2b0.5d747c",
        "x": 1010,
        "y": 400,
        "wires": []
    },
    {
        "id": "671f603c.7e90f",
        "type": "mqtt in",
        "z": "be12afc0.d1228",
        "name": "",
        "topic": "dashboard/sensors/11/#",
        "qos": "2",
        "broker": "4798f2b0.5d747c",
        "x": 310,
        "y": 120,
        "wires": [
            [
                "87a6c935.e796e8"
            ]
        ]
    },
    {
        "id": "87a6c935.e796e8",
        "type": "debug",
        "z": "be12afc0.d1228",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 530,
        "y": 120,
        "wires": []
    },
    {
        "id": "9b1ad06.4a8493",
        "type": "switch",
        "z": "8bc8753a.1ea768",
        "name": "Temperature split",
        "property": "childSensorId",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "1",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "5",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 690,
        "y": 260,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "f51b6568.3a4f58",
        "type": "ui_gauge",
        "z": "36f02452.2e99bc",
        "name": "",
        "group": "e11ff54d.12ad78",
        "order": 0,
        "width": "3",
        "height": "3",
        "gtype": "gage",
        "title": "Dugpunkt",
        "label": "units",
        "format": "{{value|number:1}}",
        "min": 0,
        "max": "25",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "x": 720,
        "y": 400,
        "wires": []
    },
    {
        "id": "b4b40152.cacdf",
        "type": "ui_gauge",
        "z": "36f02452.2e99bc",
        "name": "",
        "group": "1215f3be.8c080c",
        "order": 0,
        "width": "3",
        "height": "3",
        "gtype": "gage",
        "title": "Dugpunkt",
        "label": "units",
        "format": "{{value|number:1}}",
        "min": 0,
        "max": "25",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "x": 720,
        "y": 460,
        "wires": []
    },
    {
        "id": "d4022586.9648b8",
        "type": "ui_gauge",
        "z": "36f02452.2e99bc",
        "name": "",
        "group": "58bcd57b.789b2c",
        "order": 0,
        "width": "3",
        "height": "3",
        "gtype": "gage",
        "title": "Dugpunkt",
        "label": "units",
        "format": "{{value|number:1}}",
        "min": 0,
        "max": "25",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "x": 690,
        "y": 578,
        "wires": []
    },
    {
        "id": "353e8c59.b58854",
        "type": "ui_gauge",
        "z": "36f02452.2e99bc",
        "name": "",
        "group": "d9490c52.897ce",
        "order": 0,
        "width": "3",
        "height": "3",
        "gtype": "gage",
        "title": "Dugpunkt",
        "label": "units",
        "format": "{{value|number:1}}",
        "min": 0,
        "max": "25",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "x": 660,
        "y": 740,
        "wires": []
    },
    {
        "id": "25d7d30a.26ffac",
        "type": "ui_gauge",
        "z": "36f02452.2e99bc",
        "name": "",
        "group": "85f5cfaa.42289",
        "order": 7,
        "width": "3",
        "height": "3",
        "gtype": "gage",
        "title": "Dugpunkt",
        "label": "units",
        "format": "{{value|number:1}}",
        "min": 0,
        "max": "25",
        "colors": [
            "#00b500",
            "#e6e600",
            "#ca3838"
        ],
        "seg1": "",
        "seg2": "",
        "x": 760,
        "y": 220,
        "wires": []
    },
    {
        "id": "2a57fcca.e5f8f4",
        "type": "ui_chart",
        "z": "36f02452.2e99bc",
        "name": "",
        "group": "85f5cfaa.42289",
        "order": 8,
        "width": "3",
        "height": "3",
        "label": "Dugpunkt",
        "chartType": "line",
        "legend": "false",
        "xformat": "HH:mm:ss",
        "interpolate": "linear",
        "nodata": "",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": 1,
        "removeOlderPoints": "",
        "removeOlderUnit": "86400",
        "cutout": 0,
        "useOneColor": false,
        "colors": [
            "#1f77b4",
            "#aec7e8",
            "#ff7f0e",
            "#2ca02c",
            "#98df8a",
            "#d62728",
            "#ff9896",
            "#9467bd",
            "#c5b0d5"
        ],
        "useOldStyle": false,
        "outputs": 2,
        "x": 760,
        "y": 280,
        "wires": [
            [],
            []
        ]
    },
    {
        "id": "5d0e1c32.a9c3b4",
        "type": "debug",
        "z": "67deb464.98214c",
        "name": "logger",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 590,
        "y": 480,
        "wires": []
    },
    {
        "id": "3deb70cf.009b5",
        "type": "mqtt in",
        "z": "353b452d.9a6efa",
        "name": "",
        "topic": "dashboard/sensors/21/3/1/+/16",
        "qos": "2",
        "broker": "4798f2b0.5d747c",
        "x": 170,
        "y": 780,
        "wires": [
            [
                "89aef6d0.430048"
            ]
        ]
    },
    {
        "id": "89aef6d0.430048",
        "type": "ui_switch",
        "z": "353b452d.9a6efa",
        "name": "",
        "label": "Dør",
        "group": "f4336a2f.6fced8",
        "order": 3,
        "width": "0",
        "height": "0",
        "passthru": false,
        "decouple": "true",
        "topic": "",
        "style": "",
        "onvalue": "1",
        "onvalueType": "str",
        "onicon": "lock_open",
        "oncolor": "#AA5C39",
        "offvalue": "0",
        "offvalueType": "str",
        "officon": "lock",
        "offcolor": "#659933",
        "x": 390,
        "y": 780,
        "wires": [
            []
        ]
    },
    {
        "id": "d1c3dfca.29869",
        "type": "inject",
        "z": "353b452d.9a6efa",
        "name": "",
        "topic": "",
        "payload": "1",
        "payloadType": "str",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 570,
        "y": 360,
        "wires": [
            [
                "3fe0e515.5a651a"
            ]
        ]
    },
    {
        "id": "a5fd3138.972fb",
        "type": "inject",
        "z": "353b452d.9a6efa",
        "name": "",
        "topic": "",
        "payload": "0",
        "payloadType": "str",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 570,
        "y": 400,
        "wires": [
            [
                "3fe0e515.5a651a"
            ]
        ]
    },
    {
        "id": "d6ff21b7.c335b",
        "type": "mqtt in",
        "z": "7acba262.c6674c",
        "name": "",
        "topic": "avctrl/out/scene",
        "qos": "2",
        "broker": "4798f2b0.5d747c",
        "x": 120,
        "y": 820,
        "wires": [
            [
                "f8d07c79.3f779"
            ]
        ]
    },
    {
        "id": "f8d07c79.3f779",
        "type": "json",
        "z": "7acba262.c6674c",
        "name": "",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 370,
        "y": 820,
        "wires": [
            [
                "cca133f3.045c2",
                "cd058bf6.a76838"
            ]
        ]
    },
    {
        "id": "8d19bab2.8e9f38",
        "type": "mqtt in",
        "z": "d9d4d547.6a9438",
        "name": "",
        "topic": "chromecast/tv_stuen/state",
        "qos": "2",
        "datatype": "auto",
        "broker": "4798f2b0.5d747c",
        "x": 150,
        "y": 140,
        "wires": [
            [
                "f518f36d.e50be"
            ]
        ]
    },
    {
        "id": "f518f36d.e50be",
        "type": "function",
        "z": "d9d4d547.6a9438",
        "name": "set lights",
        "func": "var avctrl = global.get(\"avctrl\") || \"OFF\";\nvar daylight = Number(flow.get('daylight') || 0);\nvar msgOut = null;\nvar currentLight = Number(flow.get('sensor14_1_3') || 0);\nif ((avctrl === \"stream video\") && \n    (daylight === 0)) {\n\n    if (msg.payload === 'PLAYING') {\n        msgOut = {payload : 5};\n    }\n    if (msg.payload == 'PAUSED' || msg.payload=== 'STOPPED') {\n        msgOut = {payload: 100};\n    }\n}\nif (msgOut !== null && msgOut.payload === currentLight) {\n    msgOut = null;\n}\nreturn msgOut;\n",
        "outputs": 1,
        "noerr": 0,
        "x": 340,
        "y": 140,
        "wires": [
            [
                "72a0f42e.57bf4c",
                "2c89a82a.ecab58",
                "dbe26677.cae0b8"
            ]
        ]
    },
    {
        "id": "229f8903.0245a6",
        "type": "change",
        "z": "7acba262.c6674c",
        "name": "default light settings",
        "rules": [
            {
                "t": "set",
                "p": "max",
                "pt": "flow",
                "to": "100",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "min",
                "pt": "flow",
                "to": "10",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "off",
                "pt": "flow",
                "to": "0",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 320,
        "y": 720,
        "wires": [
            []
        ]
    },
    {
        "id": "5c9cbd11.3e3544",
        "type": "inject",
        "z": "7acba262.c6674c",
        "name": "",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "x": 110,
        "y": 719,
        "wires": [
            [
                "229f8903.0245a6"
            ]
        ]
    },
    {
        "id": "cca133f3.045c2",
        "type": "function",
        "z": "7acba262.c6674c",
        "name": "Light states TV on/off",
        "func": "var DiningTable = { topic: \"light/spisebord/set\", payload: null};\nvar CouchTable = { topic: \"light/sofabord/set\", payload: null};\nvar TV = {topic: \"light/tv/set\", payload: null};\nvar lightMax = flow.get('max', {});\nvar lightMin = flow.get('min', {});\nvar lightOff = flow.get('off', {});\nvar activityName = msg.payload.activityName;\nswitch (activityName){\n  case 'OFF':\n    TV['payload'] = lightMax;\n    CouchTable['payload'] = lightMax;\n    DiningTable['payload'] = lightMax;\n    break;\n  case 'WII':\n  case 'DVD':\n  case 'PS2':\n  case 'Stream Video':\n    TV['payload'] = lightMin;\n    CouchTable['payload'] = lightMax;\n    DiningTable['payload'] = lightMax;\n    break;\n}\nif (!flow.get('disablechrome', false)) {\n    node.send(TV);\n    node.send(CouchTable);\n    node.send(DiningTable);\n}\n",
        "outputs": 1,
        "noerr": 0,
        "x": 560,
        "y": 820,
        "wires": [
            [
                "577569c2.142898",
                "85f8634a.a6b85"
            ]
        ]
    },
    {
        "id": "577569c2.142898",
        "type": "debug",
        "z": "7acba262.c6674c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 810,
        "y": 780,
        "wires": []
    },
    {
        "id": "cd058bf6.a76838",
        "type": "debug",
        "z": "7acba262.c6674c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 510,
        "y": 780,
        "wires": []
    },
    {
        "id": "c06c0dcb.adbf8",
        "type": "function",
        "z": "7acba262.c6674c",
        "name": "Light states streaming Media",
        "func": "var DiningTable = { topic: \"light/spisebord/set\", payload: null};\nvar CouchTable = { topic: \"light/sofabord/set\", payload: null};\nvar TV = {topic: \"light/tv/set\", payload: null};\nvar lightMax = flow.get('max', 100);\nvar lightMin = flow.get('min', 10);\nvar lightOff = flow.get('off', 'off');\nvar avctrl = global.get(\"avctrl\") || \"OFF\";\n\nif (avctrl === \"stream video\") {\n    switch (msg.payload){\n        case 'BUFFERING':\n        case 'PLAYING':\n            TV['payload'] = lightOff;\n            CouchTable['payload'] = lightMin;\n            DiningTable['payload'] = lightOff;\n            break;\n        case 'PAUSED':\n        case 'STOPPED':\n        case 'IDDLE':\n            TV['payload'] = lightMin;\n            CouchTable['payload'] = lightMax;\n            DiningTable['payload'] = lightMin;\n            break;\n    }\n}\nif (!flow.get('disablechrome', false)) {\n    node.send(TV);\n    node.send(CouchTable);\n    node.send(DiningTable);\n}\n",
        "outputs": 1,
        "noerr": 0,
        "x": 580,
        "y": 860,
        "wires": [
            [
                "85f8634a.a6b85",
                "3c79a61c.126b8a"
            ]
        ]
    },
    {
        "id": "2b91e18a.6e4b9e",
        "type": "debug",
        "z": "7acba262.c6674c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 1050,
        "y": 840,
        "wires": []
    },
    {
        "id": "a8c23c85.aee87",
        "type": "debug",
        "z": "7acba262.c6674c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 370,
        "y": 880,
        "wires": []
    },
    {
        "id": "7f794e09.7dd7",
        "type": "mqtt out",
        "z": "7acba262.c6674c",
        "name": "",
        "topic": "",
        "qos": "2",
        "retain": "false",
        "broker": "4798f2b0.5d747c",
        "x": 1050,
        "y": 880,
        "wires": []
    },
    {
        "id": "fbbb807b.7ab1a",
        "type": "mqtt in",
        "z": "7acba262.c6674c",
        "name": "",
        "topic": "chromecast/tv_stuen/state",
        "qos": "2",
        "datatype": "auto",
        "broker": "4798f2b0.5d747c",
        "x": 150,
        "y": 860,
        "wires": [
            [
                "c06c0dcb.adbf8",
                "a8c23c85.aee87"
            ]
        ]
    },
    {
        "id": "f6342f76.5471f",
        "type": "H activity",
        "z": "d2be3a2a.67d4b8",
        "name": "PS2",
        "server": "56b003cf.93c9bc",
        "activity": "35554241",
        "label": "PS2",
        "x": 470,
        "y": 280,
        "wires": [
            []
        ]
    },
    {
        "id": "4ccc2add.3992a4",
        "type": "ui_switch",
        "z": "7acba262.c6674c",
        "name": "",
        "label": "Spisebord følg ikke chromecast",
        "group": "bf3de794.50d788",
        "order": 7,
        "width": 0,
        "height": 0,
        "passthru": true,
        "decouple": "false",
        "topic": "",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "x": 450,
        "y": 1060,
        "wires": [
            [
                "92a324c0.3395e8",
                "587cd344.5ddf0c",
                "58c988f8.55cf68",
                "ab06cb70.7fdf08"
            ]
        ]
    },
    {
        "id": "92a324c0.3395e8",
        "type": "change",
        "z": "7acba262.c6674c",
        "name": "set disablechrome variable",
        "rules": [
            {
                "t": "set",
                "p": "disablechrome",
                "pt": "flow",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 800,
        "y": 1020,
        "wires": [
            []
        ]
    },
    {
        "id": "307f8e0.df46872",
        "type": "ui_slider",
        "z": "7acba262.c6674c",
        "name": "slider sofabord",
        "label": "sofabord",
        "group": "bf3de794.50d788",
        "order": 3,
        "width": "0",
        "height": "0",
        "passthru": false,
        "topic": "light/sofabord/set",
        "min": 0,
        "max": "100",
        "step": 1,
        "x": 400,
        "y": 1260,
        "wires": [
            [
                "5c9fdc73.26c744"
            ]
        ]
    },
    {
        "id": "f7578eb6.e12bb",
        "type": "ui_slider",
        "z": "7acba262.c6674c",
        "name": "",
        "label": "spisebord",
        "group": "bf3de794.50d788",
        "order": 4,
        "width": "0",
        "height": "0",
        "passthru": false,
        "topic": "light/spisebord/set",
        "min": 0,
        "max": "100",
        "step": 1,
        "x": 380,
        "y": 1200,
        "wires": [
            [
                "5c9fdc73.26c744"
            ]
        ]
    },
    {
        "id": "5c9fdc73.26c744",
        "type": "mqtt out",
        "z": "7acba262.c6674c",
        "name": "",
        "topic": "",
        "qos": "0",
        "retain": "false",
        "broker": "4798f2b0.5d747c",
        "x": 670,
        "y": 1300,
        "wires": []
    },
    {
        "id": "ecfb8b6b.a53fd8",
        "type": "ui_slider",
        "z": "7acba262.c6674c",
        "name": "slider TV",
        "label": "TV",
        "group": "bf3de794.50d788",
        "order": 5,
        "width": "0",
        "height": "0",
        "passthru": false,
        "topic": "light/tv/set",
        "min": 0,
        "max": "100",
        "step": 1,
        "x": 380,
        "y": 1320,
        "wires": [
            [
                "5c9fdc73.26c744"
            ]
        ]
    },
    {
        "id": "8b089848.8dab28",
        "type": "mqtt in",
        "z": "7acba262.c6674c",
        "name": "",
        "topic": "light/spisebord/state",
        "qos": "2",
        "broker": "4798f2b0.5d747c",
        "x": 130,
        "y": 1200,
        "wires": [
            [
                "f7578eb6.e12bb"
            ]
        ]
    },
    {
        "id": "265d3ac3.0134e6",
        "type": "mqtt out",
        "z": "7acba262.c6674c",
        "name": "",
        "topic": "ikea/settings/disablechrome",
        "qos": "2",
        "retain": "true",
        "broker": "4798f2b0.5d747c",
        "x": 960,
        "y": 1100,
        "wires": []
    },
    {
        "id": "5e91505b.63d56",
        "type": "mqtt in",
        "z": "7acba262.c6674c",
        "name": "",
        "topic": "ikea/settings/disablechrome",
        "qos": "2",
        "broker": "4798f2b0.5d747c",
        "x": 160,
        "y": 1060,
        "wires": [
            [
                "4ccc2add.3992a4",
                "ab06cb70.7fdf08"
            ]
        ]
    },
    {
        "id": "587cd344.5ddf0c",
        "type": "switch",
        "z": "7acba262.c6674c",
        "name": "",
        "property": "topic",
        "propertyType": "msg",
        "rules": [
            {
                "t": "cont",
                "v": "ikea",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 730,
        "y": 1080,
        "wires": [
            [
                "b447a639.4362c8"
            ],
            [
                "265d3ac3.0134e6",
                "b447a639.4362c8",
                "150081ae.829ebe"
            ]
        ]
    },
    {
        "id": "b447a639.4362c8",
        "type": "debug",
        "z": "7acba262.c6674c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 890,
        "y": 1060,
        "wires": []
    },
    {
        "id": "58c988f8.55cf68",
        "type": "debug",
        "z": "7acba262.c6674c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 730,
        "y": 1120,
        "wires": []
    },
    {
        "id": "ab06cb70.7fdf08",
        "type": "debug",
        "z": "7acba262.c6674c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 730,
        "y": 980,
        "wires": []
    },
    {
        "id": "9a66e5eb.2e9fe8",
        "type": "function",
        "z": "d17c54ad.8abb78",
        "name": "",
        "func": "if (msg.payload !== null) {\n    var p = msg.payload.toLowerCase();\n    if (p === \"off\") {\n        msg.payload = {\"state\":\"off\"};\n    } else if (p === \"on\") {\n        msg.payload = {\"state\":\"on\"};\n    } else if (!Number.isNaN(p)) {\n        p = Math.round(p * 2.55);\n        msg.payload = {\"brightness\": p};\n    } else {\n        msg = undefined;\n    }\n    \n    return msg;\n}",
        "outputs": 1,
        "noerr": 0,
        "x": 250,
        "y": 500,
        "wires": [
            []
        ]
    },
    {
        "id": "4e28aa84.c6f5e4",
        "type": "mqtt in",
        "z": "7acba262.c6674c",
        "name": "",
        "topic": "light/sofabord/state",
        "qos": "2",
        "broker": "4798f2b0.5d747c",
        "x": 130,
        "y": 1260,
        "wires": [
            [
                "307f8e0.df46872"
            ]
        ]
    },
    {
        "id": "cbda8c93.a7da",
        "type": "mqtt in",
        "z": "7acba262.c6674c",
        "name": "",
        "topic": "light/tv/state",
        "qos": "2",
        "broker": "4798f2b0.5d747c",
        "x": 110,
        "y": 1320,
        "wires": [
            [
                "ecfb8b6b.a53fd8"
            ]
        ]
    },
    {
        "id": "e562feef.76b7a",
        "type": "ui_slider",
        "z": "7acba262.c6674c",
        "name": "",
        "label": "Stuen alt lys",
        "group": "bf3de794.50d788",
        "order": 6,
        "width": 0,
        "height": 0,
        "passthru": false,
        "topic": "light/all/set",
        "min": 0,
        "max": "100",
        "step": 1,
        "x": 390,
        "y": 1380,
        "wires": [
            [
                "5c9fdc73.26c744"
            ]
        ]
    },
    {
        "id": "70b7ab46.ea1154",
        "type": "delay",
        "z": "7acba262.c6674c",
        "name": "100mS",
        "pauseType": "delay",
        "timeout": "100",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 1420,
        "y": 720,
        "wires": [
            [
                "3b9bb8db.d283a8"
            ]
        ]
    },
    {
        "id": "93d27893.c67178",
        "type": "delay",
        "z": "7acba262.c6674c",
        "name": "100mS",
        "pauseType": "delay",
        "timeout": "100",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 1420,
        "y": 780,
        "wires": [
            [
                "625aa6eb.f19b98"
            ]
        ]
    },
    {
        "id": "83b53a84.ec6b58",
        "type": "delay",
        "z": "7acba262.c6674c",
        "name": "200mS",
        "pauseType": "delay",
        "timeout": "200",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "x": 1420,
        "y": 820,
        "wires": [
            [
                "63a8e9a0.6338c8"
            ]
        ]
    },
    {
        "id": "5f4a5d2e.d34ad4",
        "type": "inject",
        "z": "7acba262.c6674c",
        "name": "TV",
        "topic": "zigbee/light/tvmid/get",
        "payload": "",
        "payloadType": "date",
        "repeat": "60",
        "crontab": "",
        "once": true,
        "onceDelay": "10",
        "x": 1530,
        "y": 400,
        "wires": [
            [
                "912c8611.84ff38"
            ]
        ]
    },
    {
        "id": "b18c9145.71144",
        "type": "inject",
        "z": "7acba262.c6674c",
        "name": "Spisebord",
        "topic": "zigbee/light/spisebord1/get",
        "payload": "",
        "payloadType": "date",
        "repeat": "60",
        "crontab": "",
        "once": true,
        "onceDelay": "30",
        "x": 1550,
        "y": 480,
        "wires": [
            [
                "912c8611.84ff38"
            ]
        ]
    },
    {
        "id": "c8acec90.21e0a",
        "type": "inject",
        "z": "7acba262.c6674c",
        "name": "Sofabord",
        "topic": "zigbee/light/sofabord/get",
        "payload": "",
        "payloadType": "date",
        "repeat": "60",
        "crontab": "",
        "once": true,
        "onceDelay": "20",
        "x": 1550,
        "y": 440,
        "wires": [
            [
                "912c8611.84ff38"
            ]
        ]
    },
    {
        "id": "f27f6ec2.be6df",
        "type": "mqtt in",
        "z": "7acba262.c6674c",
        "name": "",
        "topic": "light/+/state",
        "qos": "2",
        "datatype": "auto",
        "broker": "4798f2b0.5d747c",
        "x": 1550,
        "y": 280,
        "wires": [
            [
                "54a224ff.dcb81c",
                "e19d4bb5.00f718"
            ]
        ]
    },
    {
        "id": "54a224ff.dcb81c",
        "type": "function",
        "z": "7acba262.c6674c",
        "name": "Send default",
        "func": "device = msg.topic.split('/')[1];\nflowVar = `oldState_${device}`;\nvar oldState = flow.get(flowVar) || 'N/A';\n\nif (msg.payload !== oldState) {\n    if (oldState === 'offline') {\n        msg.payload = flow.get('max');\n        msg.topic = `light/${device}/set`;\n        node.send(msg);\n    }\n}\nflow.set(flowVar, msg.payload);\n",
        "outputs": 1,
        "noerr": 0,
        "x": 1750,
        "y": 280,
        "wires": [
            [
                "c783ff9d.4e0ce",
                "e6d08549.d422d8"
            ]
        ]
    },
    {
        "id": "c783ff9d.4e0ce",
        "type": "debug",
        "z": "7acba262.c6674c",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 1930,
        "y": 260,
        "wires": []
    },
    {
        "id": "39ee87a.155d078",
        "type": "comment",
        "z": "7acba262.c6674c",
        "name": "Offline detection and default light setting",
        "info": "",
        "x": 1610,
        "y": 180,
        "wires": []
    },
    {
        "id": "150081ae.829ebe",
        "type": "function",
        "z": "7acba262.c6674c",
        "name": "",
        "func": "var DiningTable = { topic: \"light/spisebord/set\", payload: null};\nvar CouchTable = { topic: \"light/sofabord/set\", payload: null};\nvar TV = {topic: \"light/tv/set\", payload: null};\nvar lightMax = flow.get('max', {});\nif (msg.payload === true) {\n    TV['payload'] = lightMax;\n    CouchTable['payload'] = lightMax;\n    DiningTable['payload'] = lightMax;\n    if (TV.payload !== null) node.send(TV);\n    if (CouchTable.payload !== null) node.send(CouchTable);\n    if (DiningTable.payload !== null) node.send(DiningTable);\n}\n",
        "outputs": 1,
        "noerr": 0,
        "x": 910,
        "y": 1160,
        "wires": [
            [
                "6bc8000c.0e7e3",
                "f5cea2f9.86136"
            ]
        ]
    },
    {
        "id": "6bc8000c.0e7e3",
        "type": "mqtt out",
        "z": "7acba262.c6674c",
        "name": "",
        "topic": "",
        "qos": "0",
        "retain": "false",
        "broker": "4798f2b0.5d747c",
        "x": 1080,
        "y": 1240,
        "wires": []
    },
    {
        "id": "f5cea2f9.86136",
        "type": "debug",
        "z": "7acba262.c6674c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 1070,
        "y": 1160,
        "wires": []
    },
    {
        "id": "34229c1c.b09714",
        "type": "function",
        "z": "7acba262.c6674c",
        "name": "mysensors light",
        "func": "if (msg.payload !== null) {\n    var p = msg.payload.toLowerCase();\n    if (p === \"off\") {\n        msg.payload = 0;\n    } else if (p === \"on\") {\n        msg.payload = 100;\n    }\n    msg.topic = 'mys-out/14/1/1/1/3';\n    return msg;\n}",
        "outputs": 1,
        "noerr": 0,
        "x": 600,
        "y": 340,
        "wires": [
            [
                "a254b86b.f8d1b8",
                "ffcfc678.fbfbb8"
            ]
        ]
    },
    {
        "id": "dd2a7485.e38e38",
        "type": "subflow:d17c54ad.8abb78",
        "z": "7acba262.c6674c",
        "x": 590,
        "y": 440,
        "wires": [
            [
                "74338bab.a7b7b4"
            ]
        ]
    },
    {
        "id": "ca8cff21.57af2",
        "type": "subflow:d17c54ad.8abb78",
        "z": "7acba262.c6674c",
        "name": "",
        "x": 590,
        "y": 480,
        "wires": [
            [
                "799b156e.d04ccc"
            ]
        ]
    },
    {
        "id": "e1f3e73e.892c08",
        "type": "subflow:d17c54ad.8abb78",
        "z": "7acba262.c6674c",
        "name": "",
        "x": 590,
        "y": 400,
        "wires": [
            [
                "8ad75625.d69a18"
            ]
        ]
    },
    {
        "id": "be4a19cf.24c208",
        "type": "delay",
        "z": "7acba262.c6674c",
        "name": "",
        "pauseType": "timed",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": true,
        "x": 230,
        "y": 360,
        "wires": [
            [
                "3190855e.690b1a",
                "a646dc17.498"
            ]
        ]
    },
    {
        "id": "be129df.8c6076",
        "type": "mqtt in",
        "z": "7acba262.c6674c",
        "name": "",
        "topic": "chromecast/tv_stuen/app",
        "qos": "2",
        "datatype": "auto",
        "broker": "4798f2b0.5d747c",
        "x": 150,
        "y": 900,
        "wires": [
            [
                "b2c719e0.0500d8"
            ]
        ]
    },
    {
        "id": "b2c719e0.0500d8",
        "type": "function",
        "z": "7acba262.c6674c",
        "name": "Is backdrop new app?",
        "func": "var DiningTable = { topic: \"light/spisebord/set\", payload: null};\nvar CouchTable = { topic: \"light/sofabord/set\", payload: null};\nvar TV = {topic: \"light/tv/set\", payload: null};\nvar lightMax = flow.get('max', 100);\nif (msg.payload === 'Backdrop') {\n    TV['payload'] = lightMax;\n    CouchTable['payload'] = lightMax;\n    DiningTable['payload'] = lightMax;\n    node.send(TV);\n    node.send(CouchTable);\n    node.send(DiningTable);\n}\n",
        "outputs": 1,
        "noerr": 0,
        "x": 560,
        "y": 900,
        "wires": [
            [
                "85f8634a.a6b85",
                "fcd32c5f.044a2"
            ]
        ]
    },
    {
        "id": "85f8634a.a6b85",
        "type": "function",
        "z": "7acba262.c6674c",
        "name": "drop null payloads",
        "func": "if (msg.payload !== null) {\n    return msg;\n}",
        "outputs": 1,
        "noerr": 0,
        "x": 850,
        "y": 860,
        "wires": [
            [
                "2b91e18a.6e4b9e",
                "7f794e09.7dd7"
            ]
        ]
    },
    {
        "id": "3c79a61c.126b8a",
        "type": "debug",
        "z": "7acba262.c6674c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 810,
        "y": 820,
        "wires": []
    },
    {
        "id": "fcd32c5f.044a2",
        "type": "debug",
        "z": "7acba262.c6674c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 810,
        "y": 900,
        "wires": []
    },
    {
        "id": "3190855e.690b1a",
        "type": "debug",
        "z": "7acba262.c6674c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "x": 410,
        "y": 360,
        "wires": []
    },
    {
        "id": "e67de015.8476e",
        "type": "debug",
        "z": "67deb464.98214c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 260,
        "y": 760,
        "wires": []
    },
    {
        "id": "51cd592d.1bbbc8",
        "type": "mqtt in",
        "z": "7acba262.c6674c",
        "name": "",
        "topic": "light/+/state",
        "qos": "2",
        "datatype": "auto",
        "broker": "4798f2b0.5d747c",
        "x": 110,
        "y": 1540,
        "wires": [
            [
                "3c961990.28f576"
            ]
        ]
    },
    {
        "id": "d5b4f6b5.3dd308",
        "type": "function",
        "z": "7acba262.c6674c",
        "name": "",
        "func": "const regex = /light\\/(.*)\\//gm;\nmatch = regex.exec(msg.topic);\nvar lightType = match[1];\n\nvar state = true;\nbrightness = 100;\nif (msg.payload === 'off') {\n    state = false;\n    brightness = 0;\n} else if (msg.payload === 'on') {\n    state = true;\n    brightness = 100;\n} else if (Number(msg.payload) === 0) {\n    state = false;\n    brightness = 0;\n} else {\n    brightness = Number(msg.payload);\n}\n\npayload = {\n\t\"on\": state,\n    \"bri\": Math.round(brightness*2.55)\n}\n\nswitch (lightType) {\n    case 'all':\n        node.send({\n            \"url\":`http://192.168.3.113:80/api/user/lights/3/bridgeupdatestate`,\n            \"payload\":payload            \n        });\n        node.send({\n            \"url\":`http://192.168.3.113:80/api/user/lights/1/bridgeupdatestate`,\n            \"payload\":payload            \n        });\n        node.send({\n            \"url\":`http://192.168.3.113:80/api/user/lights/4/bridgeupdatestate`,\n            \"payload\":payload            \n        });\n        node.send({\n            \"url\":`http://192.168.3.113:80/api/user/lights/2/bridgeupdatestate`,\n            \"payload\":payload            \n        });\n        break;\n    case 'sofabord':\n        node.send({\n            \"url\":`http://192.168.3.113:80/api/user/lights/1/bridgeupdatestate`,\n            \"payload\":payload            \n        });\n        break;\n    case 'spisebord':\n        node.send({\n            \"url\":`http://192.168.3.113:80/api/user/lights/4/bridgeupdatestate`,\n            \"payload\":payload            \n        });\n        break;\n    case 'tv':\n        node.send({\n            \"url\":`http://192.168.3.113:80/api/user/lights/2/bridgeupdatestate`,\n            \"payload\":payload            \n        });\n        break;\n}\n",
        "outputs": 1,
        "noerr": 0,
        "x": 510,
        "y": 1540,
        "wires": [
            [
                "d37b8cf6.79c97",
                "4dbe66dc.0c8038"
            ]
        ]
    },
    {
        "id": "d37b8cf6.79c97",
        "type": "debug",
        "z": "7acba262.c6674c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 690,
        "y": 1600,
        "wires": []
    },
    {
        "id": "4dbe66dc.0c8038",
        "type": "http request",
        "z": "7acba262.c6674c",
        "name": "",
        "method": "PUT",
        "ret": "obj",
        "paytoqs": false,
        "url": "",
        "tls": "",
        "proxy": "",
        "authType": "basic",
        "x": 710,
        "y": 1540,
        "wires": [
            [
                "32b53281.e0471e"
            ]
        ]
    },
    {
        "id": "32b53281.e0471e",
        "type": "debug",
        "z": "7acba262.c6674c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 890,
        "y": 1540,
        "wires": []
    },
    {
        "id": "296d1141.60ac2e",
        "type": "mqtt in",
        "z": "9292e51b.eaf788",
        "name": "",
        "topic": "utilitysensor",
        "qos": "2",
        "datatype": "utf8",
        "broker": "4798f2b0.5d747c",
        "x": 430,
        "y": 160,
        "wires": [
            [
                "5840b686.2bfc48",
                "a8023b70.b51ad8"
            ]
        ]
    },
    {
        "id": "a8023b70.b51ad8",
        "type": "debug",
        "z": "9292e51b.eaf788",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "x": 630,
        "y": 120,
        "wires": []
    },
    {
        "id": "f590fc3b.47d43",
        "type": "debug",
        "z": "d9d4d547.6a9438",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 610,
        "y": 400,
        "wires": []
    },
    {
        "id": "1e0f3db2.6888b2",
        "type": "inject",
        "z": "d2be3a2a.67d4b8",
        "name": "off",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 110,
        "y": 340,
        "wires": [
            [
                "4bef3015.f4a8b"
            ]
        ]
    },
    {
        "id": "5ddfc643.37dea8",
        "type": "debug",
        "z": "d2be3a2a.67d4b8",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 640,
        "y": 320,
        "wires": []
    },
    {
        "id": "f31ce5d8.59d278",
        "type": "comment",
        "z": "7acba262.c6674c",
        "name": "Get state changes and emit these as MQTT topics",
        "info": "",
        "x": 230,
        "y": 40,
        "wires": []
    },
    {
        "id": "5447063e.f15ac8",
        "type": "comment",
        "z": "7acba262.c6674c",
        "name": "Set new light state",
        "info": "",
        "x": 130,
        "y": 300,
        "wires": []
    },
    {
        "id": "ccf80220.89f41",
        "type": "comment",
        "z": "1e9f561e.599c0a",
        "name": "Presence",
        "info": "",
        "x": 140,
        "y": 140,
        "wires": []
    },
    {
        "id": "563571f6.0260e",
        "type": "rbe",
        "z": "1e9f561e.599c0a",
        "name": "",
        "func": "rbe",
        "gap": "",
        "start": "",
        "inout": "out",
        "x": 970,
        "y": 180,
        "wires": [
            [
                "e3208ce6.93b64",
                "d3e525da.a50f98",
                "a71ddb76.662c98"
            ]
        ]
    },
    {
        "id": "e3208ce6.93b64",
        "type": "debug",
        "z": "1e9f561e.599c0a",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 1210,
        "y": 140,
        "wires": []
    },
    {
        "id": "d3e525da.a50f98",
        "type": "mqtt out",
        "z": "1e9f561e.599c0a",
        "name": "",
        "topic": "",
        "qos": "2",
        "retain": "false",
        "broker": "4798f2b0.5d747c",
        "x": 1210,
        "y": 180,
        "wires": []
    },
    {
        "id": "d39bec91.07e59",
        "type": "ui_switch",
        "z": "1e9f561e.599c0a",
        "name": "",
        "label": "Magnus",
        "tooltip": "",
        "group": "48014e80.94ab",
        "order": 3,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "person",
        "oncolor": "#659933",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "person_outline",
        "offcolor": "#AA5C39",
        "x": 400,
        "y": 380,
        "wires": [
            []
        ]
    },
    {
        "id": "74a3fa82.34b964",
        "type": "mqtt in",
        "z": "1e9f561e.599c0a",
        "name": "",
        "topic": "presence/magnus/telefon",
        "qos": "2",
        "datatype": "json",
        "broker": "4798f2b0.5d747c",
        "x": 190,
        "y": 380,
        "wires": [
            [
                "d39bec91.07e59"
            ]
        ]
    },
    {
        "id": "fb38031d.d6dfc",
        "type": "ui_switch",
        "z": "1e9f561e.599c0a",
        "name": "",
        "label": "Laurits",
        "tooltip": "",
        "group": "48014e80.94ab",
        "order": 4,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "person",
        "oncolor": "#659933",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "person_outline",
        "offcolor": "#AA5C39",
        "x": 390,
        "y": 440,
        "wires": [
            []
        ]
    },
    {
        "id": "f792bf74.56678",
        "type": "mqtt in",
        "z": "1e9f561e.599c0a",
        "name": "",
        "topic": "presence/laurits/telefon",
        "qos": "2",
        "datatype": "json",
        "broker": "4798f2b0.5d747c",
        "x": 180,
        "y": 440,
        "wires": [
            [
                "fb38031d.d6dfc"
            ]
        ]
    },
    {
        "id": "44c72419.8481bc",
        "type": "ui_switch",
        "z": "1e9f561e.599c0a",
        "name": "",
        "label": "Chalotte",
        "tooltip": "",
        "group": "48014e80.94ab",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "person",
        "oncolor": "#659933",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "person_outline",
        "offcolor": "#AA5C39",
        "x": 400,
        "y": 500,
        "wires": [
            []
        ]
    },
    {
        "id": "c48bc67f.367e08",
        "type": "mqtt in",
        "z": "1e9f561e.599c0a",
        "name": "",
        "topic": "presence/chalotte/telefon",
        "qos": "2",
        "datatype": "json",
        "broker": "4798f2b0.5d747c",
        "x": 190,
        "y": 500,
        "wires": [
            [
                "44c72419.8481bc",
                "45f29ba6.d47914"
            ]
        ]
    },
    {
        "id": "b867e670.9e2018",
        "type": "ui_switch",
        "z": "1e9f561e.599c0a",
        "name": "",
        "label": "Thomas",
        "tooltip": "",
        "group": "48014e80.94ab",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "person",
        "oncolor": "#659933",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "person_outline",
        "offcolor": "#AA5C39",
        "x": 400,
        "y": 560,
        "wires": [
            []
        ]
    },
    {
        "id": "92dff7dc.d4f318",
        "type": "mqtt in",
        "z": "1e9f561e.599c0a",
        "name": "",
        "topic": "presence/thomas/telefon",
        "qos": "2",
        "datatype": "json",
        "broker": "4798f2b0.5d747c",
        "x": 190,
        "y": 560,
        "wires": [
            [
                "b867e670.9e2018"
            ]
        ]
    },
    {
        "id": "7637ae8e.52901",
        "type": "ui_switch",
        "z": "1e9f561e.599c0a",
        "name": "",
        "label": "Line",
        "tooltip": "",
        "group": "48014e80.94ab",
        "order": 5,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "person",
        "oncolor": "#659933",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "person_outline",
        "offcolor": "#AA5C39",
        "x": 390,
        "y": 620,
        "wires": [
            []
        ]
    },
    {
        "id": "1b0238c3.537fa7",
        "type": "mqtt in",
        "z": "1e9f561e.599c0a",
        "name": "",
        "topic": "presence/line/telefon",
        "qos": "2",
        "datatype": "json",
        "broker": "4798f2b0.5d747c",
        "x": 170,
        "y": 620,
        "wires": [
            [
                "7637ae8e.52901"
            ]
        ]
    },
    {
        "id": "16838687.8e56d9",
        "type": "ui_switch",
        "z": "1e9f561e.599c0a",
        "name": "",
        "label": "Andreas",
        "tooltip": "",
        "group": "48014e80.94ab",
        "order": 6,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "person",
        "oncolor": "#659933",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "person_outline",
        "offcolor": "#AA5C39",
        "x": 400,
        "y": 680,
        "wires": [
            []
        ]
    },
    {
        "id": "9e735b2c.b25ad8",
        "type": "mqtt in",
        "z": "1e9f561e.599c0a",
        "name": "",
        "topic": "presence/andreas/telefon",
        "qos": "2",
        "datatype": "json",
        "broker": "4798f2b0.5d747c",
        "x": 190,
        "y": 680,
        "wires": [
            [
                "16838687.8e56d9"
            ]
        ]
    },
    {
        "id": "3298b9bb.d60926",
        "type": "ui_switch",
        "z": "1e9f561e.599c0a",
        "name": "",
        "label": "Esben",
        "tooltip": "",
        "group": "48014e80.94ab",
        "order": 7,
        "width": 0,
        "height": 0,
        "passthru": false,
        "decouple": "true",
        "topic": "",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "person",
        "oncolor": "#659933",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "person_outline",
        "offcolor": "#AA5C39",
        "x": 390,
        "y": 740,
        "wires": [
            []
        ]
    },
    {
        "id": "982c29b8.1ebbe8",
        "type": "mqtt in",
        "z": "1e9f561e.599c0a",
        "name": "",
        "topic": "presence/esben/telefon",
        "qos": "2",
        "datatype": "json",
        "broker": "4798f2b0.5d747c",
        "x": 180,
        "y": 740,
        "wires": [
            [
                "3298b9bb.d60926"
            ]
        ]
    },
    {
        "id": "34fae579.5fbcea",
        "type": "influxdb out",
        "z": "1e9f561e.599c0a",
        "influxdb": "fc44c751.2d1328",
        "name": "influx",
        "measurement": "presence",
        "precision": "",
        "retentionPolicy": "",
        "x": 1370,
        "y": 240,
        "wires": []
    },
    {
        "id": "a71ddb76.662c98",
        "type": "function",
        "z": "1e9f561e.599c0a",
        "name": "",
        "func": "var x = msg.topic.split('/');\nperson = x[1];\ndevice = x[2];\nvar tags = {};\nvar data = {};\ntags.person = person;\ntags.device = device;\ndata.value=Number(msg.payload);\nmsg = {payload:[data, tags]};\nreturn msg;\n\n",
        "outputs": 1,
        "noerr": 0,
        "x": 1210,
        "y": 240,
        "wires": [
            [
                "8da807b1.345958",
                "34fae579.5fbcea"
            ]
        ]
    },
    {
        "id": "8da807b1.345958",
        "type": "debug",
        "z": "1e9f561e.599c0a",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 1370,
        "y": 280,
        "wires": []
    },
    {
        "id": "50e0397b.0eae88",
        "type": "delay",
        "z": "1e9f561e.599c0a",
        "name": "",
        "pauseType": "queue",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "5",
        "rateUnits": "minute",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": true,
        "x": 1020,
        "y": 240,
        "wires": [
            [
                "fff25d77.1179f",
                "a71ddb76.662c98"
            ]
        ]
    },
    {
        "id": "fff25d77.1179f",
        "type": "debug",
        "z": "1e9f561e.599c0a",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 1210,
        "y": 280,
        "wires": []
    },
    {
        "id": "62a09cf3.7e4614",
        "type": "mqtt out",
        "z": "1e9f561e.599c0a",
        "name": "",
        "topic": "",
        "qos": "2",
        "retain": "false",
        "broker": "4798f2b0.5d747c",
        "x": 790,
        "y": 520,
        "wires": []
    },
    {
        "id": "45f29ba6.d47914",
        "type": "function",
        "z": "1e9f561e.599c0a",
        "name": "Spisebord light on",
        "func": "if (msg.payload) {\n    msg.topic = 'light/spisebord/set';\n    msg.payload='100';\n    return msg;\n}\n",
        "outputs": 1,
        "noerr": 0,
        "x": 610,
        "y": 520,
        "wires": [
            [
                "62a09cf3.7e4614"
            ]
        ]
    },
    {
        "id": "b1a25924.9273e8",
        "type": "Unifi",
        "z": "1e9f561e.599c0a",
        "name": "",
        "ip": "unifi",
        "port": "8443",
        "site": "default",
        "command": "20",
        "x": 470,
        "y": 120,
        "wires": [
            [
                "fe669ea2.afe15"
            ]
        ]
    },
    {
        "id": "5f05bc1c.ed1624",
        "type": "Unifi",
        "z": "1e9f561e.599c0a",
        "name": "",
        "ip": "unifi",
        "port": 8443,
        "site": "default",
        "command": "30",
        "x": 330,
        "y": 180,
        "wires": [
            [
                "86b5888b.c51658",
                "b1a25924.9273e8"
            ]
        ]
    },
    {
        "id": "fe669ea2.afe15",
        "type": "change",
        "z": "1e9f561e.599c0a",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "clients",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 630,
        "y": 120,
        "wires": [
            [
                "d2bc27bf.86de08"
            ]
        ]
    },
    {
        "id": "86b5888b.c51658",
        "type": "change",
        "z": "1e9f561e.599c0a",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "allusers",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 490,
        "y": 180,
        "wires": [
            [
                "d2bc27bf.86de08"
            ]
        ]
    },
    {
        "id": "d2bc27bf.86de08",
        "type": "function",
        "z": "1e9f561e.599c0a",
        "name": "Presence detector",
        "func": "if (msg.topic==='allusers') {\n    context.set('allusers', msg.payload[0]);\n    return undefined;\n}\nconst allUsers = context.get('allusers');\nconst clients = msg.payload[0];\nif (allUsers === undefined) {\n    return undefined;\n}\n\n/* Config parameter */\nconst lastSeenSeconds = 60;\nconst presenceCutoff = (new Date() - (lastSeenSeconds * 1000)) / 1000; \nconst people = [\n    \"laurits\",\n    \"magnus\",\n    \"chalotte\",\n    \"thomas\",\n    \"line\",\n    \"andreas\",\n    \"esben\"\n];\n\npeople.forEach((user) => {\n    const devices = allUsers.filter(\n        device => device.name !== undefined && device.name.toLowerCase().includes(user)\n    );\n\n    devices.forEach((device) => {\n        const d = device.name.toLowerCase().split(' ');\n        const client = clients.find(d => d.mac == device.mac);\n        if (client !== undefined) {\n            device.last_seen = client.last_seen;\n        }\n        node.send({\n            topic: `presence/${d[0]}/${d[1]}`,\n            retain: true,\n            payload: device.last_seen > presenceCutoff\n        });\n    });\n    \n});\n",
        "outputs": 1,
        "noerr": 0,
        "x": 730,
        "y": 180,
        "wires": [
            [
                "563571f6.0260e",
                "50e0397b.0eae88"
            ]
        ]
    },
    {
        "id": "660e2c65.6dac04",
        "type": "inject",
        "z": "1e9f561e.599c0a",
        "name": "Every 10 seconds",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "repeat": "5",
        "crontab": "",
        "once": false,
        "onceDelay": "",
        "x": 170,
        "y": 180,
        "wires": [
            [
                "5f05bc1c.ed1624"
            ]
        ]
    },
    {
        "id": "61b42a5c.9c4b14",
        "type": "http in",
        "z": "1e9f561e.599c0a",
        "name": "",
        "url": "/automation",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 690,
        "y": 680,
        "wires": [
            [
                "4d21f4a0.41e79c",
                "fcca1fc4.e0cbd"
            ]
        ]
    },
    {
        "id": "fb335f2e.1a391",
        "type": "http response",
        "z": "1e9f561e.599c0a",
        "name": "",
        "statusCode": "200",
        "headers": {},
        "x": 1080,
        "y": 680,
        "wires": []
    },
    {
        "id": "4d21f4a0.41e79c",
        "type": "json",
        "z": "1e9f561e.599c0a",
        "name": "",
        "property": "payload",
        "action": "obj",
        "pretty": false,
        "x": 870,
        "y": 740,
        "wires": [
            [
                "4d74eced.c7d2a4"
            ]
        ]
    },
    {
        "id": "fcca1fc4.e0cbd",
        "type": "change",
        "z": "1e9f561e.599c0a",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 900,
        "y": 680,
        "wires": [
            [
                "fb335f2e.1a391"
            ]
        ]
    },
    {
        "id": "4d74eced.c7d2a4",
        "type": "function",
        "z": "1e9f561e.599c0a",
        "name": "",
        "func": "const p = msg.payload;\nif (p.auth === 'BOSSplayer!2#4') {\n    out = {topic: p.topic, payload: p.payload}\n    return out;\n}\n",
        "outputs": 1,
        "noerr": 0,
        "x": 1000,
        "y": 740,
        "wires": [
            [
                "58cd0d5d.a5ef74"
            ]
        ]
    },
    {
        "id": "58cd0d5d.a5ef74",
        "type": "debug",
        "z": "1e9f561e.599c0a",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 1130,
        "y": 740,
        "wires": []
    },
    {
        "id": "3c961990.28f576",
        "type": "delay",
        "z": "7acba262.c6674c",
        "name": "",
        "pauseType": "timed",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "30",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": true,
        "x": 320,
        "y": 1540,
        "wires": [
            [
                "d5b4f6b5.3dd308"
            ]
        ]
    },
    {
        "id": "809174d.79cca88",
        "type": "debug",
        "z": "7acba262.c6674c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 330,
        "y": 80,
        "wires": []
    },
    {
        "id": "212f9bbb.cf67d4",
        "type": "mqtt in",
        "z": "96d6598d.fb6458",
        "name": "",
        "topic": "zigbee/dimmer/puck1",
        "qos": "2",
        "datatype": "json",
        "broker": "4798f2b0.5d747c",
        "x": 340,
        "y": 200,
        "wires": [
            [
                "6ea18eb.6a5237"
            ]
        ]
    },
    {
        "id": "f40f7992.fe85a8",
        "type": "mqtt out",
        "z": "96d6598d.fb6458",
        "name": "",
        "topic": "zigbee/light/sofabord/set",
        "qos": "",
        "retain": "",
        "broker": "4798f2b0.5d747c",
        "x": 970,
        "y": 220,
        "wires": []
    },
    {
        "id": "976b5bbf.e575e8",
        "type": "function",
        "z": "96d6598d.fb6458",
        "name": "",
        "func": "p = msg.payload;\nmsg.payload= {\"brightness\":p.brightness};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 770,
        "y": 200,
        "wires": [
            [
                "f40f7992.fe85a8",
                "da750200.1b99a"
            ]
        ]
    },
    {
        "id": "da750200.1b99a",
        "type": "debug",
        "z": "96d6598d.fb6458",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 930,
        "y": 180,
        "wires": []
    },
    {
        "id": "6dd486bc.5496b8",
        "type": "delay",
        "z": "96d6598d.fb6458",
        "name": "",
        "pauseType": "queue",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "0.5",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": true,
        "x": 590,
        "y": 200,
        "wires": [
            [
                "976b5bbf.e575e8"
            ]
        ]
    },
    {
        "id": "6ea18eb.6a5237",
        "type": "debug",
        "z": "96d6598d.fb6458",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 570,
        "y": 240,
        "wires": []
    },
    {
        "id": "8ad75625.d69a18",
        "type": "mqtt out",
        "z": "7acba262.c6674c",
        "name": "",
        "topic": "zigbee/group/sofa/set",
        "qos": "2",
        "retain": "false",
        "broker": "4798f2b0.5d747c",
        "x": 1000,
        "y": 400,
        "wires": []
    },
    {
        "id": "74338bab.a7b7b4",
        "type": "mqtt out",
        "z": "7acba262.c6674c",
        "name": "",
        "topic": "zigbee/group/spisebord/set",
        "qos": "2",
        "retain": "false",
        "broker": "4798f2b0.5d747c",
        "x": 1020,
        "y": 440,
        "wires": []
    },
    {
        "id": "3b9bb8db.d283a8",
        "type": "mqtt out",
        "z": "7acba262.c6674c",
        "name": "",
        "topic": "zigbee/light/spisebord2/set",
        "qos": "2",
        "retain": "false",
        "broker": "4798f2b0.5d747c",
        "x": 1660,
        "y": 720,
        "wires": []
    },
    {
        "id": "799b156e.d04ccc",
        "type": "mqtt out",
        "z": "7acba262.c6674c",
        "name": "",
        "topic": "zigbee/group/tv/set",
        "qos": "2",
        "retain": "false",
        "broker": "4798f2b0.5d747c",
        "x": 990,
        "y": 480,
        "wires": []
    },
    {
        "id": "625aa6eb.f19b98",
        "type": "mqtt out",
        "z": "7acba262.c6674c",
        "name": "",
        "topic": "zigbee/light/tvmid/set",
        "qos": "2",
        "retain": "false",
        "broker": "4798f2b0.5d747c",
        "x": 1640,
        "y": 780,
        "wires": []
    },
    {
        "id": "63a8e9a0.6338c8",
        "type": "mqtt out",
        "z": "7acba262.c6674c",
        "name": "",
        "topic": "zigbee/light/tvleft/set",
        "qos": "2",
        "retain": "false",
        "broker": "4798f2b0.5d747c",
        "x": 1640,
        "y": 820,
        "wires": []
    },
    {
        "id": "8b547266.5a5d4",
        "type": "mqtt in",
        "z": "7acba262.c6674c",
        "name": "",
        "topic": "zigbee/light/+",
        "qos": "2",
        "datatype": "json",
        "broker": "4798f2b0.5d747c",
        "x": 970,
        "y": 180,
        "wires": [
            [
                "a63f9630.8c9788"
            ]
        ]
    },
    {
        "id": "8e5e4de9.ad5c",
        "type": "mqtt in",
        "z": "7acba262.c6674c",
        "name": "",
        "topic": "zigbee/bridge/log",
        "qos": "2",
        "datatype": "json",
        "broker": "4798f2b0.5d747c",
        "x": 1760,
        "y": 360,
        "wires": [
            [
                "24d92e0e.16c8b2",
                "d68a255b.b15c68"
            ]
        ]
    },
    {
        "id": "24d92e0e.16c8b2",
        "type": "debug",
        "z": "7acba262.c6674c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 1930,
        "y": 320,
        "wires": []
    },
    {
        "id": "d68a255b.b15c68",
        "type": "function",
        "z": "7acba262.c6674c",
        "name": "",
        "func": "// If we get a publish error from the zigbee stack, we assume that \n// the device is offline, and publish this as state.\nif (msg.payload.type === \"zigbee_publish_error\") {\n    var light = msg.payload.meta.entity.friendlyName.split('/')[1];\n\n    msg.payload= \"offline\"\n    msg.topic = '';\n\n    switch (light) {\n        case 'sofabord':\n            msg.topic = \"light/sofabord/state\";\n        break;\n        case 'spisebord1':\n            msg.topic = \"light/spisebord/state\";\n        break;\n        case 'tvmid':\n            msg.topic = \"light/tv/state\";\n        break;\n    }\n    \n    if (msg.topic !== '') {\n        return msg;\n    }\n\n}\n",
        "outputs": 1,
        "noerr": 0,
        "x": 1930,
        "y": 360,
        "wires": [
            [
                "e6d08549.d422d8",
                "de957c4f.b956e"
            ]
        ]
    },
    {
        "id": "a7e9553e.aa85a8",
        "type": "change",
        "z": "7acba262.c6674c",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "state",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 260,
        "y": 200,
        "wires": [
            [
                "c1363e20.1d707"
            ]
        ]
    },
    {
        "id": "49c58caf.73c634",
        "type": "mqtt out",
        "z": "7acba262.c6674c",
        "name": "",
        "topic": "zigbee/light/sofabord/get",
        "qos": "",
        "retain": "",
        "broker": "4798f2b0.5d747c",
        "x": 630,
        "y": 140,
        "wires": []
    },
    {
        "id": "cd0f8d1e.91c2a",
        "type": "mqtt out",
        "z": "7acba262.c6674c",
        "name": "",
        "topic": "zigbee/light/spisebord1/get",
        "qos": "",
        "retain": "",
        "broker": "4798f2b0.5d747c",
        "x": 640,
        "y": 180,
        "wires": []
    },
    {
        "id": "89fed658.955188",
        "type": "mqtt out",
        "z": "7acba262.c6674c",
        "name": "",
        "topic": "zigbee/light/tvmid/get",
        "qos": "",
        "retain": "",
        "broker": "4798f2b0.5d747c",
        "x": 620,
        "y": 220,
        "wires": []
    },
    {
        "id": "e6d08549.d422d8",
        "type": "mqtt out",
        "z": "7acba262.c6674c",
        "name": "",
        "topic": "",
        "qos": "2",
        "retain": "false",
        "broker": "4798f2b0.5d747c",
        "x": 2110,
        "y": 360,
        "wires": []
    },
    {
        "id": "de957c4f.b956e",
        "type": "debug",
        "z": "7acba262.c6674c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 2110,
        "y": 320,
        "wires": []
    },
    {
        "id": "912c8611.84ff38",
        "type": "change",
        "z": "7acba262.c6674c",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "state",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1760,
        "y": 440,
        "wires": [
            []
        ]
    },
    {
        "id": "efe713f.81a4bf",
        "type": "inject",
        "z": "7acba262.c6674c",
        "name": "Hjørnet",
        "topic": "zigbee/light/corner/get",
        "payload": "",
        "payloadType": "date",
        "repeat": "60",
        "crontab": "",
        "once": true,
        "onceDelay": "40",
        "x": 1540,
        "y": 520,
        "wires": [
            []
        ]
    },
    {
        "id": "8f03faab.aff4c8",
        "type": "comment",
        "z": "7acba262.c6674c",
        "name": "Report to hue emulator",
        "info": "",
        "x": 140,
        "y": 1480,
        "wires": []
    },
    {
        "id": "f3cf80ff.4018f",
        "type": "mqtt in",
        "z": "7acba262.c6674c",
        "name": "",
        "topic": "light/+/set",
        "qos": "2",
        "datatype": "auto",
        "broker": "4798f2b0.5d747c",
        "x": 100,
        "y": 1600,
        "wires": [
            [
                "3c961990.28f576"
            ]
        ]
    },
    {
        "id": "9ad0071a.978cc8",
        "type": "mqtt in",
        "z": "96d6598d.fb6458",
        "name": "",
        "topic": "zigbee/dimmer/puck2",
        "qos": "2",
        "datatype": "json",
        "broker": "4798f2b0.5d747c",
        "x": 340,
        "y": 400,
        "wires": [
            [
                "80afb48d.6ea778"
            ]
        ]
    },
    {
        "id": "864bcf63.70278",
        "type": "mqtt out",
        "z": "96d6598d.fb6458",
        "name": "",
        "topic": "zigbee/light/spisebord1/set",
        "qos": "",
        "retain": "",
        "broker": "4798f2b0.5d747c",
        "x": 980,
        "y": 420,
        "wires": []
    },
    {
        "id": "94926d10.7ec39",
        "type": "function",
        "z": "96d6598d.fb6458",
        "name": "",
        "func": "p = msg.payload;\nmsg.payload= {\"brightness\":p.brightness};\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 760,
        "y": 400,
        "wires": [
            [
                "864bcf63.70278",
                "6b38faf4.576a94",
                "f6ad8cf9.a5a3c"
            ]
        ]
    },
    {
        "id": "6b38faf4.576a94",
        "type": "debug",
        "z": "96d6598d.fb6458",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 930,
        "y": 380,
        "wires": []
    },
    {
        "id": "ade086a4.e6fc88",
        "type": "delay",
        "z": "96d6598d.fb6458",
        "name": "",
        "pauseType": "queue",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "0.5",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": true,
        "x": 580,
        "y": 400,
        "wires": [
            [
                "94926d10.7ec39"
            ]
        ]
    },
    {
        "id": "80afb48d.6ea778",
        "type": "debug",
        "z": "96d6598d.fb6458",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 560,
        "y": 440,
        "wires": []
    },
    {
        "id": "f6ad8cf9.a5a3c",
        "type": "mqtt out",
        "z": "96d6598d.fb6458",
        "name": "",
        "topic": "zigbee/light/spisebord2/set",
        "qos": "",
        "retain": "",
        "broker": "4798f2b0.5d747c",
        "x": 980,
        "y": 460,
        "wires": []
    },
    {
        "id": "b6d93489.689998",
        "type": "subflow:d17c54ad.8abb78",
        "z": "7acba262.c6674c",
        "name": "",
        "x": 590,
        "y": 580,
        "wires": [
            [
                "34f460d3.4591d"
            ]
        ]
    },
    {
        "id": "34f460d3.4591d",
        "type": "mqtt out",
        "z": "7acba262.c6674c",
        "name": "",
        "topic": "zigbee/light/corner/set",
        "qos": "2",
        "retain": "false",
        "broker": "4798f2b0.5d747c",
        "x": 1000,
        "y": 580,
        "wires": []
    },
    {
        "id": "e19d4bb5.00f718",
        "type": "debug",
        "z": "7acba262.c6674c",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 1730,
        "y": 240,
        "wires": []
    },
    {
        "id": "ce5a91b3.db84f",
        "type": "debug",
        "z": "67deb464.98214c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 1190,
        "y": 120,
        "wires": []
    },
    {
        "id": "e879028e.4a538",
        "type": "mysdebug",
        "z": "67deb464.98214c",
        "name": "",
        "x": 1000,
        "y": 120,
        "wires": [
            [
                "ce5a91b3.db84f"
            ]
        ]
    },
    {
        "id": "7133cb6f.f09d84",
        "type": "mysdecode",
        "z": "67deb464.98214c",
        "database": "",
        "name": "",
        "mqtt": true,
        "enrich": false,
        "x": 380,
        "y": 120,
        "wires": [
            [
                "2c0c9b25.5c5ba4"
            ]
        ]
    },
    {
        "id": "720aaaf8.9fc944",
        "type": "mysencode",
        "z": "67deb464.98214c",
        "name": "",
        "mqtt": true,
        "mqtttopic": "test",
        "x": 780,
        "y": 120,
        "wires": [
            [
                "e879028e.4a538"
            ]
        ]
    },
    {
        "id": "2c0c9b25.5c5ba4",
        "type": "switch",
        "z": "67deb464.98214c",
        "name": "",
        "property": "messageType",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "3",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 570,
        "y": 120,
        "wires": [
            [
                "720aaaf8.9fc944"
            ]
        ]
    },
    {
        "id": "7f4986ff.8cac98",
        "type": "mqtt in",
        "z": "96d6598d.fb6458",
        "name": "",
        "topic": "zigbee/dimmer/+",
        "qos": "2",
        "datatype": "json",
        "broker": "4798f2b0.5d747c",
        "x": 320,
        "y": 640,
        "wires": [
            [
                "6ac62a83.f16f74",
                "c1398c72.92717"
            ]
        ]
    },
    {
        "id": "6ac62a83.f16f74",
        "type": "function",
        "z": "96d6598d.fb6458",
        "name": "",
        "func": "var out = ''\nif (msg.payload.action.includes('left')) {\n    out = 'down';\n} else if (msg.payload.action.includes('right')) {\n    out = 'up';\n}\nif (out !== '') {\n    msg.payload = out;\nreturn msg;\n    \n}\n",
        "outputs": 1,
        "noerr": 0,
        "x": 550,
        "y": 640,
        "wires": [
            [
                "58ff2d0d.94a534",
                "8caaf87a.a4e3c8"
            ]
        ]
    },
    {
        "id": "58ff2d0d.94a534",
        "type": "debug",
        "z": "96d6598d.fb6458",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 690,
        "y": 640,
        "wires": []
    },
    {
        "id": "c1398c72.92717",
        "type": "debug",
        "z": "96d6598d.fb6458",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 550,
        "y": 580,
        "wires": []
    },
    {
        "id": "8caaf87a.a4e3c8",
        "type": "switch",
        "z": "96d6598d.fb6458",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "up",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "down",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 820,
        "y": 600,
        "wires": [
            [
                "94d6e84c.5dfe98"
            ],
            [
                "8c6cbb0a.71fd38"
            ]
        ]
    },
    {
        "id": "94d6e84c.5dfe98",
        "type": "H command",
        "z": "96d6598d.fb6458",
        "name": "",
        "server": "56b003cf.93c9bc",
        "activity": "21395657",
        "harmony_type": "act",
        "label": "Chromecast Audio",
        "command": "%7B%22command%22::%22VolumeUp%22,%22type%22::%22IRCommand%22,%22deviceId%22::%2237008441%22%7D",
        "repeat": "1",
        "x": 990,
        "y": 560,
        "wires": [
            []
        ]
    },
    {
        "id": "8c6cbb0a.71fd38",
        "type": "H command",
        "z": "96d6598d.fb6458",
        "name": "",
        "server": "56b003cf.93c9bc",
        "activity": "21395657",
        "harmony_type": "act",
        "label": "Chromecast Audio",
        "command": "%7B%22command%22::%22VolumeDown%22,%22type%22::%22IRCommand%22,%22deviceId%22::%2237008441%22%7D",
        "repeat": "1",
        "x": 990,
        "y": 620,
        "wires": [
            []
        ]
    },
    {
        "id": "fe2bd2cd.1fc12",
        "type": "mqtt in",
        "z": "96d6598d.fb6458",
        "name": "",
        "topic": "zigbee/button/1",
        "qos": "2",
        "datatype": "json",
        "broker": "4798f2b0.5d747c",
        "x": 330,
        "y": 80,
        "wires": [
            [
                "21f9791.94d9286",
                "9d299347.7be6d"
            ]
        ]
    },
    {
        "id": "ee598dc9.e3525",
        "type": "mqtt out",
        "z": "96d6598d.fb6458",
        "name": "",
        "topic": "light/all/set",
        "qos": "",
        "retain": "",
        "broker": "4798f2b0.5d747c",
        "x": 860,
        "y": 80,
        "wires": []
    },
    {
        "id": "21f9791.94d9286",
        "type": "function",
        "z": "96d6598d.fb6458",
        "name": "",
        "func": "if (msg.payload.click === 'on') {\n    msg.payload = 100;\n} else {\n    msg.payload = 0;\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 610,
        "y": 80,
        "wires": [
            [
                "ee598dc9.e3525"
            ]
        ]
    },
    {
        "id": "9d299347.7be6d",
        "type": "debug",
        "z": "96d6598d.fb6458",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "x": 540,
        "y": 40,
        "wires": []
    },
    {
        "id": "73e897e7.fa4dd8",
        "type": "subflow:d17c54ad.8abb78",
        "z": "7acba262.c6674c",
        "name": "",
        "x": 590,
        "y": 520,
        "wires": [
            [
                "46d61698.cb1828"
            ]
        ]
    },
    {
        "id": "46d61698.cb1828",
        "type": "mqtt out",
        "z": "7acba262.c6674c",
        "name": "",
        "topic": "zigbee/group/all/set",
        "qos": "2",
        "retain": "false",
        "broker": "4798f2b0.5d747c",
        "x": 990,
        "y": 520,
        "wires": []
    },
    {
        "id": "42e41bb0.2fa034",
        "type": "inject",
        "z": "353b452d.9a6efa",
        "name": "",
        "topic": "",
        "payload": "auto",
        "payloadType": "str",
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "x": 610,
        "y": 700,
        "wires": [
            [
                "581a5cc2.e013e4"
            ]
        ]
    },
    {
        "id": "f5781bef.baf0d8",
        "type": "comment",
        "z": "67deb464.98214c",
        "name": "Decode debug messages (messageType = 3)",
        "info": "",
        "x": 590,
        "y": 80,
        "wires": []
    }
]